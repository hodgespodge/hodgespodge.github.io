var $e=Object.defineProperty,Ye=Object.defineProperties;var Ke=Object.getOwnPropertyDescriptors;var we=Object.getOwnPropertySymbols;var Je=Object.prototype.hasOwnProperty,Qe=Object.prototype.propertyIsEnumerable;var re=(it,p,$)=>p in it?$e(it,p,{enumerable:!0,configurable:!0,writable:!0,value:$}):it[p]=$,ae=(it,p)=>{for(var $ in p||(p={}))Je.call(p,$)&&re(it,$,p[$]);if(we)for(var $ of we(p))Qe.call(p,$)&&re(it,$,p[$]);return it},oe=(it,p)=>Ye(it,Ke(p));var Mt=(it,p,$)=>(re(it,typeof p!="symbol"?p+"":p,$),$),le=(it,p,$)=>{if(!p.has(it))throw TypeError("Cannot "+$)};var P=(it,p,$)=>(le(it,p,"read from private field"),$?$.call(it):p.get(it)),at=(it,p,$)=>{if(p.has(it))throw TypeError("Cannot add the same private member more than once");p instanceof WeakSet?p.add(it):p.set(it,$)},mt=(it,p,$,S)=>(le(it,p,"write to private field"),S?S.call(it,$):p.set(it,$),$),ce=(it,p,$,S)=>({set _(C){mt(it,p,C,$)},get _(){return P(it,p,S)}}),ht=(it,p,$)=>(le(it,p,"access private method"),$);import{r as readable}from"./index-5ca6b76d.js";var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function getAugmentedNamespace(it){if(it.__esModule)return it;var p=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(it).forEach(function($){var S=Object.getOwnPropertyDescriptor(it,$);Object.defineProperty(p,$,S.get?S:{enumerable:!0,get:function(){return it[$]}})}),p}function commonjsRequire(it){throw new Error('Could not dynamically require "'+it+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}},__viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$4=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(p,$){module.exports=$()})(globalThis,()=>(()=>{var __webpack_modules__=[,(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.VerbosityLevel=p.Util=p.UnknownErrorException=p.UnexpectedResponseException=p.UNSUPPORTED_FEATURES=p.TextRenderingMode=p.StreamType=p.RenderingIntentFlag=p.PermissionFlag=p.PasswordResponses=p.PasswordException=p.PageActionEventType=p.OPS=p.MissingPDFException=p.LINE_FACTOR=p.LINE_DESCENT_FACTOR=p.InvalidPDFException=p.ImageKind=p.IDENTITY_MATRIX=p.FormatError=p.FontType=p.FeatureTest=p.FONT_IDENTITY_MATRIX=p.DocumentActionEventType=p.CMapCompressionType=p.BaseException=p.AnnotationType=p.AnnotationStateModelType=p.AnnotationReviewState=p.AnnotationReplyType=p.AnnotationMode=p.AnnotationMarkedState=p.AnnotationFlag=p.AnnotationFieldFlag=p.AnnotationEditorType=p.AnnotationEditorPrefix=p.AnnotationEditorParamsType=p.AnnotationBorderStyleType=p.AnnotationActionEventType=p.AbortException=void 0,p.arrayByteLength=nt,p.arraysToBytes=dt,p.assert=c,p.bytesToString=k,p.createPromiseCapability=pt,p.createValidAbsoluteUrl=T,p.escapeString=Tt,p.getModificationDate=rt,p.getVerbosityLevel=et,p.info=ct,p.isArrayBuffer=Ot,p.isArrayEqual=Zt,p.isAscii=Rt,p.objectFromMap=Z,p.objectSize=ot,p.setVerbosityLevel=G,p.shadow=M,p.string32=K,p.stringToBytes=L,p.stringToPDFString=Et,p.stringToUTF16BEString=Ft,p.stringToUTF8String=Xt,p.unreachable=D,p.utf8StringToString=xt,p.warn=bt,$(2);const S=[1,0,0,1,0,0];p.IDENTITY_MATRIX=S;const C=[.001,0,0,.001,0,0];p.FONT_IDENTITY_MATRIX=C;const Q=1.35;p.LINE_FACTOR=Q;const W=.35;p.LINE_DESCENT_FACTOR=W;const tt={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};p.RenderingIntentFlag=tt;const N={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};p.AnnotationMode=N;const f="pdfjs_internal_editor_";p.AnnotationEditorPrefix=f;const E={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};p.AnnotationEditorType=E;const F={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};p.AnnotationEditorParamsType=F;const b={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};p.PermissionFlag=b;const y={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};p.TextRenderingMode=y;const o={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};p.ImageKind=o;const t={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};p.AnnotationType=t;const n={MARKED:"Marked",REVIEW:"Review"};p.AnnotationStateModelType=n;const r={MARKED:"Marked",UNMARKED:"Unmarked"};p.AnnotationMarkedState=r;const g={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};p.AnnotationReviewState=g;const m={GROUP:"Group",REPLY:"R"};p.AnnotationReplyType=m;const a={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};p.AnnotationFlag=a;const e={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};p.AnnotationFieldFlag=e;const s={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};p.AnnotationBorderStyleType=s;const d={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};p.AnnotationActionEventType=d;const x={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};p.DocumentActionEventType=x;const A={O:"PageOpen",C:"PageClose"};p.PageActionEventType=A;const u={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};p.StreamType=u;const w={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};p.FontType=w;const J={ERRORS:0,WARNINGS:1,INFOS:5};p.VerbosityLevel=J;const st={NONE:0,BINARY:1,STREAM:2};p.CMapCompressionType=st;const Y={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};p.OPS=Y;const z={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};p.UNSUPPORTED_FEATURES=z;const j={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};p.PasswordResponses=j;let q=J.WARNINGS;function G(V){Number.isInteger(V)&&(q=V)}function et(){return q}function ct(V){q>=J.INFOS&&console.log(`Info: ${V}`)}function bt(V){q>=J.WARNINGS&&console.log(`Warning: ${V}`)}function D(V){throw new Error(V)}function c(V,U){V||D(U)}function l(V){if(!V)return!1;switch(V.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function T(V,U=null,B=null){if(!V)return null;try{if(B&&typeof V=="string"){if(B.addDefaultProtocol&&V.startsWith("www.")){const _t=V.match(/\./g);_t&&_t.length>=2&&(V=`http://${V}`)}if(B.tryConvertEncoding)try{V=Xt(V)}catch{}}const gt=U?new URL(V,U):new URL(V);if(l(gt))return gt}catch{}return null}function M(V,U,B){return Object.defineProperty(V,U,{value:B,enumerable:!0,configurable:!0,writable:!1}),B}const O=function(){function U(B,gt){this.constructor===U&&D("Cannot initialize BaseException."),this.message=B,this.name=gt}return U.prototype=new Error,U.constructor=U,U}();p.BaseException=O;class I extends O{constructor(U,B){super(U,"PasswordException"),this.code=B}}p.PasswordException=I;class X extends O{constructor(U,B){super(U,"UnknownErrorException"),this.details=B}}p.UnknownErrorException=X;class H extends O{constructor(U){super(U,"InvalidPDFException")}}p.InvalidPDFException=H;class i extends O{constructor(U){super(U,"MissingPDFException")}}p.MissingPDFException=i;class h extends O{constructor(U,B){super(U,"UnexpectedResponseException"),this.status=B}}p.UnexpectedResponseException=h;class _ extends O{constructor(U){super(U,"FormatError")}}p.FormatError=_;class v extends O{constructor(U){super(U,"AbortException")}}p.AbortException=v;function k(V){(typeof V!="object"||V===null||V.length===void 0)&&D("Invalid argument for bytesToString");const U=V.length,B=8192;if(U<B)return String.fromCharCode.apply(null,V);const gt=[];for(let _t=0;_t<U;_t+=B){const yt=Math.min(_t+B,U),St=V.subarray(_t,yt);gt.push(String.fromCharCode.apply(null,St))}return gt.join("")}function L(V){typeof V!="string"&&D("Invalid argument for stringToBytes");const U=V.length,B=new Uint8Array(U);for(let gt=0;gt<U;++gt)B[gt]=V.charCodeAt(gt)&255;return B}function nt(V){if(V.length!==void 0)return V.length;if(V.byteLength!==void 0)return V.byteLength;D("Invalid argument for arrayByteLength")}function dt(V){const U=V.length;if(U===1&&V[0]instanceof Uint8Array)return V[0];let B=0;for(let yt=0;yt<U;yt++)B+=nt(V[yt]);let gt=0;const _t=new Uint8Array(B);for(let yt=0;yt<U;yt++){let St=V[yt];St instanceof Uint8Array||(typeof St=="string"?St=L(St):St=new Uint8Array(St));const wt=St.byteLength;_t.set(St,gt),gt+=wt}return _t}function K(V){return String.fromCharCode(V>>24&255,V>>16&255,V>>8&255,V&255)}function ot(V){return Object.keys(V).length}function Z(V){const U=Object.create(null);for(const[B,gt]of V)U[B]=gt;return U}function lt(){const V=new Uint8Array(4);return V[0]=1,new Uint32Array(V.buffer,0,1)[0]===1}function ft(){try{return new Function(""),!0}catch{return!1}}class R{static get isLittleEndian(){return M(this,"isLittleEndian",lt())}static get isEvalSupported(){return M(this,"isEvalSupported",ft())}static get isOffscreenCanvasSupported(){return M(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas!="undefined")}}p.FeatureTest=R;const ut=[...Array(256).keys()].map(V=>V.toString(16).padStart(2,"0"));class At{static makeHexColor(U,B,gt){return`#${ut[U]}${ut[B]}${ut[gt]}`}static scaleMinMax(U,B){let gt;U[0]?(U[0]<0&&(gt=B[0],B[0]=B[1],B[1]=gt),B[0]*=U[0],B[1]*=U[0],U[3]<0&&(gt=B[2],B[2]=B[3],B[3]=gt),B[2]*=U[3],B[3]*=U[3]):(gt=B[0],B[0]=B[2],B[2]=gt,gt=B[1],B[1]=B[3],B[3]=gt,U[1]<0&&(gt=B[2],B[2]=B[3],B[3]=gt),B[2]*=U[1],B[3]*=U[1],U[2]<0&&(gt=B[0],B[0]=B[1],B[1]=gt),B[0]*=U[2],B[1]*=U[2]),B[0]+=U[4],B[1]+=U[4],B[2]+=U[5],B[3]+=U[5]}static transform(U,B){return[U[0]*B[0]+U[2]*B[1],U[1]*B[0]+U[3]*B[1],U[0]*B[2]+U[2]*B[3],U[1]*B[2]+U[3]*B[3],U[0]*B[4]+U[2]*B[5]+U[4],U[1]*B[4]+U[3]*B[5]+U[5]]}static applyTransform(U,B){const gt=U[0]*B[0]+U[1]*B[2]+B[4],_t=U[0]*B[1]+U[1]*B[3]+B[5];return[gt,_t]}static applyInverseTransform(U,B){const gt=B[0]*B[3]-B[1]*B[2],_t=(U[0]*B[3]-U[1]*B[2]+B[2]*B[5]-B[4]*B[3])/gt,yt=(-U[0]*B[1]+U[1]*B[0]+B[4]*B[1]-B[5]*B[0])/gt;return[_t,yt]}static getAxialAlignedBoundingBox(U,B){const gt=At.applyTransform(U,B),_t=At.applyTransform(U.slice(2,4),B),yt=At.applyTransform([U[0],U[3]],B),St=At.applyTransform([U[2],U[1]],B);return[Math.min(gt[0],_t[0],yt[0],St[0]),Math.min(gt[1],_t[1],yt[1],St[1]),Math.max(gt[0],_t[0],yt[0],St[0]),Math.max(gt[1],_t[1],yt[1],St[1])]}static inverseTransform(U){const B=U[0]*U[3]-U[1]*U[2];return[U[3]/B,-U[1]/B,-U[2]/B,U[0]/B,(U[2]*U[5]-U[4]*U[3])/B,(U[4]*U[1]-U[5]*U[0])/B]}static apply3dTransform(U,B){return[U[0]*B[0]+U[1]*B[1]+U[2]*B[2],U[3]*B[0]+U[4]*B[1]+U[5]*B[2],U[6]*B[0]+U[7]*B[1]+U[8]*B[2]]}static singularValueDecompose2dScale(U){const B=[U[0],U[2],U[1],U[3]],gt=U[0]*B[0]+U[1]*B[2],_t=U[0]*B[1]+U[1]*B[3],yt=U[2]*B[0]+U[3]*B[2],St=U[2]*B[1]+U[3]*B[3],wt=(gt+St)/2,Dt=Math.sqrt((gt+St)**2-4*(gt*St-yt*_t))/2,kt=wt+Dt||1,Ct=wt-Dt||1;return[Math.sqrt(kt),Math.sqrt(Ct)]}static normalizeRect(U){const B=U.slice(0);return U[0]>U[2]&&(B[0]=U[2],B[2]=U[0]),U[1]>U[3]&&(B[1]=U[3],B[3]=U[1]),B}static intersect(U,B){const gt=Math.max(Math.min(U[0],U[2]),Math.min(B[0],B[2])),_t=Math.min(Math.max(U[0],U[2]),Math.max(B[0],B[2]));if(gt>_t)return null;const yt=Math.max(Math.min(U[1],U[3]),Math.min(B[1],B[3])),St=Math.min(Math.max(U[1],U[3]),Math.max(B[1],B[3]));return yt>St?null:[gt,yt,_t,St]}static bezierBoundingBox(U,B,gt,_t,yt,St,wt,Dt){const kt=[],Ct=[[],[]];let Lt,It,Ut,Pt,Nt,Wt,zt,Vt;for(let $t=0;$t<2;++$t){if($t===0?(It=6*U-12*gt+6*yt,Lt=-3*U+9*gt-9*yt+3*wt,Ut=3*gt-3*U):(It=6*B-12*_t+6*St,Lt=-3*B+9*_t-9*St+3*Dt,Ut=3*_t-3*B),Math.abs(Lt)<1e-12){if(Math.abs(It)<1e-12)continue;Pt=-Ut/It,0<Pt&&Pt<1&&kt.push(Pt);continue}zt=It*It-4*Ut*Lt,Vt=Math.sqrt(zt),!(zt<0)&&(Nt=(-It+Vt)/(2*Lt),0<Nt&&Nt<1&&kt.push(Nt),Wt=(-It-Vt)/(2*Lt),0<Wt&&Wt<1&&kt.push(Wt))}let Ht=kt.length,jt;const qt=Ht;for(;Ht--;)Pt=kt[Ht],jt=1-Pt,Ct[0][Ht]=jt*jt*jt*U+3*jt*jt*Pt*gt+3*jt*Pt*Pt*yt+Pt*Pt*Pt*wt,Ct[1][Ht]=jt*jt*jt*B+3*jt*jt*Pt*_t+3*jt*Pt*Pt*St+Pt*Pt*Pt*Dt;return Ct[0][qt]=U,Ct[1][qt]=B,Ct[0][qt+1]=wt,Ct[1][qt+1]=Dt,Ct[0].length=Ct[1].length=qt+2,[Math.min(...Ct[0]),Math.min(...Ct[1]),Math.max(...Ct[0]),Math.max(...Ct[1])]}}p.Util=At;const vt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Et(V){if(V[0]>="\xEF"){let B;if(V[0]==="\xFE"&&V[1]==="\xFF"?B="utf-16be":V[0]==="\xFF"&&V[1]==="\xFE"?B="utf-16le":V[0]==="\xEF"&&V[1]==="\xBB"&&V[2]==="\xBF"&&(B="utf-8"),B)try{const gt=new TextDecoder(B,{fatal:!0}),_t=L(V);return gt.decode(_t)}catch(gt){bt(`stringToPDFString: "${gt}".`)}}const U=[];for(let B=0,gt=V.length;B<gt;B++){const _t=vt[V.charCodeAt(B)];U.push(_t?String.fromCharCode(_t):V.charAt(B))}return U.join("")}function Tt(V){return V.replace(/([()\\\n\r])/g,U=>U===`
`?"\\n":U==="\r"?"\\r":`\\${U}`)}function Rt(V){return/^[\x00-\x7F]*$/.test(V)}function Ft(V){const U=["\xFE\xFF"];for(let B=0,gt=V.length;B<gt;B++){const _t=V.charCodeAt(B);U.push(String.fromCharCode(_t>>8&255),String.fromCharCode(_t&255))}return U.join("")}function Xt(V){return decodeURIComponent(escape(V))}function xt(V){return unescape(encodeURIComponent(V))}function Ot(V){return typeof V=="object"&&V!==null&&V.byteLength!==void 0}function Zt(V,U){if(V.length!==U.length)return!1;for(let B=0,gt=V.length;B<gt;B++)if(V[B]!==U[B])return!1;return!0}function rt(V=new Date){return[V.getUTCFullYear().toString(),(V.getUTCMonth()+1).toString().padStart(2,"0"),V.getUTCDate().toString().padStart(2,"0"),V.getUTCHours().toString().padStart(2,"0"),V.getUTCMinutes().toString().padStart(2,"0"),V.getUTCSeconds().toString().padStart(2,"0")].join("")}function pt(){const V=Object.create(null);let U=!1;return Object.defineProperty(V,"settled",{get(){return U}}),V.promise=new Promise(function(B,gt){V.resolve=function(_t){U=!0,B(_t)},V.reject=function(_t){U=!0,gt(_t)}}),V}},(it,p,$)=>{$(3)},(it,p)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.isNodeJS=void 0;const $=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");p.isNodeJS=$},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var it,$,S,C,Q,W,tt,N,f,he,F,b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:o,NodeCMapReaderFactory:t,NodeStandardFontDataFactory:n}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=o,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=t,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=n}let createPDFNetworkStream;function setPDFNetworkStreamFactory(o){createPDFNetworkStream=o}function getDocument(o){const t=new PDFDocumentLoadingTask;let n;if(typeof o=="string"||o instanceof URL)n={url:o};else if((0,_util.isArrayBuffer)(o))n={data:o};else if(o instanceof PDFDataRangeTransport)n={range:o};else{if(typeof o!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!o.url&&!o.data&&!o.range)throw new Error("Invalid parameter object: need either .data, .range or .url");n=o}const r=Object.create(null);let g=null,m=null;for(const e in n){const s=n[e];switch(e){case"url":if(typeof window!="undefined")try{r[e]=new URL(s,window.location).href;continue}catch(d){(0,_util.warn)(`Cannot create valid URL: "${d}".`)}else if(typeof s=="string"||s instanceof URL){r[e]=s.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":g=s;continue;case"worker":m=s;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer!="undefined"&&s instanceof Buffer)r[e]=new Uint8Array(s);else{if(s instanceof Uint8Array)break;if(typeof s=="string")r[e]=(0,_util.stringToBytes)(s);else if(typeof s=="object"&&s!==null&&!isNaN(s.length))r[e]=new Uint8Array(s);else if((0,_util.isArrayBuffer)(s))r[e]=new Uint8Array(s);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}r[e]=s}if(r.CMapReaderFactory=r.CMapReaderFactory||DefaultCMapReaderFactory,r.StandardFontDataFactory=r.StandardFontDataFactory||DefaultStandardFontDataFactory,r.ignoreErrors=r.stopAtErrors!==!0,r.fontExtraProperties=r.fontExtraProperties===!0,r.pdfBug=r.pdfBug===!0,r.enableXfa=r.enableXfa===!0,(!Number.isInteger(r.rangeChunkSize)||r.rangeChunkSize<1)&&(r.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof r.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(r.docBaseUrl))&&(r.docBaseUrl=null),(!Number.isInteger(r.maxImageSize)||r.maxImageSize<-1)&&(r.maxImageSize=-1),typeof r.cMapUrl!="string"&&(r.cMapUrl=null),typeof r.standardFontDataUrl!="string"&&(r.standardFontDataUrl=null),typeof r.useWorkerFetch!="boolean"&&(r.useWorkerFetch=r.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&r.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof r.isEvalSupported!="boolean"&&(r.isEvalSupported=!0),typeof r.disableFontFace!="boolean"&&(r.disableFontFace=_is_node.isNodeJS),typeof r.useSystemFonts!="boolean"&&(r.useSystemFonts=!_is_node.isNodeJS&&!r.disableFontFace),(typeof r.ownerDocument!="object"||r.ownerDocument===null)&&(r.ownerDocument=globalThis.document),typeof r.disableRange!="boolean"&&(r.disableRange=!1),typeof r.disableStream!="boolean"&&(r.disableStream=!1),typeof r.disableAutoFetch!="boolean"&&(r.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(r.verbosity),!m){const e={verbosity:r.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};m=e.port?PDFWorker.fromPort(e):new PDFWorker(e),t._worker=m}const a=t.docId;return m.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");const e=_fetchDocument(m,r,g,a),s=new Promise(function(d){let x;g?x=new _transport_stream.PDFDataTransportStream({length:r.length,initialData:r.initialData,progressiveDone:r.progressiveDone,contentDispositionFilename:r.contentDispositionFilename,disableRange:r.disableRange,disableStream:r.disableStream},g):r.data||(x=createPDFNetworkStream({url:r.url,length:r.length,httpHeaders:r.httpHeaders,withCredentials:r.withCredentials,rangeChunkSize:r.rangeChunkSize,disableRange:r.disableRange,disableStream:r.disableStream})),d(x)});return Promise.all([e,s]).then(function([d,x]){if(t.destroyed)throw new Error("Loading aborted");const A=new _message_handler.MessageHandler(a,d,m.port),u=new WorkerTransport(A,t,x,r);t._transport=u,A.send("Ready",null)})}).catch(t._capability.reject),t}async function _fetchDocument(o,t,n,r){if(o.destroyed)throw new Error("Worker was destroyed");n&&(t.length=n.length,t.initialData=n.initialData,t.progressiveDone=n.progressiveDone,t.contentDispositionFilename=n.contentDispositionFilename);const g=await o.messageHandler.sendWithPromise("GetDocRequest",{docId:r,apiVersion:"2.16.105",source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,docBaseUrl:t.docBaseUrl,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported,fontExtraProperties:t.fontExtraProperties,enableXfa:t.enableXfa,useSystemFonts:t.useSystemFonts,cMapUrl:t.useWorkerFetch?t.cMapUrl:null,standardFontDataUrl:t.useWorkerFetch?t.standardFontDataUrl:null});if(t.data&&(t.data=null),o.destroyed)throw new Error("Worker was destroyed");return g}const p=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${ce(p,it)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var t;this.destroyed=!0,await((t=this._transport)==null?void 0:t.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=p;it=new WeakMap,at(PDFDocumentLoadingTask,it,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(t,n,r=!1,g=null){this.length=t,this.initialData=n,this.progressiveDone=r,this.contentDispositionFilename=g,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,n){for(const r of this._rangeListeners)r(t,n)}onDataProgress(t,n){this._readyCapability.promise.then(()=>{for(const r of this._progressListeners)r(t,n)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const n of this._progressiveReadListeners)n(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,n){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,n){this._pdfInfo=t,this._transport=n,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(t,n,r,g,m=!1){this._pageIndex=t,this._pageInfo=n,this._ownerDocument=g,this._transport=r,this._stats=m?new _display_utils.StatTimer:null,this._pdfBug=m,this.commonObjs=r.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:n=this.rotate,offsetX:r=0,offsetY:g=0,dontFlip:m=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:n,offsetX:r,offsetY:g,dontFlip:m})}getAnnotations({intent:t="display"}={}){const n=this._transport.getRenderingIntent(t);let r=this._annotationPromises.get(n.cacheKey);return r||(r=this._transport.getAnnotations(this._pageIndex,n.renderingIntent),this._annotationPromises.set(n.cacheKey,r),r=r.then(g=>{for(const m of g)m.titleObj!==void 0&&Object.defineProperty(m,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),m.titleObj.str}}),m.contentsObj!==void 0&&Object.defineProperty(m,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),m.contentsObj.str}});return g})),r}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:n,intent:r="display",annotationMode:g=_util.AnnotationMode.ENABLE,transform:m=null,imageLayer:a=null,canvasFactory:e=null,background:s=null,optionalContentConfigPromise:d=null,annotationCanvasMap:x=null,pageColors:A=null,printAnnotationStorage:u=null}){var G,et;((G=arguments[0])==null?void 0:G.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&g===_util.AnnotationMode.ENABLE&&(g=_util.AnnotationMode.ENABLE_FORMS)),((et=arguments[0])==null?void 0:et.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&g===_util.AnnotationMode.ENABLE&&(g=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const w=this._transport.getRenderingIntent(r,g,u);this.pendingCleanup=!1,d||(d=this._transport.getOptionalContentConfig());let J=this._intentStates.get(w.cacheKey);J||(J=Object.create(null),this._intentStates.set(w.cacheKey,J)),J.streamReaderCancelTimeout&&(clearTimeout(J.streamReaderCancelTimeout),J.streamReaderCancelTimeout=null);const st=e||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),Y=!!(w.renderingIntent&_util.RenderingIntentFlag.PRINT);J.displayReadyCapability||(J.displayReadyCapability=(0,_util.createPromiseCapability)(),J.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(w));const z=ct=>{J.renderTasks.delete(j),(this.cleanupAfterRender||Y)&&(this.pendingCleanup=!0),this._tryCleanup(),ct?(j.capability.reject(ct),this._abortOperatorList({intentState:J,reason:ct instanceof Error?ct:new Error(ct)})):j.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},j=new InternalRenderTask({callback:z,params:{canvasContext:t,viewport:n,transform:m,imageLayer:a,background:s},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:x,operatorList:J.operatorList,pageIndex:this._pageIndex,canvasFactory:st,useRequestAnimationFrame:!Y,pdfBug:this._pdfBug,pageColors:A});(J.renderTasks||(J.renderTasks=new Set)).add(j);const q=j.task;return Promise.all([J.displayReadyCapability.promise,d]).then(([ct,bt])=>{if(this.pendingCleanup){z();return}this._stats&&this._stats.time("Rendering"),j.initializeGraphics({transparency:ct,optionalContentConfig:bt}),j.operatorListChanged()}).catch(z),q}getOperatorList({intent:t="display",annotationMode:n=_util.AnnotationMode.ENABLE,printAnnotationStorage:r=null}={}){function g(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(e))}const m=this._transport.getRenderingIntent(t,n,r,!0);let a=this._intentStates.get(m.cacheKey);a||(a=Object.create(null),this._intentStates.set(m.cacheKey,a));let e;return a.opListReadCapability||(e=Object.create(null),e.operatorListChanged=g,a.opListReadCapability=(0,_util.createPromiseCapability)(),(a.renderTasks||(a.renderTasks=new Set)).add(e),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(m)),a.opListReadCapability.promise}streamTextContent({disableCombineTextItems:t=!1,includeMarkedContent:n=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:t!==!0,includeMarkedContent:n===!0},{highWaterMark:100,size(g){return g.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>_xfa_text.XfaText.textContent(r));const n=this.streamTextContent(t);return new Promise(function(r,g){function m(){a.read().then(function({value:s,done:d}){if(d){r(e);return}Object.assign(e.styles,s.styles),e.items.push(...s.items),m()},g)}const a=n.getReader(),e={items:[],styles:Object.create(null)};m()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const t=[];for(const n of this._intentStates.values())if(this._abortOperatorList({intentState:n,reason:new Error("Page was destroyed."),force:!0}),!n.opListReadCapability)for(const r of n.renderTasks)t.push(r.completed),r.cancel();this.objs.clear();for(const n of this._bitmaps)n.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(t)}cleanup(t=!1){return this.pendingCleanup=!0,this._tryCleanup(t)}_tryCleanup(t=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:n,operatorList:r}of this._intentStates.values())if(n.size>0||!r.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,t&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const n of this._bitmaps)n.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(t,n){const r=this._intentStates.get(n);!r||(this._stats&&this._stats.timeEnd("Page Request"),r.displayReadyCapability&&r.displayReadyCapability.resolve(t))}_renderPageChunk(t,n){for(let r=0,g=t.length;r<g;r++)n.operatorList.fnArray.push(t.fnArray[r]),n.operatorList.argsArray.push(t.argsArray[r]);n.operatorList.lastChunk=t.lastChunk,n.operatorList.separateAnnots=t.separateAnnots;for(const r of n.renderTasks)r.operatorListChanged();t.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:t,cacheKey:n,annotationStorageMap:r}){const m=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:n,annotationStorage:r}).getReader(),a=this._intentStates.get(n);a.streamReader=m;const e=()=>{m.read().then(({value:s,done:d})=>{if(d){a.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(s,a),e())},s=>{if(a.streamReader=null,!this._transport.destroyed){if(a.operatorList){a.operatorList.lastChunk=!0;for(const d of a.renderTasks)d.operatorListChanged();this._tryCleanup()}if(a.displayReadyCapability)a.displayReadyCapability.reject(s);else if(a.opListReadCapability)a.opListReadCapability.reject(s);else throw s}})};e()}_abortOperatorList({intentState:t,reason:n,force:r=!1}){if(!!t.streamReader){if(!r){if(t.renderTasks.size>0)return;if(n instanceof _display_utils.RenderingCancelledException){t.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:t,reason:n,force:!0}),t.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(t.streamReader.cancel(new _util.AbortException(n.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[g,m]of this._intentStates)if(m===t){this._intentStates.delete(g);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(t,n){const r={data:structuredClone(t,n)};this._deferred.then(()=>{for(const g of this._listeners)g.call(this,r)})}addEventListener(t,n){this._listeners.push(n)}removeEventListener(t,n){const r=this._listeners.indexOf(n);this._listeners.splice(r,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const o=($=document==null?void 0:document.currentScript)==null?void 0:$.src;o&&(PDFWorkerUtil.fallbackWorkerSrc=o.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(o,t){let n;try{if(n=new URL(o),!n.origin||n.origin==="null")return!1}catch{return!1}const r=new URL(t,n);return n.origin===r.origin},PDFWorkerUtil.createCDNWrapper=function(o){const t=`importScripts("${o}");`;return URL.createObjectURL(new Blob([t]))}}const _PDFWorker=class{constructor({name:o=null,port:t=null,verbosity:n=(0,_util.getVerbosityLevel)()}={}){if(t&&P(_PDFWorker,S).has(t))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=o,this.destroyed=!1,this.verbosity=n,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,t){P(_PDFWorker,S).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(o){this._port=o,this._messageHandler=new _message_handler.MessageHandler("main","worker",o),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:o}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,o)||(o=PDFWorkerUtil.createCDNWrapper(new URL(o,window.location).href));const t=new Worker(o),n=new _message_handler.MessageHandler("main","worker",t),r=()=>{t.removeEventListener("error",g),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},g=()=>{this._webWorker||r()};t.addEventListener("error",g),n.on("test",a=>{if(t.removeEventListener("error",g),this.destroyed){r();return}a?(this._messageHandler=n,this._port=t,this._webWorker=t,this._readyCapability.resolve(),n.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),n.destroy(),t.terminate())}),n.on("ready",a=>{if(t.removeEventListener("error",g),this.destroyed){r();return}try{m()}catch{this._setupFakeWorker()}});const m=()=>{const a=new Uint8Array;n.send("test",a,[a.buffer])};m();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(o=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new LoopbackPort;this._port=t;const n=`fake${PDFWorkerUtil.fakeWorkerId++}`,r=new _message_handler.MessageHandler(n+"_worker",n,t);o.setup(r,t);const g=new _message_handler.MessageHandler(n,n+"_worker",t);this._messageHandler=g,this._readyCapability.resolve(),g.send("configure",{verbosity:this.verbosity})}).catch(o=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${o.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),P(_PDFWorker,S).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(o){if(!(o!=null&&o.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return P(this,S).has(o.port)?P(this,S).get(o.port):new _PDFWorker(o)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var o;try{return((o=globalThis.pdfjsWorker)==null?void 0:o.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;S=new WeakMap,at(PDFWorker,S,new WeakMap),exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(t,n,r,g){at(this,C,null);at(this,Q,new Map);at(this,W,new Map);at(this,tt,null);this.messageHandler=t,this.loadingTask=n,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:n.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:g.ownerDocument,styleElement:g.styleElement}),this._params=g,g.useWorkerFetch||(this.CMapReaderFactory=new g.CMapReaderFactory({baseUrl:g.cMapUrl,isCompressed:g.cMapPacked}),this.StandardFontDataFactory=new g.StandardFontDataFactory({baseUrl:g.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return P(this,C)}getRenderingIntent(t,n=_util.AnnotationMode.ENABLE,r=null,g=!1){let m=_util.RenderingIntentFlag.DISPLAY,a=null;switch(t){case"any":m=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":m=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(n){case _util.AnnotationMode.DISABLE:m+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:m+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:m+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,a=(m&_util.RenderingIntentFlag.PRINT&&r instanceof _annotation_storage.PrintAnnotationStorage?r:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${n}`)}return g&&(m+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:m,cacheKey:`${m}_${_annotation_storage.AnnotationStorage.getHash(a)}`,annotationStorageMap:a}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const r of P(this,Q).values())t.push(r._destroy());P(this,Q).clear(),P(this,W).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const n=this.messageHandler.sendWithPromise("Terminate",null);return t.push(n),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),mt(this,tt,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:n}=this;t.on("GetReader",(r,g)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=m=>{this._lastProgress={loaded:m.loaded,total:m.total}},g.onPull=()=>{this._fullReader.read().then(function({value:m,done:a}){if(a){g.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(m),"GetReader - expected an ArrayBuffer."),g.enqueue(new Uint8Array(m),1,[m])}).catch(m=>{g.error(m)})},g.onCancel=m=>{this._fullReader.cancel(m),g.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",r=>{const g=(0,_util.createPromiseCapability)(),m=this._fullReader;return m.headersReady.then(()=>{var a;(!m.isStreamingSupported||!m.isRangeSupported)&&(this._lastProgress&&((a=n.onProgress)==null||a.call(n,this._lastProgress)),m.onProgress=e=>{var s;(s=n.onProgress)==null||s.call(n,{loaded:e.loaded,total:e.total})}),g.resolve({isStreamingSupported:m.isStreamingSupported,isRangeSupported:m.isRangeSupported,contentLength:m.contentLength})},g.reject),g.promise}),t.on("GetRangeReader",(r,g)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const m=this._networkStream.getRangeReader(r.begin,r.end);if(!m){g.close();return}g.onPull=()=>{m.read().then(function({value:a,done:e}){if(e){g.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(a),"GetRangeReader - expected an ArrayBuffer."),g.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{g.error(a)})},g.onCancel=a=>{m.cancel(a),g.ready.catch(e=>{if(!this.destroyed)throw e})}}),t.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,n._capability.resolve(new PDFDocumentProxy(r,this))}),t.on("DocException",function(r){let g;switch(r.name){case"PasswordException":g=new _util.PasswordException(r.message,r.code);break;case"InvalidPDFException":g=new _util.InvalidPDFException(r.message);break;case"MissingPDFException":g=new _util.MissingPDFException(r.message);break;case"UnexpectedResponseException":g=new _util.UnexpectedResponseException(r.message,r.status);break;case"UnknownErrorException":g=new _util.UnknownErrorException(r.message,r.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}n._capability.reject(g)}),t.on("PasswordRequest",r=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),n.onPassword){const g=m=>{m instanceof Error?this._passwordCapability.reject(m):this._passwordCapability.resolve({password:m})};try{n.onPassword(g,r.code)}catch(m){this._passwordCapability.reject(m)}}else this._passwordCapability.reject(new _util.PasswordException(r.message,r.code));return this._passwordCapability.promise}),t.on("DataLoaded",r=>{var g;(g=n.onProgress)==null||g.call(n,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),t.on("StartRenderPage",r=>{if(this.destroyed)return;P(this,Q).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),t.on("commonobj",([r,g,m])=>{var a;if(!this.destroyed&&!this.commonObjs.has(r))switch(g){case"Font":const e=this._params;if("error"in m){const x=m.error;(0,_util.warn)(`Error during font loading: ${x}`),this.commonObjs.resolve(r,x);break}let s=null;e.pdfBug&&((a=globalThis.FontInspector)==null?void 0:a.enabled)&&(s={registerFont(x,A){globalThis.FontInspector.fontAdded(x,A)}});const d=new _font_loader.FontFaceObject(m,{isEvalSupported:e.isEvalSupported,disableFontFace:e.disableFontFace,ignoreErrors:e.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:s});this.fontLoader.bind(d).catch(x=>t.sendWithPromise("FontFallback",{id:r})).finally(()=>{!e.fontExtraProperties&&d.data&&(d.data=null),this.commonObjs.resolve(r,d)});break;case"FontPath":case"Image":this.commonObjs.resolve(r,m);break;default:throw new Error(`Got unknown common object type ${g}`)}}),t.on("obj",([r,g,m,a])=>{var s;if(this.destroyed)return;const e=P(this,Q).get(g);if(!e.objs.has(r))switch(m){case"Image":e.objs.resolve(r,a);const d=8e6;if(a){let x;if(a.bitmap){const{bitmap:A,width:u,height:w}=a;x=u*w*4,e._bitmaps.add(A)}else x=((s=a.data)==null?void 0:s.length)||0;x>d&&(e.cleanupAfterRender=!0)}break;case"Pattern":e.objs.resolve(r,a);break;default:throw new Error(`Got unknown object type ${m}`)}}),t.on("DocProgress",r=>{var g;this.destroyed||(g=n.onProgress)==null||g.call(n,{loaded:r.loaded,total:r.total})}),t.on("DocStats",r=>{this.destroyed||mt(this,C,Object.freeze({streamTypes:Object.freeze(r.streamTypes),fontTypes:Object.freeze(r.fontTypes)}))}),t.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),t.on("FetchBuiltInCMap",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(r):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(r):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:t}){var n,r;this.destroyed||(r=(n=this.loadingTask).onUnsupportedFeature)==null||r.call(n,t)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const n=t-1,r=P(this,W).get(n);if(r)return r;const g=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then(m=>{if(this.destroyed)throw new Error("Transport destroyed");const a=new PDFPageProxy(n,m,this,this._params.ownerDocument,this._params.pdfBug);return P(this,Q).set(n,a),a});return P(this,W).set(n,g),g}getPageIndex(t){return typeof t!="object"||t===null||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,n){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:n})}saveDocument(){var t,n;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:(n=(t=this._fullReader)==null?void 0:t.filename)!=null?n:null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(t=>new _optional_content_config.OptionalContentConfig(t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return P(this,tt)||mt(this,tt,this.messageHandler.sendWithPromise("GetMetadata",null).then(t=>{var n,r,g,m;return{info:t[0],metadata:t[1]?new _metadata.Metadata(t[1]):null,contentDispositionFilename:(r=(n=this._fullReader)==null?void 0:n.filename)!=null?r:null,contentLength:(m=(g=this._fullReader)==null?void 0:g.contentLength)!=null?m:null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const n of P(this,Q).values())if(!n.cleanup())throw new Error(`startCleanup: Page ${n.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),mt(this,tt,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const t=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t.disableAutoFetch,enableXfa:t.enableXfa})}}C=new WeakMap,Q=new WeakMap,W=new WeakMap,tt=new WeakMap;class PDFObjects{constructor(){at(this,f);at(this,N,Object.create(null))}get(t,n=null){if(n){const g=ht(this,f,he).call(this,t);return g.capability.promise.then(()=>n(g.data)),null}const r=P(this,N)[t];if(!(r!=null&&r.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${t}.`);return r.data}has(t){const n=P(this,N)[t];return(n==null?void 0:n.capability.settled)||!1}resolve(t,n=null){const r=ht(this,f,he).call(this,t);r.data=n,r.capability.resolve()}clear(){mt(this,N,Object.create(null))}}N=new WeakMap,f=new WeakSet,he=function(t){const n=P(this,N)[t];return n||(P(this,N)[t]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(t){at(this,F,null);mt(this,F,t),this.onContinue=null}get promise(){return P(this,F).capability.promise}cancel(){P(this,F).cancel()}get separateAnnots(){const{separateAnnots:t}=P(this,F).operatorList;if(!t)return!1;const{annotationCanvasMap:n}=P(this,F);return t.form||t.canvas&&(n==null?void 0:n.size)>0}}F=new WeakMap,exports.RenderTask=RenderTask;const y=class{constructor({callback:t,params:n,objs:r,commonObjs:g,annotationCanvasMap:m,operatorList:a,pageIndex:e,canvasFactory:s,useRequestAnimationFrame:d=!1,pdfBug:x=!1,pageColors:A=null}){this.callback=t,this.params=n,this.objs=r,this.commonObjs=g,this.annotationCanvasMap=m,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=e,this.canvasFactory=s,this._pdfBug=x,this.pageColors=A,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window!="undefined",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=n.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:n}){var s;if(this.cancelled)return;if(this._canvas){if(P(y,b).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");P(y,b).add(this._canvas)}this._pdfBug&&((s=globalThis.StepperManager)==null?void 0:s.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:g,transform:m,imageLayer:a,background:e}=this.params;this.gfx=new _canvas.CanvasGraphics(r,this.commonObjs,this.objs,this.canvasFactory,a,n,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:m,viewport:g,transparency:t,background:e}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(t=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&P(y,b).delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&P(y,b).delete(this._canvas),this.callback())))}};let InternalRenderTask=y;b=new WeakMap,at(InternalRenderTask,b,new WeakSet);const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(it,p,$)=>{var N,Pe,E;Object.defineProperty(p,"__esModule",{value:!0}),p.PrintAnnotationStorage=p.AnnotationStorage=void 0;var S=$(1),C=$(6),Q=$(10);class W{constructor(){at(this,N);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(b,y){const o=this._storage.get(b);return o===void 0?y:Object.assign(y,o)}getRawValue(b){return this._storage.get(b)}remove(b){if(this._storage.delete(b),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const y of this._storage.values())if(y instanceof C.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(b,y){const o=this._storage.get(b);let t=!1;if(o!==void 0)for(const[n,r]of Object.entries(y))o[n]!==r&&(t=!0,o[n]=r);else t=!0,this._storage.set(b,y);t&&ht(this,N,Pe).call(this),y instanceof C.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(y.constructor._type)}has(b){return this._storage.has(b)}getAll(){return this._storage.size>0?(0,S.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new tt(this)}get serializable(){if(this._storage.size===0)return null;const b=new Map;for(const[y,o]of this._storage){const t=o instanceof C.AnnotationEditor?o.serialize():o;t&&b.set(y,t)}return b}static getHash(b){if(!b)return"";const y=new Q.MurmurHash3_64;for(const[o,t]of b)y.update(`${o}:${JSON.stringify(t)}`);return y.hexdigest()}}N=new WeakSet,Pe=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},p.AnnotationStorage=W;class tt extends W{constructor(y){super();at(this,E,null);mt(this,E,structuredClone(y.serializable))}get print(){(0,S.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return P(this,E)}}E=new WeakMap,p.PrintAnnotationStorage=tt},(it,p,$)=>{var W,tt,N,f,E,F;Object.defineProperty(p,"__esModule",{value:!0}),p.AnnotationEditor=void 0;var S=$(7),C=$(1);const b=class{constructor(o){at(this,W,this.focusin.bind(this));at(this,tt,this.focusout.bind(this));at(this,N,!1);at(this,f,!1);at(this,E,!1);at(this,F,b._zIndex++);this.constructor===b&&(0,C.unreachable)("Cannot initialize AnnotationEditor."),this.parent=o.parent,this.id=o.id,this.width=this.height=null,this.pageIndex=o.parent.pageIndex,this.name=o.name,this.div=null;const[t,n]=this.parent.viewportBaseDimensions;this.x=o.x/t,this.y=o.y/n,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,C.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=P(this,F)}focusin(o){P(this,N)?mt(this,N,!1):this.parent.setSelected(this)}focusout(o){if(!this.isAttachedToDOM)return;const t=o.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(o.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(o){const t=this.parent.div.getBoundingClientRect();this.startX=o.clientX-t.x,this.startY=o.clientY-t.y,o.dataTransfer.setData("text/plain",this.id),o.dataTransfer.effectAllowed="move"}setAt(o,t,n,r){const[g,m]=this.parent.viewportBaseDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(o+n)/g,this.y=(t+r)/m,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(o,t){const[n,r]=this.parent.viewportBaseDimensions;[o,t]=this.screenToPageTranslation(o,t),this.x+=o/n,this.y+=t/r,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(o,t){const{rotation:n}=this.parent.viewport;switch(n){case 90:return[t,-o];case 180:return[-o,-t];case 270:return[-t,o];default:return[o,t]}}setDims(o,t){const[n,r]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*o/n}%`,this.div.style.height=`${100*t/r}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",P(this,W)),this.div.addEventListener("focusout",P(this,tt));const[o,t]=this.getInitialTranslation();return this.translate(o,t),(0,S.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(o){const t=S.KeyboardManager.platform.isMac;if(o.button!==0||o.ctrlKey&&t){o.preventDefault();return}o.ctrlKey&&!t||o.shiftKey||o.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this),mt(this,N,!0)}getRect(o,t){const[n,r]=this.parent.viewportBaseDimensions,[g,m]=this.parent.pageDimensions,a=g*o/n,e=m*t/r,s=this.x*g,d=this.y*m,x=this.width*g,A=this.height*m;switch(this.rotation){case 0:return[s+a,m-d-e-A,s+a+x,m-d-e];case 90:return[s+e,m-d+a,s+e+A,m-d+a+x];case 180:return[s-a-x,m-d+e,s-a,m-d+e+A];case 270:return[s-e-A,m-d-a-x,s-e,m-d-a];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(o,t){const[n,r,g,m]=o,a=g-n,e=m-r;switch(this.rotation){case 0:return[n,t-m,a,e];case 90:return[n,t-r,e,a];case 180:return[g,t-r,a,e];case 270:return[g,t-m,e,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){mt(this,E,!0)}disableEditMode(){mt(this,E,!1)}isInEditMode(){return P(this,E)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var o;(o=this.div)==null||o.addEventListener("focusin",P(this,W))}serialize(){(0,C.unreachable)("An editor must be serializable")}static deserialize(o,t){const n=new this.prototype.constructor({parent:t,id:t.getNextId()});n.rotation=o.rotation;const[r,g]=t.pageDimensions,[m,a,e,s]=n.getRectInCurrentCoords(o.rect,g);return n.x=m/r,n.y=a/g,n.width=e/r,n.height=s/g,n}remove(){this.div.removeEventListener("focusin",P(this,W)),this.div.removeEventListener("focusout",P(this,tt)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var o;(o=this.div)==null||o.classList.add("selectedEditor")}unselect(){var o;(o=this.div)==null||o.classList.remove("selectedEditor")}updateParams(o,t){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return P(this,f)}set isEditing(o){mt(this,f,o),o?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let Q=b;W=new WeakMap,tt=new WeakMap,N=new WeakMap,f=new WeakMap,E=new WeakMap,F=new WeakMap,Mt(Q,"_colorManager",new S.ColorManager),Mt(Q,"_zIndex",1),p.AnnotationEditor=Q},(it,p,$)=>{var y,o,t,n,r,g,ke,e,d,x,A,u,w,J,st,Y,z,j,q,G,et,ct,bt,D,c,l,Fe,M,de,I,Bt,H,Jt,h,Re,v,Me,L,ue,dt,Qt,ot,te;Object.defineProperty(p,"__esModule",{value:!0}),p.KeyboardManager=p.CommandManager=p.ColorManager=p.AnnotationEditorUIManager=void 0,p.bindEvents=Q,p.opacityToHex=W;var S=$(1),C=$(8);function Q(ft,R,ut){for(const At of ut)R.addEventListener(At,ft[At].bind(ft))}function W(ft){return Math.round(Math.min(255,Math.max(1,255*ft))).toString(16).padStart(2,"0")}class tt{constructor(){at(this,y,0)}getId(){return`${S.AnnotationEditorPrefix}${ce(this,y)._++}`}}y=new WeakMap;class N{constructor(R=128){at(this,o,[]);at(this,t,!1);at(this,n,void 0);at(this,r,-1);mt(this,n,R)}add({cmd:R,undo:ut,mustExec:At,type:vt=NaN,overwriteIfSameType:Et=!1,keepUndo:Tt=!1}){if(At&&R(),P(this,t))return;const Rt={cmd:R,undo:ut,type:vt};if(P(this,r)===-1){P(this,o).length>0&&(P(this,o).length=0),mt(this,r,0),P(this,o).push(Rt);return}if(Et&&P(this,o)[P(this,r)].type===vt){Tt&&(Rt.undo=P(this,o)[P(this,r)].undo),P(this,o)[P(this,r)]=Rt;return}const Ft=P(this,r)+1;Ft===P(this,n)?P(this,o).splice(0,1):(mt(this,r,Ft),Ft<P(this,o).length&&P(this,o).splice(Ft)),P(this,o).push(Rt)}undo(){P(this,r)!==-1&&(mt(this,t,!0),P(this,o)[P(this,r)].undo(),mt(this,t,!1),mt(this,r,P(this,r)-1))}redo(){P(this,r)<P(this,o).length-1&&(mt(this,r,P(this,r)+1),mt(this,t,!0),P(this,o)[P(this,r)].cmd(),mt(this,t,!1))}hasSomethingToUndo(){return P(this,r)!==-1}hasSomethingToRedo(){return P(this,r)<P(this,o).length-1}destroy(){mt(this,o,null)}}o=new WeakMap,t=new WeakMap,n=new WeakMap,r=new WeakMap,p.CommandManager=N;const a=class{constructor(R){at(this,g);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const ut=a.platform.isMac;for(const[At,vt]of R)for(const Et of At){const Tt=Et.startsWith("mac+");ut&&Tt?(this.callbacks.set(Et.slice(4),vt),this.allKeys.add(Et.split("+").at(-1))):!ut&&!Tt&&(this.callbacks.set(Et,vt),this.allKeys.add(Et.split("+").at(-1)))}}static get platform(){const R=typeof navigator!="undefined"?navigator.platform:"";return(0,S.shadow)(this,"platform",{isWin:R.includes("Win"),isMac:R.includes("Mac")})}exec(R,ut){if(!this.allKeys.has(ut.key))return;const At=this.callbacks.get(ht(this,g,ke).call(this,ut));!At||(At.bind(R)(),ut.stopPropagation(),ut.preventDefault())}};let f=a;g=new WeakSet,ke=function(R){R.altKey&&this.buffer.push("alt"),R.ctrlKey&&this.buffer.push("ctrl"),R.metaKey&&this.buffer.push("meta"),R.shiftKey&&this.buffer.push("shift"),this.buffer.push(R.key);const ut=this.buffer.join("+");return this.buffer.length=0,ut},p.KeyboardManager=f;class E{constructor(){at(this,e,null)}copy(R){!R||(Array.isArray(R)?mt(this,e,R.map(ut=>ut.serialize())):mt(this,e,[R.serialize()]),mt(this,e,P(this,e).filter(ut=>!!ut)),P(this,e).length===0&&mt(this,e,null))}paste(){return P(this,e)}isEmpty(){return P(this,e)===null}destroy(){mt(this,e,null)}}e=new WeakMap;const s=class{get _colors(){const R=new Map([["CanvasText",null],["Canvas",null]]);return(0,C.getColorValues)(R),(0,S.shadow)(this,"_colors",R)}convert(R){const ut=(0,C.getRGB)(R);if(!window.matchMedia("(forced-colors: active)").matches)return ut;for(const[At,vt]of this._colors)if(vt.every((Et,Tt)=>Et===ut[Tt]))return s._colorsMapping.get(At);return ut}getHexCode(R){const ut=this._colors.get(R);return ut?S.Util.makeHexColor(...ut):R}};let F=s;Mt(F,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),p.ColorManager=F;const lt=class{constructor(R,ut){at(this,l);at(this,M);at(this,I);at(this,H);at(this,h);at(this,v);at(this,L);at(this,dt);at(this,ot);at(this,d,null);at(this,x,new Map);at(this,A,new Map);at(this,u,new E);at(this,w,new N);at(this,J,0);at(this,st,null);at(this,Y,null);at(this,z,new tt);at(this,j,!1);at(this,q,S.AnnotationEditorType.NONE);at(this,G,new Set);at(this,et,this.keydown.bind(this));at(this,ct,this.onEditingAction.bind(this));at(this,bt,this.onPageChanging.bind(this));at(this,D,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});at(this,c,null);mt(this,c,R),mt(this,Y,ut),P(this,Y)._on("editingaction",P(this,ct)),P(this,Y)._on("pagechanging",P(this,bt))}destroy(){ht(this,M,de).call(this),P(this,Y)._off("editingaction",P(this,ct)),P(this,Y)._off("pagechanging",P(this,bt));for(const R of P(this,A).values())R.destroy();P(this,A).clear(),P(this,x).clear(),mt(this,d,null),P(this,G).clear(),P(this,u).destroy(),P(this,w).destroy()}onPageChanging({pageNumber:R}){mt(this,J,R-1)}focusMainContainer(){P(this,c).focus()}keydown(R){var ut;(ut=this.getActive())!=null&&ut.shouldGetKeyboardEvents()||lt._keyboardManager.exec(this,R)}onEditingAction(R){["undo","redo","cut","copy","paste","delete","selectAll"].includes(R.name)&&this[R.name]()}setEditingState(R){R?(ht(this,l,Fe).call(this),ht(this,I,Bt).call(this,{isEditing:P(this,q)!==S.AnnotationEditorType.NONE,isEmpty:ht(this,dt,Qt).call(this),hasSomethingToUndo:P(this,w).hasSomethingToUndo(),hasSomethingToRedo:P(this,w).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:P(this,u).isEmpty()})):(ht(this,M,de).call(this),ht(this,I,Bt).call(this,{isEditing:!1}))}registerEditorTypes(R){mt(this,st,R);for(const ut of P(this,st))ht(this,H,Jt).call(this,ut.defaultPropertiesToUpdate)}getId(){return P(this,z).getId()}addLayer(R){P(this,A).set(R.pageIndex,R),P(this,j)?R.enable():R.disable()}removeLayer(R){P(this,A).delete(R.pageIndex)}updateMode(R){if(mt(this,q,R),R===S.AnnotationEditorType.NONE)this.setEditingState(!1),ht(this,v,Me).call(this);else{this.setEditingState(!0),ht(this,h,Re).call(this);for(const ut of P(this,A).values())ut.updateMode(R)}}updateToolbar(R){R!==P(this,q)&&P(this,Y).dispatch("switchannotationeditormode",{source:this,mode:R})}updateParams(R,ut){for(const At of P(this,G))At.updateParams(R,ut);for(const At of P(this,st))At.updateDefaultParams(R,ut)}getEditors(R){const ut=[];for(const At of P(this,x).values())At.pageIndex===R&&ut.push(At);return ut}getEditor(R){return P(this,x).get(R)}addEditor(R){P(this,x).set(R.id,R)}removeEditor(R){P(this,x).delete(R.id),this.unselect(R)}setActiveEditor(R){P(this,d)!==R&&(mt(this,d,R),R&&ht(this,H,Jt).call(this,R.propertiesToUpdate))}toggleSelected(R){if(P(this,G).has(R)){P(this,G).delete(R),R.unselect(),ht(this,I,Bt).call(this,{hasSelectedEditor:this.hasSelection});return}P(this,G).add(R),R.select(),ht(this,H,Jt).call(this,R.propertiesToUpdate),ht(this,I,Bt).call(this,{hasSelectedEditor:!0})}setSelected(R){for(const ut of P(this,G))ut!==R&&ut.unselect();P(this,G).clear(),P(this,G).add(R),R.select(),ht(this,H,Jt).call(this,R.propertiesToUpdate),ht(this,I,Bt).call(this,{hasSelectedEditor:!0})}isSelected(R){return P(this,G).has(R)}unselect(R){R.unselect(),P(this,G).delete(R),ht(this,I,Bt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return P(this,G).size!==0}undo(){P(this,w).undo(),ht(this,I,Bt).call(this,{hasSomethingToUndo:P(this,w).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ht(this,dt,Qt).call(this)})}redo(){P(this,w).redo(),ht(this,I,Bt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:P(this,w).hasSomethingToRedo(),isEmpty:ht(this,dt,Qt).call(this)})}addCommands(R){P(this,w).add(R),ht(this,I,Bt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ht(this,dt,Qt).call(this)})}delete(){if(P(this,d)&&P(this,d).commitOrRemove(),!this.hasSelection)return;const R=[...P(this,G)],ut=()=>{for(const vt of R)vt.remove()},At=()=>{for(const vt of R)ht(this,L,ue).call(this,vt)};this.addCommands({cmd:ut,undo:At,mustExec:!0})}copy(){if(P(this,d)&&P(this,d).commitOrRemove(),this.hasSelection){const R=[];for(const ut of P(this,G))ut.isEmpty()||R.push(ut);if(R.length===0)return;P(this,u).copy(R),ht(this,I,Bt).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(P(this,u).isEmpty())return;this.unselectAll();const R=P(this,A).get(P(this,J)),ut=P(this,u).paste().map(Et=>R.deserialize(Et)),At=()=>{for(const Et of ut)ht(this,L,ue).call(this,Et);ht(this,ot,te).call(this,ut)},vt=()=>{for(const Et of ut)Et.remove()};this.addCommands({cmd:At,undo:vt,mustExec:!0})}selectAll(){for(const R of P(this,G))R.commit();ht(this,ot,te).call(this,P(this,x).values())}unselectAll(){if(P(this,d)){P(this,d).commitOrRemove();return}if(ht(this,ot,te).size!==0){for(const R of P(this,G))R.unselect();P(this,G).clear(),ht(this,I,Bt).call(this,{hasSelectedEditor:!1})}}isActive(R){return P(this,d)===R}getActive(){return P(this,d)}getMode(){return P(this,q)}};let b=lt;d=new WeakMap,x=new WeakMap,A=new WeakMap,u=new WeakMap,w=new WeakMap,J=new WeakMap,st=new WeakMap,Y=new WeakMap,z=new WeakMap,j=new WeakMap,q=new WeakMap,G=new WeakMap,et=new WeakMap,ct=new WeakMap,bt=new WeakMap,D=new WeakMap,c=new WeakMap,l=new WeakSet,Fe=function(){P(this,c).addEventListener("keydown",P(this,et))},M=new WeakSet,de=function(){P(this,c).removeEventListener("keydown",P(this,et))},I=new WeakSet,Bt=function(R){Object.entries(R).some(([At,vt])=>P(this,D)[At]!==vt)&&P(this,Y).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(P(this,D),R)})},H=new WeakSet,Jt=function(R){P(this,Y).dispatch("annotationeditorparamschanged",{source:this,details:R})},h=new WeakSet,Re=function(){if(!P(this,j)){mt(this,j,!0);for(const R of P(this,A).values())R.enable()}},v=new WeakSet,Me=function(){if(this.unselectAll(),P(this,j)){mt(this,j,!1);for(const R of P(this,A).values())R.disable()}},L=new WeakSet,ue=function(R){const ut=P(this,A).get(R.pageIndex);ut?ut.addOrRebuild(R):this.addEditor(R)},dt=new WeakSet,Qt=function(){if(P(this,x).size===0)return!0;if(P(this,x).size===1)for(const R of P(this,x).values())return R.isEmpty();return!1},ot=new WeakSet,te=function(R){P(this,G).clear();for(const ut of R)ut.isEmpty()||(P(this,G).add(ut),ut.select());ht(this,I,Bt).call(this,{hasSelectedEditor:!0})},Mt(b,"_keyboardManager",new f([[["ctrl+a","mac+meta+a"],lt.prototype.selectAll],[["ctrl+c","mac+meta+c"],lt.prototype.copy],[["ctrl+v","mac+meta+v"],lt.prototype.paste],[["ctrl+x","mac+meta+x"],lt.prototype.cut],[["ctrl+z","mac+meta+z"],lt.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],lt.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],lt.prototype.delete],[["Escape","mac+Escape"],lt.prototype.unselectAll]])),p.AnnotationEditorUIManager=b},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.StatTimer=p.RenderingCancelledException=p.PixelsPerInch=p.PageViewport=p.PDFDateString=p.DOMStandardFontDataFactory=p.DOMSVGFactory=p.DOMCanvasFactory=p.DOMCMapReaderFactory=p.AnnotationPrefix=void 0,p.deprecated=s,p.getColorValues=w,p.getCurrentTransform=J,p.getCurrentTransformInverse=st,p.getFilenameFromUrl=r,p.getPdfFilenameFromUrl=g,p.getRGB=u,p.getXfaPageViewport=A,p.isDataScheme=t,p.isPdfFile=n,p.isValidFetchUrl=a,p.loadScript=e;var S=$(9),C=$(1);const Q="http://www.w3.org/2000/svg",W="pdfjs_internal_id_";p.AnnotationPrefix=W;const Y=class{};let tt=Y;Mt(tt,"CSS",96),Mt(tt,"PDF",72),Mt(tt,"PDF_TO_CSS_UNITS",Y.CSS/Y.PDF),p.PixelsPerInch=tt;class N extends S.BaseCanvasFactory{constructor({ownerDocument:j=globalThis.document}={}){super(),this._document=j}_createCanvas(j,q){const G=this._document.createElement("canvas");return G.width=j,G.height=q,G}}p.DOMCanvasFactory=N;async function f(z,j=!1){if(a(z,document.baseURI)){const q=await fetch(z);if(!q.ok)throw new Error(q.statusText);return j?new Uint8Array(await q.arrayBuffer()):(0,C.stringToBytes)(await q.text())}return new Promise((q,G)=>{const et=new XMLHttpRequest;et.open("GET",z,!0),j&&(et.responseType="arraybuffer"),et.onreadystatechange=()=>{if(et.readyState===XMLHttpRequest.DONE){if(et.status===200||et.status===0){let ct;if(j&&et.response?ct=new Uint8Array(et.response):!j&&et.responseText&&(ct=(0,C.stringToBytes)(et.responseText)),ct){q(ct);return}}G(new Error(et.statusText))}},et.send(null)})}class E extends S.BaseCMapReaderFactory{_fetchData(j,q){return f(j,this.isCompressed).then(G=>({cMapData:G,compressionType:q}))}}p.DOMCMapReaderFactory=E;class F extends S.BaseStandardFontDataFactory{_fetchData(j){return f(j,!0)}}p.DOMStandardFontDataFactory=F;class b extends S.BaseSVGFactory{_createSVG(j){return document.createElementNS(Q,j)}}p.DOMSVGFactory=b;class y{constructor({viewBox:j,scale:q,rotation:G,offsetX:et=0,offsetY:ct=0,dontFlip:bt=!1}){this.viewBox=j,this.scale=q,this.rotation=G,this.offsetX=et,this.offsetY=ct;const D=(j[2]+j[0])/2,c=(j[3]+j[1])/2;let l,T,M,O;switch(G%=360,G<0&&(G+=360),G){case 180:l=-1,T=0,M=0,O=1;break;case 90:l=0,T=1,M=1,O=0;break;case 270:l=0,T=-1,M=-1,O=0;break;case 0:l=1,T=0,M=0,O=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}bt&&(M=-M,O=-O);let I,X,H,i;l===0?(I=Math.abs(c-j[1])*q+et,X=Math.abs(D-j[0])*q+ct,H=Math.abs(j[3]-j[1])*q,i=Math.abs(j[2]-j[0])*q):(I=Math.abs(D-j[0])*q+et,X=Math.abs(c-j[1])*q+ct,H=Math.abs(j[2]-j[0])*q,i=Math.abs(j[3]-j[1])*q),this.transform=[l*q,T*q,M*q,O*q,I-l*q*D-M*q*c,X-T*q*D-O*q*c],this.width=H,this.height=i}clone({scale:j=this.scale,rotation:q=this.rotation,offsetX:G=this.offsetX,offsetY:et=this.offsetY,dontFlip:ct=!1}={}){return new y({viewBox:this.viewBox.slice(),scale:j,rotation:q,offsetX:G,offsetY:et,dontFlip:ct})}convertToViewportPoint(j,q){return C.Util.applyTransform([j,q],this.transform)}convertToViewportRectangle(j){const q=C.Util.applyTransform([j[0],j[1]],this.transform),G=C.Util.applyTransform([j[2],j[3]],this.transform);return[q[0],q[1],G[0],G[1]]}convertToPdfPoint(j,q){return C.Util.applyInverseTransform([j,q],this.transform)}}p.PageViewport=y;class o extends C.BaseException{constructor(j,q){super(j,"RenderingCancelledException"),this.type=q}}p.RenderingCancelledException=o;function t(z){const j=z.length;let q=0;for(;q<j&&z[q].trim()==="";)q++;return z.substring(q,q+5).toLowerCase()==="data:"}function n(z){return typeof z=="string"&&/\.pdf$/i.test(z)}function r(z){const j=z.indexOf("#"),q=z.indexOf("?"),G=Math.min(j>0?j:z.length,q>0?q:z.length);return z.substring(z.lastIndexOf("/",G)+1,G)}function g(z,j="document.pdf"){if(typeof z!="string")return j;if(t(z))return(0,C.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),j;const q=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,G=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,et=q.exec(z);let ct=G.exec(et[1])||G.exec(et[2])||G.exec(et[3]);if(ct&&(ct=ct[0],ct.includes("%")))try{ct=G.exec(decodeURIComponent(ct))[0]}catch{}return ct||j}class m{constructor(){this.started=Object.create(null),this.times=[]}time(j){j in this.started&&(0,C.warn)(`Timer is already running for ${j}`),this.started[j]=Date.now()}timeEnd(j){j in this.started||(0,C.warn)(`Timer has not been started for ${j}`),this.times.push({name:j,start:this.started[j],end:Date.now()}),delete this.started[j]}toString(){const j=[];let q=0;for(const G of this.times){const et=G.name;et.length>q&&(q=et.length)}for(const G of this.times){const et=G.end-G.start;j.push(`${G.name.padEnd(q)} ${et}ms
`)}return j.join("")}}p.StatTimer=m;function a(z,j){try{const{protocol:q}=j?new URL(z,j):new URL(z);return q==="http:"||q==="https:"}catch{return!1}}function e(z,j=!1){return new Promise((q,G)=>{const et=document.createElement("script");et.src=z,et.onload=function(ct){j&&et.remove(),q(ct)},et.onerror=function(){G(new Error(`Cannot load script at: ${et.src}`))},(document.head||document.documentElement).append(et)})}function s(z){console.log("Deprecated API usage: "+z)}let d;class x{static toDateObject(j){if(!j||typeof j!="string")return null;d||(d=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const q=d.exec(j);if(!q)return null;const G=parseInt(q[1],10);let et=parseInt(q[2],10);et=et>=1&&et<=12?et-1:0;let ct=parseInt(q[3],10);ct=ct>=1&&ct<=31?ct:1;let bt=parseInt(q[4],10);bt=bt>=0&&bt<=23?bt:0;let D=parseInt(q[5],10);D=D>=0&&D<=59?D:0;let c=parseInt(q[6],10);c=c>=0&&c<=59?c:0;const l=q[7]||"Z";let T=parseInt(q[8],10);T=T>=0&&T<=23?T:0;let M=parseInt(q[9],10)||0;return M=M>=0&&M<=59?M:0,l==="-"?(bt+=T,D+=M):l==="+"&&(bt-=T,D-=M),new Date(Date.UTC(G,et,ct,bt,D,c))}}p.PDFDateString=x;function A(z,{scale:j=1,rotation:q=0}){const{width:G,height:et}=z.attributes.style,ct=[0,0,parseInt(G),parseInt(et)];return new y({viewBox:ct,scale:j,rotation:q})}function u(z){if(z.startsWith("#")){const j=parseInt(z.slice(1),16);return[(j&16711680)>>16,(j&65280)>>8,j&255]}return z.startsWith("rgb(")?z.slice(4,-1).split(",").map(j=>parseInt(j)):z.startsWith("rgba(")?z.slice(5,-1).split(",").map(j=>parseInt(j)).slice(0,3):((0,C.warn)(`Not a valid color format: "${z}"`),[0,0,0])}function w(z){const j=document.createElement("span");j.style.visibility="hidden",document.body.append(j);for(const q of z.keys()){j.style.color=q;const G=window.getComputedStyle(j).color;z.set(q,u(G))}j.remove()}function J(z){const{a:j,b:q,c:G,d:et,e:ct,f:bt}=z.getTransform();return[j,q,G,et,ct,bt]}function st(z){const{a:j,b:q,c:G,d:et,e:ct,f:bt}=z.getTransform().invertSelf();return[j,q,G,et,ct,bt]}},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.BaseStandardFontDataFactory=p.BaseSVGFactory=p.BaseCanvasFactory=p.BaseCMapReaderFactory=void 0;var S=$(1);class C{constructor(){this.constructor===C&&(0,S.unreachable)("Cannot initialize BaseCanvasFactory.")}create(f,E){if(f<=0||E<=0)throw new Error("Invalid canvas size");const F=this._createCanvas(f,E);return{canvas:F,context:F.getContext("2d")}}reset(f,E,F){if(!f.canvas)throw new Error("Canvas is not specified");if(E<=0||F<=0)throw new Error("Invalid canvas size");f.canvas.width=E,f.canvas.height=F}destroy(f){if(!f.canvas)throw new Error("Canvas is not specified");f.canvas.width=0,f.canvas.height=0,f.canvas=null,f.context=null}_createCanvas(f,E){(0,S.unreachable)("Abstract method `_createCanvas` called.")}}p.BaseCanvasFactory=C;class Q{constructor({baseUrl:f=null,isCompressed:E=!1}){this.constructor===Q&&(0,S.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=E}async fetch({name:f}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const E=this.baseUrl+f+(this.isCompressed?".bcmap":""),F=this.isCompressed?S.CMapCompressionType.BINARY:S.CMapCompressionType.NONE;return this._fetchData(E,F).catch(b=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${E}`)})}_fetchData(f,E){(0,S.unreachable)("Abstract method `_fetchData` called.")}}p.BaseCMapReaderFactory=Q;class W{constructor({baseUrl:f=null}){this.constructor===W&&(0,S.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}async fetch({filename:f}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const E=`${this.baseUrl}${f}`;return this._fetchData(E).catch(F=>{throw new Error(`Unable to load font data at: ${E}`)})}_fetchData(f){(0,S.unreachable)("Abstract method `_fetchData` called.")}}p.BaseStandardFontDataFactory=W;class tt{constructor(){this.constructor===tt&&(0,S.unreachable)("Cannot initialize BaseSVGFactory.")}create(f,E,F=!1){if(f<=0||E<=0)throw new Error("Invalid SVG dimensions");const b=this._createSVG("svg:svg");return b.setAttribute("version","1.1"),F||(b.setAttribute("width",`${f}px`),b.setAttribute("height",`${E}px`)),b.setAttribute("preserveAspectRatio","none"),b.setAttribute("viewBox",`0 0 ${f} ${E}`),b}createElement(f){if(typeof f!="string")throw new Error("Invalid SVG element type");return this._createSVG(f)}_createSVG(f){(0,S.unreachable)("Abstract method `_createSVG` called.")}}p.BaseSVGFactory=tt},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.MurmurHash3_64=void 0;var S=$(1);const C=3285377520,Q=4294901760,W=65535;class tt{constructor(f){this.h1=f?f&4294967295:C,this.h2=f?f&4294967295:C}update(f){let E,F;if(typeof f=="string"){E=new Uint8Array(f.length*2),F=0;for(let d=0,x=f.length;d<x;d++){const A=f.charCodeAt(d);A<=255?E[F++]=A:(E[F++]=A>>>8,E[F++]=A&255)}}else if((0,S.isArrayBuffer)(f))E=f.slice(),F=E.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const b=F>>2,y=F-b*4,o=new Uint32Array(E.buffer,0,b);let t=0,n=0,r=this.h1,g=this.h2;const m=3432918353,a=461845907,e=m&W,s=a&W;for(let d=0;d<b;d++)d&1?(t=o[d],t=t*m&Q|t*e&W,t=t<<15|t>>>17,t=t*a&Q|t*s&W,r^=t,r=r<<13|r>>>19,r=r*5+3864292196):(n=o[d],n=n*m&Q|n*e&W,n=n<<15|n>>>17,n=n*a&Q|n*s&W,g^=n,g=g<<13|g>>>19,g=g*5+3864292196);switch(t=0,y){case 3:t^=E[b*4+2]<<16;case 2:t^=E[b*4+1]<<8;case 1:t^=E[b*4],t=t*m&Q|t*e&W,t=t<<15|t>>>17,t=t*a&Q|t*s&W,b&1?r^=t:g^=t}this.h1=r,this.h2=g}hexdigest(){let f=this.h1,E=this.h2;f^=E>>>1,f=f*3981806797&Q|f*36045&W,E=E*4283543511&Q|((E<<16|f>>>16)*2950163797&Q)>>>16,f^=E>>>1,f=f*444984403&Q|f*60499&W,E=E*3301882366&Q|((E<<16|f>>>16)*3120437893&Q)>>>16,f^=E>>>1;const F=(f>>>0).toString(16),b=(E>>>0).toString(16);return F.padStart(8,"0")+b.padStart(8,"0")}}p.MurmurHash3_64=tt},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.FontLoader=p.FontFaceObject=void 0;var S=$(1);class C{constructor({docId:N,onUnsupportedFeature:f,ownerDocument:E=globalThis.document,styleElement:F=null}){this.constructor===C&&(0,S.unreachable)("Cannot initialize BaseFontLoader."),this.docId=N,this._onUnsupportedFeature=f,this._document=E,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(N){this.nativeFontFaces.push(N),this._document.fonts.add(N)}insertRule(N){let f=this.styleElement;f||(f=this.styleElement=this._document.createElement("style"),f.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(f));const E=f.sheet;E.insertRule(N,E.cssRules.length)}clear(){for(const N of this.nativeFontFaces)this._document.fonts.delete(N);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(N){if(N.attached||N.missingFile)return;if(N.attached=!0,this.isFontLoadingAPISupported){const E=N.createNativeFontFace();if(E){this.addNativeFontFace(E);try{await E.loaded}catch(F){throw this._onUnsupportedFeature({featureId:S.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,S.warn)(`Failed to load font '${E.family}': '${F}'.`),N.disableFontFace=!0,F}}return}const f=N.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(E=>{const F=this._queueLoadingCallback(E);this._prepareFontLoadEvent([f],[N],F)})}}_queueLoadingCallback(N){(0,S.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var f;const N=!!((f=this._document)!=null&&f.fonts);return(0,S.shadow)(this,"isFontLoadingAPISupported",N)}get isSyncFontLoadingSupported(){(0,S.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,S.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(N,f,E){(0,S.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let Q;p.FontLoader=Q,p.FontLoader=Q=class extends C{constructor(N){super(N),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let N=!1;if(typeof navigator=="undefined")N=!0;else{const f=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(f==null?void 0:f[1])>=14&&(N=!0)}return(0,S.shadow)(this,"isSyncFontLoadingSupported",N)}_queueLoadingCallback(N){function f(){for((0,S.assert)(!F.done,"completeRequest() cannot be called twice."),F.done=!0;E.requests.length>0&&E.requests[0].done;){const b=E.requests.shift();setTimeout(b.callback,0)}}const E=this.loadingContext,F={id:`pdfjs-font-loading-${E.nextRequestId++}`,done:!1,complete:f,callback:N};return E.requests.push(F),F}get _loadTestFont(){const N=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,S.shadow)(this,"_loadTestFont",N())}_prepareFontLoadEvent(N,f,E){function F(st,Y){return st.charCodeAt(Y)<<24|st.charCodeAt(Y+1)<<16|st.charCodeAt(Y+2)<<8|st.charCodeAt(Y+3)&255}function b(st,Y,z,j){const q=st.substring(0,Y),G=st.substring(Y+z);return q+j+G}let y,o;const t=this._document.createElement("canvas");t.width=1,t.height=1;const n=t.getContext("2d");let r=0;function g(st,Y){if(r++,r>30){(0,S.warn)("Load test font never loaded."),Y();return}if(n.font="30px "+st,n.fillText(".",0,20),n.getImageData(0,0,1,1).data[3]>0){Y();return}setTimeout(g.bind(null,st,Y))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let a=this._loadTestFont;a=b(a,976,m.length,m);const s=16,d=1482184792;let x=F(a,s);for(y=0,o=m.length-3;y<o;y+=4)x=x-d+F(m,y)|0;y<m.length&&(x=x-d+F(m+"XXX",y)|0),a=b(a,s,4,(0,S.string32)(x));const A=`url(data:font/opentype;base64,${btoa(a)});`,u=`@font-face {font-family:"${m}";src:${A}}`;this.insertRule(u);const w=[];for(const st of f)w.push(st.loadedName);w.push(m);const J=this._document.createElement("div");J.style.visibility="hidden",J.style.width=J.style.height="10px",J.style.position="absolute",J.style.top=J.style.left="0px";for(const st of w){const Y=this._document.createElement("span");Y.textContent="Hi",Y.style.fontFamily=st,J.append(Y)}this._document.body.append(J),g(m,()=>{J.remove(),E.complete()})}};class W{constructor(N,{isEvalSupported:f=!0,disableFontFace:E=!1,ignoreErrors:F=!1,onUnsupportedFeature:b,fontRegistry:y=null}){this.compiledGlyphs=Object.create(null);for(const o in N)this[o]=N[o];this.isEvalSupported=f!==!1,this.disableFontFace=E===!0,this.ignoreErrors=F===!0,this._onUnsupportedFeature=b,this.fontRegistry=y}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let N;if(!this.cssFontInfo)N=new FontFace(this.loadedName,this.data,{});else{const f={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(f.style=`oblique ${this.cssFontInfo.italicAngle}deg`),N=new FontFace(this.cssFontInfo.fontFamily,this.data,f)}return this.fontRegistry&&this.fontRegistry.registerFont(this),N}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const N=(0,S.bytesToString)(this.data),f=`url(data:${this.mimetype};base64,${btoa(N)});`;let E;if(!this.cssFontInfo)E=`@font-face {font-family:"${this.loadedName}";src:${f}}`;else{let F=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(F+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),E=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${F}src:${f}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,f),E}getPathGenerator(N,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let E;try{E=N.get(this.loadedName+"_path_"+f)}catch(F){if(!this.ignoreErrors)throw F;return this._onUnsupportedFeature({featureId:S.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,S.warn)(`getPathGenerator - ignoring character: "${F}".`),this.compiledGlyphs[f]=function(b,y){}}if(this.isEvalSupported&&S.FeatureTest.isEvalSupported){const F=[];for(const b of E){const y=b.args!==void 0?b.args.join(","):"";F.push("c.",b.cmd,"(",y,`);
`)}return this.compiledGlyphs[f]=new Function("c","size",F.join(""))}return this.compiledGlyphs[f]=function(F,b){for(const y of E)y.cmd==="scale"&&(y.args=[b,-b]),F[y.cmd].apply(F,y.args)}}}p.FontFaceObject=W},(it,p,$)=>{var et,fe;Object.defineProperty(p,"__esModule",{value:!0}),p.CanvasGraphics=void 0;var S=$(8),C=$(1),Q=$(13),W=$(14),tt=$(3);const N=16,f=100,E=4096,F=15,b=10,y=tt.isNodeJS&&typeof Path2D=="undefined"?-1:1e3,o=16;function t(D,c){if(D._removeMirroring)throw new Error("Context is already forwarding operations.");D.__originalSave=D.save,D.__originalRestore=D.restore,D.__originalRotate=D.rotate,D.__originalScale=D.scale,D.__originalTranslate=D.translate,D.__originalTransform=D.transform,D.__originalSetTransform=D.setTransform,D.__originalResetTransform=D.resetTransform,D.__originalClip=D.clip,D.__originalMoveTo=D.moveTo,D.__originalLineTo=D.lineTo,D.__originalBezierCurveTo=D.bezierCurveTo,D.__originalRect=D.rect,D.__originalClosePath=D.closePath,D.__originalBeginPath=D.beginPath,D._removeMirroring=()=>{D.save=D.__originalSave,D.restore=D.__originalRestore,D.rotate=D.__originalRotate,D.scale=D.__originalScale,D.translate=D.__originalTranslate,D.transform=D.__originalTransform,D.setTransform=D.__originalSetTransform,D.resetTransform=D.__originalResetTransform,D.clip=D.__originalClip,D.moveTo=D.__originalMoveTo,D.lineTo=D.__originalLineTo,D.bezierCurveTo=D.__originalBezierCurveTo,D.rect=D.__originalRect,D.closePath=D.__originalClosePath,D.beginPath=D.__originalBeginPath,delete D._removeMirroring},D.save=function(){c.save(),this.__originalSave()},D.restore=function(){c.restore(),this.__originalRestore()},D.translate=function(T,M){c.translate(T,M),this.__originalTranslate(T,M)},D.scale=function(T,M){c.scale(T,M),this.__originalScale(T,M)},D.transform=function(T,M,O,I,X,H){c.transform(T,M,O,I,X,H),this.__originalTransform(T,M,O,I,X,H)},D.setTransform=function(T,M,O,I,X,H){c.setTransform(T,M,O,I,X,H),this.__originalSetTransform(T,M,O,I,X,H)},D.resetTransform=function(){c.resetTransform(),this.__originalResetTransform()},D.rotate=function(T){c.rotate(T),this.__originalRotate(T)},D.clip=function(T){c.clip(T),this.__originalClip(T)},D.moveTo=function(l,T){c.moveTo(l,T),this.__originalMoveTo(l,T)},D.lineTo=function(l,T){c.lineTo(l,T),this.__originalLineTo(l,T)},D.bezierCurveTo=function(l,T,M,O,I,X){c.bezierCurveTo(l,T,M,O,I,X),this.__originalBezierCurveTo(l,T,M,O,I,X)},D.rect=function(l,T,M,O){c.rect(l,T,M,O),this.__originalRect(l,T,M,O)},D.closePath=function(){c.closePath(),this.__originalClosePath()},D.beginPath=function(){c.beginPath(),this.__originalBeginPath()}}class n{constructor(c){this.canvasFactory=c,this.cache=Object.create(null)}getCanvas(c,l,T){let M;return this.cache[c]!==void 0?(M=this.cache[c],this.canvasFactory.reset(M,l,T)):(M=this.canvasFactory.create(l,T),this.cache[c]=M),M}delete(c){delete this.cache[c]}clear(){for(const c in this.cache){const l=this.cache[c];this.canvasFactory.destroy(l),delete this.cache[c]}}}function r(D,c,l,T,M,O,I,X,H,i){const[h,_,v,k,L,nt]=(0,S.getCurrentTransform)(D);if(_===0&&v===0){const ot=I*h+L,Z=Math.round(ot),lt=X*k+nt,ft=Math.round(lt),R=(I+H)*h+L,ut=Math.abs(Math.round(R)-Z)||1,At=(X+i)*k+nt,vt=Math.abs(Math.round(At)-ft)||1;return D.setTransform(Math.sign(h),0,0,Math.sign(k),Z,ft),D.drawImage(c,l,T,M,O,0,0,ut,vt),D.setTransform(h,_,v,k,L,nt),[ut,vt]}if(h===0&&k===0){const ot=X*v+L,Z=Math.round(ot),lt=I*_+nt,ft=Math.round(lt),R=(X+i)*v+L,ut=Math.abs(Math.round(R)-Z)||1,At=(I+H)*_+nt,vt=Math.abs(Math.round(At)-ft)||1;return D.setTransform(0,Math.sign(_),Math.sign(v),0,Z,ft),D.drawImage(c,l,T,M,O,0,0,vt,ut),D.setTransform(h,_,v,k,L,nt),[vt,ut]}D.drawImage(c,l,T,M,O,I,X,H,i);const dt=Math.hypot(h,_),K=Math.hypot(v,k);return[dt*H,K*i]}function g(D){const{width:c,height:l}=D;if(c>y||l>y)return null;const T=1e3,M=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),O=c+1;let I=new Uint8Array(O*(l+1)),X,H,i;const h=c+7&-8;let _=new Uint8Array(h*l),v=0;for(const K of D.data){let ot=128;for(;ot>0;)_[v++]=K&ot?0:255,ot>>=1}let k=0;for(v=0,_[v]!==0&&(I[0]=1,++k),H=1;H<c;H++)_[v]!==_[v+1]&&(I[H]=_[v]?2:1,++k),v++;for(_[v]!==0&&(I[H]=2,++k),X=1;X<l;X++){v=X*h,i=X*O,_[v-h]!==_[v]&&(I[i]=_[v]?1:8,++k);let K=(_[v]?4:0)+(_[v-h]?8:0);for(H=1;H<c;H++)K=(K>>2)+(_[v+1]?4:0)+(_[v-h+1]?8:0),M[K]&&(I[i+H]=M[K],++k),v++;if(_[v-h]!==_[v]&&(I[i+H]=_[v]?2:4,++k),k>T)return null}for(v=h*(l-1),i=X*O,_[v]!==0&&(I[i]=8,++k),H=1;H<c;H++)_[v]!==_[v+1]&&(I[i+H]=_[v]?4:8,++k),v++;if(_[v]!==0&&(I[i+H]=4,++k),k>T)return null;const L=new Int32Array([0,O,-1,0,-O,0,0,0,1]),nt=new Path2D;for(X=0;k&&X<=l;X++){let K=X*O;const ot=K+c;for(;K<ot&&!I[K];)K++;if(K===ot)continue;nt.moveTo(K%O,X);const Z=K;let lt=I[K];do{const ft=L[lt];do K+=ft;while(!I[K]);const R=I[K];R!==5&&R!==10?(lt=R,I[K]=0):(lt=R&51*lt>>4,I[K]&=lt>>2|lt<<2),nt.lineTo(K%O,K/O|0),I[K]||--k}while(Z!==K);--X}return _=null,I=null,function(K){K.save(),K.scale(1/c,-1/l),K.translate(0,-l),K.fill(nt),K.beginPath(),K.restore()}}class m{constructor(c,l){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=C.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=C.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=C.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,c,l])}clone(){const c=Object.create(this);return c.clipBox=this.clipBox.slice(),c}setCurrentPoint(c,l){this.x=c,this.y=l}updatePathMinMax(c,l,T){[l,T]=C.Util.applyTransform([l,T],c),this.minX=Math.min(this.minX,l),this.minY=Math.min(this.minY,T),this.maxX=Math.max(this.maxX,l),this.maxY=Math.max(this.maxY,T)}updateRectMinMax(c,l){const T=C.Util.applyTransform(l,c),M=C.Util.applyTransform(l.slice(2),c);this.minX=Math.min(this.minX,T[0],M[0]),this.minY=Math.min(this.minY,T[1],M[1]),this.maxX=Math.max(this.maxX,T[0],M[0]),this.maxY=Math.max(this.maxY,T[1],M[1])}updateScalingPathMinMax(c,l){C.Util.scaleMinMax(c,l),this.minX=Math.min(this.minX,l[0]),this.maxX=Math.max(this.maxX,l[1]),this.minY=Math.min(this.minY,l[2]),this.maxY=Math.max(this.maxY,l[3])}updateCurvePathMinMax(c,l,T,M,O,I,X,H,i,h){const _=C.Util.bezierBoundingBox(l,T,M,O,I,X,H,i);if(h){h[0]=Math.min(h[0],_[0],_[2]),h[1]=Math.max(h[1],_[0],_[2]),h[2]=Math.min(h[2],_[1],_[3]),h[3]=Math.max(h[3],_[1],_[3]);return}this.updateRectMinMax(c,_)}getPathBoundingBox(c=Q.PathType.FILL,l=null){const T=[this.minX,this.minY,this.maxX,this.maxY];if(c===Q.PathType.STROKE){l||(0,C.unreachable)("Stroke bounding box must include transform.");const M=C.Util.singularValueDecompose2dScale(l),O=M[0]*this.lineWidth/2,I=M[1]*this.lineWidth/2;T[0]-=O,T[1]-=I,T[2]+=O,T[3]+=I}return T}updateClipFromPath(){const c=C.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(c||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(c){this.clipBox=c,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(c=Q.PathType.FILL,l=null){return C.Util.intersect(this.clipBox,this.getPathBoundingBox(c,l))}}function a(D,c,l=null){if(typeof ImageData!="undefined"&&c instanceof ImageData){D.putImageData(c,0,0);return}const T=c.height,M=c.width,O=T%o,I=(T-O)/o,X=O===0?I:I+1,H=D.createImageData(M,o);let i=0,h;const _=c.data,v=H.data;let k,L,nt,dt,K,ot,Z,lt;if(l)switch(l.length){case 1:K=l[0],ot=l[0],Z=l[0],lt=l[0];break;case 4:K=l[0],ot=l[1],Z=l[2],lt=l[3];break}if(c.kind===C.ImageKind.GRAYSCALE_1BPP){const ft=_.byteLength,R=new Uint32Array(v.buffer,0,v.byteLength>>2),ut=R.length,At=M+7>>3;let vt=4294967295,Et=C.FeatureTest.isLittleEndian?4278190080:255;for(lt&&lt[0]===255&&lt[255]===0&&([vt,Et]=[Et,vt]),k=0;k<X;k++){for(nt=k<I?o:O,h=0,L=0;L<nt;L++){const Tt=ft-i;let Rt=0;const Ft=Tt>At?M:Tt*8-7,Xt=Ft&-8;let xt=0,Ot=0;for(;Rt<Xt;Rt+=8)Ot=_[i++],R[h++]=Ot&128?vt:Et,R[h++]=Ot&64?vt:Et,R[h++]=Ot&32?vt:Et,R[h++]=Ot&16?vt:Et,R[h++]=Ot&8?vt:Et,R[h++]=Ot&4?vt:Et,R[h++]=Ot&2?vt:Et,R[h++]=Ot&1?vt:Et;for(;Rt<Ft;Rt++)xt===0&&(Ot=_[i++],xt=128),R[h++]=Ot&xt?vt:Et,xt>>=1}for(;h<ut;)R[h++]=0;D.putImageData(H,0,k*o)}}else if(c.kind===C.ImageKind.RGBA_32BPP){const ft=!!(K||ot||Z);for(L=0,dt=M*o*4,k=0;k<I;k++){if(v.set(_.subarray(i,i+dt)),i+=dt,ft)for(let R=0;R<dt;R+=4)K&&(v[R+0]=K[v[R+0]]),ot&&(v[R+1]=ot[v[R+1]]),Z&&(v[R+2]=Z[v[R+2]]);D.putImageData(H,0,L),L+=o}if(k<X){if(dt=M*O*4,v.set(_.subarray(i,i+dt)),ft)for(let R=0;R<dt;R+=4)K&&(v[R+0]=K[v[R+0]]),ot&&(v[R+1]=ot[v[R+1]]),Z&&(v[R+2]=Z[v[R+2]]);D.putImageData(H,0,L)}}else if(c.kind===C.ImageKind.RGB_24BPP){const ft=!!(K||ot||Z);for(nt=o,dt=M*nt,k=0;k<X;k++){for(k>=I&&(nt=O,dt=M*nt),h=0,L=dt;L--;)v[h++]=_[i++],v[h++]=_[i++],v[h++]=_[i++],v[h++]=255;if(ft)for(let R=0;R<h;R+=4)K&&(v[R+0]=K[v[R+0]]),ot&&(v[R+1]=ot[v[R+1]]),Z&&(v[R+2]=Z[v[R+2]]);D.putImageData(H,0,k*o)}}else throw new Error(`bad image kind: ${c.kind}`)}function e(D,c){if(c.bitmap){D.drawImage(c.bitmap,0,0);return}const l=c.height,T=c.width,M=l%o,O=(l-M)/o,I=M===0?O:O+1,X=D.createImageData(T,o);let H=0;const i=c.data,h=X.data;for(let _=0;_<I;_++){const v=_<O?o:M;({srcPos:H}=(0,W.applyMaskImageData)({src:i,srcPos:H,dest:h,width:T,height:v})),D.putImageData(X,0,_*o)}}function s(D,c){const l=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let T=0,M=l.length;T<M;T++){const O=l[T];D[O]!==void 0&&(c[O]=D[O])}D.setLineDash!==void 0&&(c.setLineDash(D.getLineDash()),c.lineDashOffset=D.lineDashOffset)}function d(D,c){D.strokeStyle=D.fillStyle=c||"#000000",D.fillRule="nonzero",D.globalAlpha=1,D.lineWidth=1,D.lineCap="butt",D.lineJoin="miter",D.miterLimit=10,D.globalCompositeOperation="source-over",D.font="10px sans-serif",D.setLineDash!==void 0&&(D.setLineDash([]),D.lineDashOffset=0)}function x(D,c,l,T){const M=D.length;for(let O=3;O<M;O+=4){const I=D[O];if(I===0)D[O-3]=c,D[O-2]=l,D[O-1]=T;else if(I<255){const X=255-I;D[O-3]=D[O-3]*I+c*X>>8,D[O-2]=D[O-2]*I+l*X>>8,D[O-1]=D[O-1]*I+T*X>>8}}}function A(D,c,l){const T=D.length,M=1/255;for(let O=3;O<T;O+=4){const I=l?l[D[O]]:D[O];c[O]=c[O]*I*M|0}}function u(D,c,l){const T=D.length;for(let M=3;M<T;M+=4){const O=D[M-3]*77+D[M-2]*152+D[M-1]*28;c[M]=l?c[M]*l[O>>8]>>8:c[M]*O>>16}}function w(D,c,l,T,M,O,I,X,H,i,h){const _=!!O,v=_?O[0]:0,k=_?O[1]:0,L=_?O[2]:0;let nt;M==="Luminosity"?nt=u:nt=A;const K=Math.min(T,Math.ceil(1048576/l));for(let ot=0;ot<T;ot+=K){const Z=Math.min(K,T-ot),lt=D.getImageData(X-i,ot+(H-h),l,Z),ft=c.getImageData(X,ot+H,l,Z);_&&x(lt.data,v,k,L),nt(lt.data,ft.data,I),c.putImageData(ft,X,ot+H)}}function J(D,c,l,T){const M=T[0],O=T[1],I=T[2]-M,X=T[3]-O;I===0||X===0||(w(c.context,l,I,X,c.subtype,c.backdrop,c.transferMap,M,O,c.offsetX,c.offsetY),D.save(),D.globalAlpha=1,D.globalCompositeOperation="source-over",D.setTransform(1,0,0,1,0,0),D.drawImage(l.canvas,0,0),D.restore())}function st(D,c){const l=C.Util.singularValueDecompose2dScale(D);l[0]=Math.fround(l[0]),l[1]=Math.fround(l[1]);const T=Math.fround((globalThis.devicePixelRatio||1)*S.PixelsPerInch.PDF_TO_CSS_UNITS);return c!==void 0?c:l[0]<=T||l[1]<=T}const Y=["butt","round","square"],z=["miter","round","bevel"],j={},q={},bt=class{constructor(c,l,T,M,O,I,X,H){at(this,et);this.ctx=c,this.current=new m(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=l,this.objs=T,this.canvasFactory=M,this.imageLayer=O,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=I,this.cachedCanvases=new n(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=X,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(H==null?void 0:H.background)||null,this.foregroundColor=(H==null?void 0:H.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(c,l=null){return typeof c=="string"?c.startsWith("g_")?this.commonObjs.get(c):this.objs.get(c):l}beginDrawing({transform:c,viewport:l,transparency:T=!1,background:M=null}){const O=this.ctx.canvas.width,I=this.ctx.canvas.height,X=M||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const H=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const i=this.backgroundColor=this.ctx.fillStyle;let h=!0,_=X;if(this.ctx.fillStyle=X,_=this.ctx.fillStyle,h=typeof _=="string"&&/^#[0-9A-Fa-f]{6}$/.test(_),H==="#000000"&&i==="#ffffff"||H===i||!h)this.foregroundColor=this.backgroundColor=null;else{const[v,k,L]=(0,S.getRGB)(_),nt=K=>(K/=255,K<=.03928?K/12.92:((K+.055)/1.055)**2.4),dt=Math.round(.2126*nt(v)+.7152*nt(k)+.0722*nt(L));this.selectColor=(K,ot,Z)=>{const lt=.2126*nt(K)+.7152*nt(ot)+.0722*nt(Z);return Math.round(lt)===dt?i:H}}}if(this.ctx.fillStyle=this.backgroundColor||X,this.ctx.fillRect(0,0,O,I),this.ctx.restore(),T){const H=this.cachedCanvases.getCanvas("transparent",O,I);this.compositeCtx=this.ctx,this.transparentCanvas=H.canvas,this.ctx=H.context,this.ctx.save(),this.ctx.transform(...(0,S.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),d(this.ctx,this.foregroundColor),c&&(this.ctx.transform(...c),this.outputScaleX=c[0],this.outputScaleY=c[0]),this.ctx.transform(...l.transform),this.viewportScale=l.scale,this.baseTransform=(0,S.getCurrentTransform)(this.ctx),this.imageLayer&&((0,S.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(c,l,T,M){const O=c.argsArray,I=c.fnArray;let X=l||0;const H=O.length;if(H===X)return X;const i=H-X>b&&typeof T=="function",h=i?Date.now()+F:0;let _=0;const v=this.commonObjs,k=this.objs;let L;for(;;){if(M!==void 0&&X===M.nextBreakPoint)return M.breakIt(X,T),X;if(L=I[X],L!==C.OPS.dependency)this[L].apply(this,O[X]);else for(const nt of O[X]){const dt=nt.startsWith("g_")?v:k;if(!dt.has(nt))return dt.get(nt,T),X}if(X++,X===H)return X;if(i&&++_>b){if(Date.now()>h)return T(),X;_=0}}}endDrawing(){ht(this,et,fe).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const c of this._cachedBitmapsMap.values()){for(const l of c.values())typeof HTMLCanvasElement!="undefined"&&l instanceof HTMLCanvasElement&&(l.width=l.height=0);c.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(c,l){const T=c.width,M=c.height;let O=Math.max(Math.hypot(l[0],l[1]),1),I=Math.max(Math.hypot(l[2],l[3]),1),X=T,H=M,i="prescale1",h,_;for(;O>2&&X>1||I>2&&H>1;){let v=X,k=H;O>2&&X>1&&(v=Math.ceil(X/2),O/=X/v),I>2&&H>1&&(k=Math.ceil(H/2),I/=H/k),h=this.cachedCanvases.getCanvas(i,v,k),_=h.context,_.clearRect(0,0,v,k),_.drawImage(c,0,0,X,H,0,0,v,k),c=h.canvas,X=v,H=k,i=i==="prescale1"?"prescale2":"prescale1"}return{img:c,paintWidth:X,paintHeight:H}}_createMaskCanvas(c){const l=this.ctx,{width:T,height:M}=c,O=this.current.fillColor,I=this.current.patternFill,X=(0,S.getCurrentTransform)(l);let H,i,h,_;if((c.bitmap||c.data)&&c.count>1){const ut=c.bitmap||c.data.buffer,At=X.slice(0,4);i=JSON.stringify(I?At:[At,O]),H=this._cachedBitmapsMap.get(ut),H||(H=new Map,this._cachedBitmapsMap.set(ut,H));const vt=H.get(i);if(vt&&!I){const Et=Math.round(Math.min(X[0],X[2])+X[4]),Tt=Math.round(Math.min(X[1],X[3])+X[5]);return{canvas:vt,offsetX:Et,offsetY:Tt}}h=vt}h||(_=this.cachedCanvases.getCanvas("maskCanvas",T,M),e(_.context,c));let v=C.Util.transform(X,[1/T,0,0,-1/M,0,0]);v=C.Util.transform(v,[1,0,0,1,0,-M]);const k=C.Util.applyTransform([0,0],v),L=C.Util.applyTransform([T,M],v),nt=C.Util.normalizeRect([k[0],k[1],L[0],L[1]]),dt=Math.round(nt[2]-nt[0])||1,K=Math.round(nt[3]-nt[1])||1,ot=this.cachedCanvases.getCanvas("fillCanvas",dt,K),Z=ot.context,lt=Math.min(k[0],L[0]),ft=Math.min(k[1],L[1]);Z.translate(-lt,-ft),Z.transform(...v),h||(h=this._scaleImage(_.canvas,(0,S.getCurrentTransformInverse)(Z)),h=h.img,H&&I&&H.set(i,h)),Z.imageSmoothingEnabled=st((0,S.getCurrentTransform)(Z),c.interpolate),r(Z,h,0,0,h.width,h.height,0,0,T,M),Z.globalCompositeOperation="source-in";const R=C.Util.transform((0,S.getCurrentTransformInverse)(Z),[1,0,0,1,-lt,-ft]);return Z.fillStyle=I?O.getPattern(l,this,R,Q.PathType.FILL):O,Z.fillRect(0,0,T,M),H&&!I&&(this.cachedCanvases.delete("fillCanvas"),H.set(i,ot.canvas)),{canvas:ot.canvas,offsetX:Math.round(lt),offsetY:Math.round(ft)}}setLineWidth(c){c!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=c,this.ctx.lineWidth=c}setLineCap(c){this.ctx.lineCap=Y[c]}setLineJoin(c){this.ctx.lineJoin=z[c]}setMiterLimit(c){this.ctx.miterLimit=c}setDash(c,l){const T=this.ctx;T.setLineDash!==void 0&&(T.setLineDash(c),T.lineDashOffset=l)}setRenderingIntent(c){}setFlatness(c){}setGState(c){for(let l=0,T=c.length;l<T;l++){const M=c[l],O=M[0],I=M[1];switch(O){case"LW":this.setLineWidth(I);break;case"LC":this.setLineCap(I);break;case"LJ":this.setLineJoin(I);break;case"ML":this.setMiterLimit(I);break;case"D":this.setDash(I[0],I[1]);break;case"RI":this.setRenderingIntent(I);break;case"FL":this.setFlatness(I);break;case"Font":this.setFont(I[0],I[1]);break;case"CA":this.current.strokeAlpha=M[1];break;case"ca":this.current.fillAlpha=M[1],this.ctx.globalAlpha=M[1];break;case"BM":this.ctx.globalCompositeOperation=I;break;case"SMask":this.current.activeSMask=I?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=I}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const c=this.inSMaskMode;this.current.activeSMask&&!c?this.beginSMaskMode():!this.current.activeSMask&&c&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const c=this.ctx.canvas.width,l=this.ctx.canvas.height,T="smaskGroupAt"+this.groupLevel,M=this.cachedCanvases.getCanvas(T,c,l);this.suspendedCtx=this.ctx,this.ctx=M.context;const O=this.ctx;O.setTransform(...(0,S.getCurrentTransform)(this.suspendedCtx)),s(this.suspendedCtx,O),t(O,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),s(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(c){if(!this.current.activeSMask)return;c?(c[0]=Math.floor(c[0]),c[1]=Math.floor(c[1]),c[2]=Math.ceil(c[2]),c[3]=Math.ceil(c[3])):c=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const l=this.current.activeSMask,T=this.suspendedCtx;J(T,l,this.ctx,c),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(s(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const c=this.current;this.stateStack.push(c),this.current=c.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),s(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(c,l,T,M,O,I){this.ctx.transform(c,l,T,M,O,I),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(c,l,T){const M=this.ctx,O=this.current;let I=O.x,X=O.y,H,i;const h=(0,S.getCurrentTransform)(M),_=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,v=_?T.slice(0):null;for(let k=0,L=0,nt=c.length;k<nt;k++)switch(c[k]|0){case C.OPS.rectangle:I=l[L++],X=l[L++];const dt=l[L++],K=l[L++],ot=I+dt,Z=X+K;M.moveTo(I,X),dt===0||K===0?M.lineTo(ot,Z):(M.lineTo(ot,X),M.lineTo(ot,Z),M.lineTo(I,Z)),_||O.updateRectMinMax(h,[I,X,ot,Z]),M.closePath();break;case C.OPS.moveTo:I=l[L++],X=l[L++],M.moveTo(I,X),_||O.updatePathMinMax(h,I,X);break;case C.OPS.lineTo:I=l[L++],X=l[L++],M.lineTo(I,X),_||O.updatePathMinMax(h,I,X);break;case C.OPS.curveTo:H=I,i=X,I=l[L+4],X=l[L+5],M.bezierCurveTo(l[L],l[L+1],l[L+2],l[L+3],I,X),O.updateCurvePathMinMax(h,H,i,l[L],l[L+1],l[L+2],l[L+3],I,X,v),L+=6;break;case C.OPS.curveTo2:H=I,i=X,M.bezierCurveTo(I,X,l[L],l[L+1],l[L+2],l[L+3]),O.updateCurvePathMinMax(h,H,i,I,X,l[L],l[L+1],l[L+2],l[L+3],v),I=l[L+2],X=l[L+3],L+=4;break;case C.OPS.curveTo3:H=I,i=X,I=l[L+2],X=l[L+3],M.bezierCurveTo(l[L],l[L+1],I,X,I,X),O.updateCurvePathMinMax(h,H,i,l[L],l[L+1],I,X,I,X,v),L+=4;break;case C.OPS.closePath:M.closePath();break}_&&O.updateScalingPathMinMax(h,v),O.setCurrentPoint(I,X)}closePath(){this.ctx.closePath()}stroke(c){c=typeof c!="undefined"?c:!0;const l=this.ctx,T=this.current.strokeColor;l.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof T=="object"&&(T==null?void 0:T.getPattern)?(l.save(),l.strokeStyle=T.getPattern(l,this,(0,S.getCurrentTransformInverse)(l),Q.PathType.STROKE),this.rescaleAndStroke(!1),l.restore()):this.rescaleAndStroke(!0)),c&&this.consumePath(this.current.getClippedPathBoundingBox()),l.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(c){c=typeof c!="undefined"?c:!0;const l=this.ctx,T=this.current.fillColor,M=this.current.patternFill;let O=!1;M&&(l.save(),l.fillStyle=T.getPattern(l,this,(0,S.getCurrentTransformInverse)(l),Q.PathType.FILL),O=!0);const I=this.current.getClippedPathBoundingBox();this.contentVisible&&I!==null&&(this.pendingEOFill?(l.fill("evenodd"),this.pendingEOFill=!1):l.fill()),O&&l.restore(),c&&this.consumePath(I)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=j}eoClip(){this.pendingClip=q}beginText(){this.current.textMatrix=C.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const c=this.pendingTextPaths,l=this.ctx;if(c===void 0){l.beginPath();return}l.save(),l.beginPath();for(const T of c)l.setTransform(...T.transform),l.translate(T.x,T.y),T.addToPath(l,T.fontSize);l.restore(),l.clip(),l.beginPath(),delete this.pendingTextPaths}setCharSpacing(c){this.current.charSpacing=c}setWordSpacing(c){this.current.wordSpacing=c}setHScale(c){this.current.textHScale=c/100}setLeading(c){this.current.leading=-c}setFont(c,l){const T=this.commonObjs.get(c),M=this.current;if(!T)throw new Error(`Can't find font for ${c}`);if(M.fontMatrix=T.fontMatrix||C.FONT_IDENTITY_MATRIX,(M.fontMatrix[0]===0||M.fontMatrix[3]===0)&&(0,C.warn)("Invalid font matrix for font "+c),l<0?(l=-l,M.fontDirection=-1):M.fontDirection=1,this.current.font=T,this.current.fontSize=l,T.isType3Font)return;const O=T.loadedName||"sans-serif";let I="normal";T.black?I="900":T.bold&&(I="bold");const X=T.italic?"italic":"normal",H=`"${O}", ${T.fallbackName}`;let i=l;l<N?i=N:l>f&&(i=f),this.current.fontSizeScale=l/i,this.ctx.font=`${X} ${I} ${i}px ${H}`}setTextRenderingMode(c){this.current.textRenderingMode=c}setTextRise(c){this.current.textRise=c}moveText(c,l){this.current.x=this.current.lineX+=c,this.current.y=this.current.lineY+=l}setLeadingMoveText(c,l){this.setLeading(-l),this.moveText(c,l)}setTextMatrix(c,l,T,M,O,I){this.current.textMatrix=[c,l,T,M,O,I],this.current.textMatrixScale=Math.hypot(c,l),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(c,l,T,M){const O=this.ctx,I=this.current,X=I.font,H=I.textRenderingMode,i=I.fontSize/I.fontSizeScale,h=H&C.TextRenderingMode.FILL_STROKE_MASK,_=!!(H&C.TextRenderingMode.ADD_TO_PATH_FLAG),v=I.patternFill&&!X.missingFile;let k;(X.disableFontFace||_||v)&&(k=X.getPathGenerator(this.commonObjs,c)),X.disableFontFace||v?(O.save(),O.translate(l,T),O.beginPath(),k(O,i),M&&O.setTransform(...M),(h===C.TextRenderingMode.FILL||h===C.TextRenderingMode.FILL_STROKE)&&O.fill(),(h===C.TextRenderingMode.STROKE||h===C.TextRenderingMode.FILL_STROKE)&&O.stroke(),O.restore()):((h===C.TextRenderingMode.FILL||h===C.TextRenderingMode.FILL_STROKE)&&O.fillText(c,l,T),(h===C.TextRenderingMode.STROKE||h===C.TextRenderingMode.FILL_STROKE)&&O.strokeText(c,l,T)),_&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,S.getCurrentTransform)(O),x:l,y:T,fontSize:i,addToPath:k})}get isFontSubpixelAAEnabled(){const{context:c}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);c.scale(1.5,1),c.fillText("I",0,10);const l=c.getImageData(0,0,10,10).data;let T=!1;for(let M=3;M<l.length;M+=4)if(l[M]>0&&l[M]<255){T=!0;break}return(0,C.shadow)(this,"isFontSubpixelAAEnabled",T)}showText(c){const l=this.current,T=l.font;if(T.isType3Font)return this.showType3Text(c);const M=l.fontSize;if(M===0)return;const O=this.ctx,I=l.fontSizeScale,X=l.charSpacing,H=l.wordSpacing,i=l.fontDirection,h=l.textHScale*i,_=c.length,v=T.vertical,k=v?1:-1,L=T.defaultVMetrics,nt=M*l.fontMatrix[0],dt=l.textRenderingMode===C.TextRenderingMode.FILL&&!T.disableFontFace&&!l.patternFill;O.save(),O.transform(...l.textMatrix),O.translate(l.x,l.y+l.textRise),i>0?O.scale(h,-1):O.scale(h,1);let K;if(l.patternFill){O.save();const R=l.fillColor.getPattern(O,this,(0,S.getCurrentTransformInverse)(O),Q.PathType.FILL);K=(0,S.getCurrentTransform)(O),O.restore(),O.fillStyle=R}let ot=l.lineWidth;const Z=l.textMatrixScale;if(Z===0||ot===0){const R=l.textRenderingMode&C.TextRenderingMode.FILL_STROKE_MASK;(R===C.TextRenderingMode.STROKE||R===C.TextRenderingMode.FILL_STROKE)&&(ot=this.getSinglePixelWidth())}else ot/=Z;I!==1&&(O.scale(I,I),ot/=I),O.lineWidth=ot;let lt=0,ft;for(ft=0;ft<_;++ft){const R=c[ft];if(typeof R=="number"){lt+=k*R*M/1e3;continue}let ut=!1;const At=(R.isSpace?H:0)+X,vt=R.fontChar,Et=R.accent;let Tt,Rt,Ft=R.width;if(v){const xt=R.vmetric||L,Ot=-(R.vmetric?xt[1]:Ft*.5)*nt,Zt=xt[2]*nt;Ft=xt?-xt[0]:Ft,Tt=Ot/I,Rt=(lt+Zt)/I}else Tt=lt/I,Rt=0;if(T.remeasure&&Ft>0){const xt=O.measureText(vt).width*1e3/M*I;if(Ft<xt&&this.isFontSubpixelAAEnabled){const Ot=Ft/xt;ut=!0,O.save(),O.scale(Ot,1),Tt/=Ot}else Ft!==xt&&(Tt+=(Ft-xt)/2e3*M/I)}if(this.contentVisible&&(R.isInFont||T.missingFile)){if(dt&&!Et)O.fillText(vt,Tt,Rt);else if(this.paintChar(vt,Tt,Rt,K),Et){const xt=Tt+M*Et.offset.x/I,Ot=Rt-M*Et.offset.y/I;this.paintChar(Et.fontChar,xt,Ot,K)}}let Xt;v?Xt=Ft*nt-At*i:Xt=Ft*nt+At*i,lt+=Xt,ut&&O.restore()}v?l.y-=lt:l.x+=lt*h,O.restore(),this.compose()}showType3Text(c){const l=this.ctx,T=this.current,M=T.font,O=T.fontSize,I=T.fontDirection,X=M.vertical?1:-1,H=T.charSpacing,i=T.wordSpacing,h=T.textHScale*I,_=T.fontMatrix||C.FONT_IDENTITY_MATRIX,v=c.length,k=T.textRenderingMode===C.TextRenderingMode.INVISIBLE;let L,nt,dt,K;if(!(k||O===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,l.save(),l.transform(...T.textMatrix),l.translate(T.x,T.y),l.scale(h,I),L=0;L<v;++L){if(nt=c[L],typeof nt=="number"){K=X*nt*O/1e3,this.ctx.translate(K,0),T.x+=K*h;continue}const ot=(nt.isSpace?i:0)+H,Z=M.charProcOperatorList[nt.operatorListId];if(!Z){(0,C.warn)(`Type3 character "${nt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=nt,this.save(),l.scale(O,O),l.transform(..._),this.executeOperatorList(Z),this.restore()),dt=C.Util.applyTransform([nt.width,0],_)[0]*O+ot,l.translate(dt,0),T.x+=dt*h}l.restore(),this.processingType3=null}}setCharWidth(c,l){}setCharWidthAndBounds(c,l,T,M,O,I){this.ctx.rect(T,M,O-T,I-M),this.ctx.clip(),this.endPath()}getColorN_Pattern(c){let l;if(c[0]==="TilingPattern"){const T=c[1],M=this.baseTransform||(0,S.getCurrentTransform)(this.ctx),O={createCanvasGraphics:I=>new bt(I,this.commonObjs,this.objs,this.canvasFactory)};l=new Q.TilingPattern(c,T,this.ctx,O,M)}else l=this._getPattern(c[1],c[2]);return l}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(c,l,T){var O;const M=((O=this.selectColor)==null?void 0:O.call(this,c,l,T))||C.Util.makeHexColor(c,l,T);this.ctx.strokeStyle=M,this.current.strokeColor=M}setFillRGBColor(c,l,T){var O;const M=((O=this.selectColor)==null?void 0:O.call(this,c,l,T))||C.Util.makeHexColor(c,l,T);this.ctx.fillStyle=M,this.current.fillColor=M,this.current.patternFill=!1}_getPattern(c,l=null){let T;return this.cachedPatterns.has(c)?T=this.cachedPatterns.get(c):(T=(0,Q.getShadingPattern)(this.objs.get(c)),this.cachedPatterns.set(c,T)),l&&(T.matrix=l),T}shadingFill(c){if(!this.contentVisible)return;const l=this.ctx;this.save();const T=this._getPattern(c);l.fillStyle=T.getPattern(l,this,(0,S.getCurrentTransformInverse)(l),Q.PathType.SHADING);const M=(0,S.getCurrentTransformInverse)(l);if(M){const O=l.canvas,I=O.width,X=O.height,H=C.Util.applyTransform([0,0],M),i=C.Util.applyTransform([0,X],M),h=C.Util.applyTransform([I,0],M),_=C.Util.applyTransform([I,X],M),v=Math.min(H[0],i[0],h[0],_[0]),k=Math.min(H[1],i[1],h[1],_[1]),L=Math.max(H[0],i[0],h[0],_[0]),nt=Math.max(H[1],i[1],h[1],_[1]);this.ctx.fillRect(v,k,L-v,nt-k)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,C.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,C.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(c,l){if(!!this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(c)&&c.length===6&&this.transform(...c),this.baseTransform=(0,S.getCurrentTransform)(this.ctx),l)){const T=l[2]-l[0],M=l[3]-l[1];this.ctx.rect(l[0],l[1],T,M),this.current.updateRectMinMax((0,S.getCurrentTransform)(this.ctx),l),this.clip(),this.endPath()}}paintFormXObjectEnd(){!this.contentVisible||(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(c){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const l=this.ctx;c.isolated||(0,C.info)("TODO: Support non-isolated groups."),c.knockout&&(0,C.warn)("Knockout groups not supported.");const T=(0,S.getCurrentTransform)(l);if(c.matrix&&l.transform(...c.matrix),!c.bbox)throw new Error("Bounding box is required.");let M=C.Util.getAxialAlignedBoundingBox(c.bbox,(0,S.getCurrentTransform)(l));const O=[0,0,l.canvas.width,l.canvas.height];M=C.Util.intersect(M,O)||[0,0,0,0];const I=Math.floor(M[0]),X=Math.floor(M[1]);let H=Math.max(Math.ceil(M[2])-I,1),i=Math.max(Math.ceil(M[3])-X,1),h=1,_=1;H>E&&(h=H/E,H=E),i>E&&(_=i/E,i=E),this.current.startNewPathAndClipBox([0,0,H,i]);let v="groupAt"+this.groupLevel;c.smask&&(v+="_smask_"+this.smaskCounter++%2);const k=this.cachedCanvases.getCanvas(v,H,i),L=k.context;L.scale(1/h,1/_),L.translate(-I,-X),L.transform(...T),c.smask?this.smaskStack.push({canvas:k.canvas,context:L,offsetX:I,offsetY:X,scaleX:h,scaleY:_,subtype:c.smask.subtype,backdrop:c.smask.backdrop,transferMap:c.smask.transferMap||null,startTransformInverse:null}):(l.setTransform(1,0,0,1,0,0),l.translate(I,X),l.scale(h,_),l.save()),s(l,L),this.ctx=L,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(l),this.groupLevel++}endGroup(c){if(!this.contentVisible)return;this.groupLevel--;const l=this.ctx,T=this.groupStack.pop();if(this.ctx=T,this.ctx.imageSmoothingEnabled=!1,c.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const M=(0,S.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...M);const O=C.Util.getAxialAlignedBoundingBox([0,0,l.canvas.width,l.canvas.height],M);this.ctx.drawImage(l.canvas,0,0),this.ctx.restore(),this.compose(O)}}beginAnnotation(c,l,T,M,O){if(ht(this,et,fe).call(this),d(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(l)&&l.length===4){const I=l[2]-l[0],X=l[3]-l[1];if(O&&this.annotationCanvasMap){T=T.slice(),T[4]-=l[0],T[5]-=l[1],l=l.slice(),l[0]=l[1]=0,l[2]=I,l[3]=X;const[H,i]=C.Util.singularValueDecompose2dScale((0,S.getCurrentTransform)(this.ctx)),{viewportScale:h}=this,_=Math.ceil(I*this.outputScaleX*h),v=Math.ceil(X*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(_,v);const{canvas:k,context:L}=this.annotationCanvas;this.annotationCanvasMap.set(c,k),this.annotationCanvas.savedCtx=this.ctx,this.ctx=L,this.ctx.setTransform(H,0,0,-i,0,X*i),d(this.ctx,this.foregroundColor)}else d(this.ctx,this.foregroundColor),this.ctx.rect(l[0],l[1],I,X),this.ctx.clip(),this.endPath()}this.current=new m(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...T),this.transform(...M)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(c){if(!this.contentVisible)return;const l=c.count;c=this.getObject(c.data,c),c.count=l;const T=this.ctx,M=this.processingType3;if(M&&(M.compiled===void 0&&(M.compiled=g(c)),M.compiled)){M.compiled(T);return}const O=this._createMaskCanvas(c),I=O.canvas;T.save(),T.setTransform(1,0,0,1,0,0),T.drawImage(I,O.offsetX,O.offsetY),T.restore(),this.compose()}paintImageMaskXObjectRepeat(c,l,T=0,M=0,O,I){if(!this.contentVisible)return;c=this.getObject(c.data,c);const X=this.ctx;X.save();const H=(0,S.getCurrentTransform)(X);X.transform(l,T,M,O,0,0);const i=this._createMaskCanvas(c);X.setTransform(1,0,0,1,0,0);for(let h=0,_=I.length;h<_;h+=2){const v=C.Util.transform(H,[l,T,M,O,I[h],I[h+1]]),[k,L]=C.Util.applyTransform([0,0],v);X.drawImage(i.canvas,k,L)}X.restore(),this.compose()}paintImageMaskXObjectGroup(c){if(!this.contentVisible)return;const l=this.ctx,T=this.current.fillColor,M=this.current.patternFill;for(const O of c){const{data:I,width:X,height:H,transform:i}=O,h=this.cachedCanvases.getCanvas("maskCanvas",X,H),_=h.context;_.save();const v=this.getObject(I,O);e(_,v),_.globalCompositeOperation="source-in",_.fillStyle=M?T.getPattern(_,this,(0,S.getCurrentTransformInverse)(l),Q.PathType.FILL):T,_.fillRect(0,0,X,H),_.restore(),l.save(),l.transform(...i),l.scale(1,-1),r(l,h.canvas,0,0,X,H,0,-1,1,1),l.restore()}this.compose()}paintImageXObject(c){if(!this.contentVisible)return;const l=this.getObject(c);if(!l){(0,C.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(l)}paintImageXObjectRepeat(c,l,T,M){if(!this.contentVisible)return;const O=this.getObject(c);if(!O){(0,C.warn)("Dependent image isn't ready yet");return}const I=O.width,X=O.height,H=[];for(let i=0,h=M.length;i<h;i+=2)H.push({transform:[l,0,0,T,M[i],M[i+1]],x:0,y:0,w:I,h:X});this.paintInlineImageXObjectGroup(O,H)}paintInlineImageXObject(c){if(!this.contentVisible)return;const l=c.width,T=c.height,M=this.ctx;this.save(),M.scale(1/l,-1/T);let O;if(typeof HTMLElement=="function"&&c instanceof HTMLElement||!c.data)O=c;else{const i=this.cachedCanvases.getCanvas("inlineImage",l,T),h=i.context;a(h,c,this.current.transferMaps),O=i.canvas}const I=this._scaleImage(O,(0,S.getCurrentTransformInverse)(M));M.imageSmoothingEnabled=st((0,S.getCurrentTransform)(M),c.interpolate);const[X,H]=r(M,I.img,0,0,I.paintWidth,I.paintHeight,0,-T,l,T);if(this.imageLayer){const[i,h]=C.Util.applyTransform([0,-T],(0,S.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:c,left:i,top:h,width:X,height:H})}this.compose(),this.restore()}paintInlineImageXObjectGroup(c,l){if(!this.contentVisible)return;const T=this.ctx,M=c.width,O=c.height,I=this.cachedCanvases.getCanvas("inlineImage",M,O),X=I.context;a(X,c,this.current.transferMaps);for(const H of l){if(T.save(),T.transform(...H.transform),T.scale(1,-1),r(T,I.canvas,H.x,H.y,H.w,H.h,0,-1,1,1),this.imageLayer){const[i,h]=C.Util.applyTransform([H.x,H.y],(0,S.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:c,left:i,top:h,width:M,height:O})}T.restore()}this.compose()}paintSolidColorImageMask(){!this.contentVisible||(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(c){}markPointProps(c,l){}beginMarkedContent(c){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(c,l){c==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(l)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(c){const l=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(c);const T=this.ctx;this.pendingClip&&(l||(this.pendingClip===q?T.clip("evenodd"):T.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),T.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const c=(0,S.getCurrentTransform)(this.ctx);if(c[1]===0&&c[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(c[0]),Math.abs(c[3]));else{const l=Math.abs(c[0]*c[3]-c[2]*c[1]),T=Math.hypot(c[0],c[2]),M=Math.hypot(c[1],c[3]);this._cachedGetSinglePixelWidth=Math.max(T,M)/l}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:c}=this.current,l=(0,S.getCurrentTransform)(this.ctx);let T,M;if(l[1]===0&&l[2]===0){const O=Math.abs(l[0]),I=Math.abs(l[3]);if(c===0)T=1/O,M=1/I;else{const X=O*c,H=I*c;T=X<1?1/X:1,M=H<1?1/H:1}}else{const O=Math.abs(l[0]*l[3]-l[2]*l[1]),I=Math.hypot(l[0],l[1]),X=Math.hypot(l[2],l[3]);if(c===0)T=X/O,M=I/O;else{const H=c*O;T=X>H?X/H:1,M=I>H?I/H:1}}this._cachedScaleForStroking=[T,M]}return this._cachedScaleForStroking}rescaleAndStroke(c){const{ctx:l}=this,{lineWidth:T}=this.current,[M,O]=this.getScaleForStroking();if(l.lineWidth=T||1,M===1&&O===1){l.stroke();return}let I,X,H;c&&(I=(0,S.getCurrentTransform)(l),X=l.getLineDash().slice(),H=l.lineDashOffset),l.scale(M,O);const i=Math.max(M,O);l.setLineDash(l.getLineDash().map(h=>h/i)),l.lineDashOffset/=i,l.stroke(),c&&(l.setTransform(...I),l.setLineDash(X),l.lineDashOffset=H)}isContentVisible(){for(let c=this.markedContentStack.length-1;c>=0;c--)if(!this.markedContentStack[c].visible)return!1;return!0}};let G=bt;et=new WeakSet,fe=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},p.CanvasGraphics=G;for(const D in C.OPS)G.prototype[D]!==void 0&&(G.prototype[C.OPS[D]]=G.prototype[D])},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.TilingPattern=p.PathType=void 0,p.getShadingPattern=o;var S=$(1),C=$(8),Q=$(3);const W={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};p.PathType=W;function tt(r,g){if(!g||Q.isNodeJS)return;const m=g[2]-g[0],a=g[3]-g[1],e=new Path2D;e.rect(g[0],g[1],m,a),r.clip(e)}class N{constructor(){this.constructor===N&&(0,S.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,S.unreachable)("Abstract method `getPattern` called.")}}class f extends N{constructor(g){super(),this._type=g[1],this._bbox=g[2],this._colorStops=g[3],this._p0=g[4],this._p1=g[5],this._r0=g[6],this._r1=g[7],this.matrix=null}_createGradient(g){let m;this._type==="axial"?m=g.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(m=g.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const a of this._colorStops)m.addColorStop(a[0],a[1]);return m}getPattern(g,m,a,e){let s;if(e===W.STROKE||e===W.FILL){const d=m.current.getClippedPathBoundingBox(e,(0,C.getCurrentTransform)(g))||[0,0,0,0],x=Math.ceil(d[2]-d[0])||1,A=Math.ceil(d[3]-d[1])||1,u=m.cachedCanvases.getCanvas("pattern",x,A,!0),w=u.context;w.clearRect(0,0,w.canvas.width,w.canvas.height),w.beginPath(),w.rect(0,0,w.canvas.width,w.canvas.height),w.translate(-d[0],-d[1]),a=S.Util.transform(a,[1,0,0,1,d[0],d[1]]),w.transform(...m.baseTransform),this.matrix&&w.transform(...this.matrix),tt(w,this._bbox),w.fillStyle=this._createGradient(w),w.fill(),s=g.createPattern(u.canvas,"no-repeat");const J=new DOMMatrix(a);try{s.setTransform(J)}catch(st){(0,S.warn)(`RadialAxialShadingPattern.getPattern: "${st==null?void 0:st.message}".`)}}else tt(g,this._bbox),s=this._createGradient(g);return s}}function E(r,g,m,a,e,s,d,x){const A=g.coords,u=g.colors,w=r.data,J=r.width*4;let st;A[m+1]>A[a+1]&&(st=m,m=a,a=st,st=s,s=d,d=st),A[a+1]>A[e+1]&&(st=a,a=e,e=st,st=d,d=x,x=st),A[m+1]>A[a+1]&&(st=m,m=a,a=st,st=s,s=d,d=st);const Y=(A[m]+g.offsetX)*g.scaleX,z=(A[m+1]+g.offsetY)*g.scaleY,j=(A[a]+g.offsetX)*g.scaleX,q=(A[a+1]+g.offsetY)*g.scaleY,G=(A[e]+g.offsetX)*g.scaleX,et=(A[e+1]+g.offsetY)*g.scaleY;if(z>=et)return;const ct=u[s],bt=u[s+1],D=u[s+2],c=u[d],l=u[d+1],T=u[d+2],M=u[x],O=u[x+1],I=u[x+2],X=Math.round(z),H=Math.round(et);let i,h,_,v,k,L,nt,dt;for(let K=X;K<=H;K++){if(K<q){let R;K<z?R=0:R=(z-K)/(z-q),i=Y-(Y-j)*R,h=ct-(ct-c)*R,_=bt-(bt-l)*R,v=D-(D-T)*R}else{let R;K>et?R=1:q===et?R=0:R=(q-K)/(q-et),i=j-(j-G)*R,h=c-(c-M)*R,_=l-(l-O)*R,v=T-(T-I)*R}let ot;K<z?ot=0:K>et?ot=1:ot=(z-K)/(z-et),k=Y-(Y-G)*ot,L=ct-(ct-M)*ot,nt=bt-(bt-O)*ot,dt=D-(D-I)*ot;const Z=Math.round(Math.min(i,k)),lt=Math.round(Math.max(i,k));let ft=J*K+Z*4;for(let R=Z;R<=lt;R++)ot=(i-R)/(i-k),ot<0?ot=0:ot>1&&(ot=1),w[ft++]=h-(h-L)*ot|0,w[ft++]=_-(_-nt)*ot|0,w[ft++]=v-(v-dt)*ot|0,w[ft++]=255}}function F(r,g,m){const a=g.coords,e=g.colors;let s,d;switch(g.type){case"lattice":const x=g.verticesPerRow,A=Math.floor(a.length/x)-1,u=x-1;for(s=0;s<A;s++){let w=s*x;for(let J=0;J<u;J++,w++)E(r,m,a[w],a[w+1],a[w+x],e[w],e[w+1],e[w+x]),E(r,m,a[w+x+1],a[w+1],a[w+x],e[w+x+1],e[w+1],e[w+x])}break;case"triangles":for(s=0,d=a.length;s<d;s+=3)E(r,m,a[s],a[s+1],a[s+2],e[s],e[s+1],e[s+2]);break;default:throw new Error("illegal figure")}}class b extends N{constructor(g){super(),this._coords=g[2],this._colors=g[3],this._figures=g[4],this._bounds=g[5],this._bbox=g[7],this._background=g[8],this.matrix=null}_createMeshCanvas(g,m,a){const x=Math.floor(this._bounds[0]),A=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-x,w=Math.ceil(this._bounds[3])-A,J=Math.min(Math.ceil(Math.abs(u*g[0]*1.1)),3e3),st=Math.min(Math.ceil(Math.abs(w*g[1]*1.1)),3e3),Y=u/J,z=w/st,j={coords:this._coords,colors:this._colors,offsetX:-x,offsetY:-A,scaleX:1/Y,scaleY:1/z},q=J+2*2,G=st+2*2,et=a.getCanvas("mesh",q,G,!1),ct=et.context,bt=ct.createImageData(J,st);if(m){const c=bt.data;for(let l=0,T=c.length;l<T;l+=4)c[l]=m[0],c[l+1]=m[1],c[l+2]=m[2],c[l+3]=255}for(const c of this._figures)F(bt,c,j);return ct.putImageData(bt,2,2),{canvas:et.canvas,offsetX:x-2*Y,offsetY:A-2*z,scaleX:Y,scaleY:z}}getPattern(g,m,a,e){tt(g,this._bbox);let s;if(e===W.SHADING)s=S.Util.singularValueDecompose2dScale((0,C.getCurrentTransform)(g));else if(s=S.Util.singularValueDecompose2dScale(m.baseTransform),this.matrix){const x=S.Util.singularValueDecompose2dScale(this.matrix);s=[s[0]*x[0],s[1]*x[1]]}const d=this._createMeshCanvas(s,e===W.SHADING?null:this._background,m.cachedCanvases);return e!==W.SHADING&&(g.setTransform(...m.baseTransform),this.matrix&&g.transform(...this.matrix)),g.translate(d.offsetX,d.offsetY),g.scale(d.scaleX,d.scaleY),g.createPattern(d.canvas,"no-repeat")}}class y extends N{getPattern(){return"hotpink"}}function o(r){switch(r[0]){case"RadialAxial":return new f(r);case"Mesh":return new b(r);case"Dummy":return new y}throw new Error(`Unknown IR type: ${r[0]}`)}const t={COLORED:1,UNCOLORED:2};class n{static get MAX_PATTERN_SIZE(){return(0,S.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(g,m,a,e,s){this.operatorList=g[2],this.matrix=g[3]||[1,0,0,1,0,0],this.bbox=g[4],this.xstep=g[5],this.ystep=g[6],this.paintType=g[7],this.tilingType=g[8],this.color=m,this.ctx=a,this.canvasGraphicsFactory=e,this.baseTransform=s}createPatternCanvas(g){const m=this.operatorList,a=this.bbox,e=this.xstep,s=this.ystep,d=this.paintType,x=this.tilingType,A=this.color,u=this.canvasGraphicsFactory;(0,S.info)("TilingType: "+x);const w=a[0],J=a[1],st=a[2],Y=a[3],z=S.Util.singularValueDecompose2dScale(this.matrix),j=S.Util.singularValueDecompose2dScale(this.baseTransform),q=[z[0]*j[0],z[1]*j[1]],G=this.getSizeAndScale(e,this.ctx.canvas.width,q[0]),et=this.getSizeAndScale(s,this.ctx.canvas.height,q[1]),ct=g.cachedCanvases.getCanvas("pattern",G.size,et.size,!0),bt=ct.context,D=u.createCanvasGraphics(bt);D.groupLevel=g.groupLevel,this.setFillAndStrokeStyleToContext(D,d,A);let c=w,l=J,T=st,M=Y;return w<0&&(c=0,T+=Math.abs(w)),J<0&&(l=0,M+=Math.abs(J)),bt.translate(-(G.scale*c),-(et.scale*l)),D.transform(G.scale,0,0,et.scale,0,0),bt.save(),this.clipBbox(D,c,l,T,M),D.baseTransform=(0,C.getCurrentTransform)(D.ctx),D.executeOperatorList(m),D.endDrawing(),{canvas:ct.canvas,scaleX:G.scale,scaleY:et.scale,offsetX:c,offsetY:l}}getSizeAndScale(g,m,a){g=Math.abs(g);const e=Math.max(n.MAX_PATTERN_SIZE,m);let s=Math.ceil(g*a);return s>=e?s=e:a=s/g,{scale:a,size:s}}clipBbox(g,m,a,e,s){const d=e-m,x=s-a;g.ctx.rect(m,a,d,x),g.current.updateRectMinMax((0,C.getCurrentTransform)(g.ctx),[m,a,e,s]),g.clip(),g.endPath()}setFillAndStrokeStyleToContext(g,m,a){const e=g.ctx,s=g.current;switch(m){case t.COLORED:const d=this.ctx;e.fillStyle=d.fillStyle,e.strokeStyle=d.strokeStyle,s.fillColor=d.fillStyle,s.strokeColor=d.strokeStyle;break;case t.UNCOLORED:const x=S.Util.makeHexColor(a[0],a[1],a[2]);e.fillStyle=x,e.strokeStyle=x,s.fillColor=x,s.strokeColor=x;break;default:throw new S.FormatError(`Unsupported paint type: ${m}`)}}getPattern(g,m,a,e){let s=a;e!==W.SHADING&&(s=S.Util.transform(s,m.baseTransform),this.matrix&&(s=S.Util.transform(s,this.matrix)));const d=this.createPatternCanvas(m);let x=new DOMMatrix(s);x=x.translate(d.offsetX,d.offsetY),x=x.scale(1/d.scaleX,1/d.scaleY);const A=g.createPattern(d.canvas,"repeat");try{A.setTransform(x)}catch(u){(0,S.warn)(`TilingPattern.getPattern: "${u==null?void 0:u.message}".`)}return A}}p.TilingPattern=n},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.applyMaskImageData=C;var S=$(1);function C({src:Q,srcPos:W=0,dest:tt,destPos:N=0,width:f,height:E,inverseDecode:F=!1}){const b=S.FeatureTest.isLittleEndian?4278190080:255,[y,o]=F?[0,b]:[b,0],t=f>>3,n=f&7,r=Q.length;tt=new Uint32Array(tt.buffer);for(let g=0;g<E;g++){for(const a=W+t;W<a;W++){const e=W<r?Q[W]:255;tt[N++]=e&128?o:y,tt[N++]=e&64?o:y,tt[N++]=e&32?o:y,tt[N++]=e&16?o:y,tt[N++]=e&8?o:y,tt[N++]=e&4?o:y,tt[N++]=e&2?o:y,tt[N++]=e&1?o:y}if(n===0)continue;const m=W<r?Q[W++]:255;for(let a=0;a<n;a++)tt[N++]=m&1<<7-a?o:y}return{srcPos:W,destPos:N}}},(it,p)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.GlobalWorkerOptions=void 0;const $=Object.create(null);p.GlobalWorkerOptions=$,$.workerPort=$.workerPort===void 0?null:$.workerPort,$.workerSrc=$.workerSrc===void 0?"":$.workerSrc},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.MessageHandler=void 0;var S=$(1);const C={UNKNOWN:0,DATA:1,ERROR:2},Q={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function W(N){switch(N instanceof Error||typeof N=="object"&&N!==null||(0,S.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),N.name){case"AbortException":return new S.AbortException(N.message);case"MissingPDFException":return new S.MissingPDFException(N.message);case"PasswordException":return new S.PasswordException(N.message,N.code);case"UnexpectedResponseException":return new S.UnexpectedResponseException(N.message,N.status);case"UnknownErrorException":return new S.UnknownErrorException(N.message,N.details);default:return new S.UnknownErrorException(N.message,N.toString())}}class tt{constructor(f,E,F){this.sourceName=f,this.targetName=E,this.comObj=F,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=b=>{const y=b.data;if(y.targetName!==this.sourceName)return;if(y.stream){this._processStreamMessage(y);return}if(y.callback){const t=y.callbackId,n=this.callbackCapabilities[t];if(!n)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],y.callback===C.DATA)n.resolve(y.data);else if(y.callback===C.ERROR)n.reject(W(y.reason));else throw new Error("Unexpected callback case");return}const o=this.actionHandler[y.action];if(!o)throw new Error(`Unknown action from worker: ${y.action}`);if(y.callbackId){const t=this.sourceName,n=y.sourceName;new Promise(function(r){r(o(y.data))}).then(function(r){F.postMessage({sourceName:t,targetName:n,callback:C.DATA,callbackId:y.callbackId,data:r})},function(r){F.postMessage({sourceName:t,targetName:n,callback:C.ERROR,callbackId:y.callbackId,reason:W(r)})});return}if(y.streamId){this._createStreamSink(y);return}o(y.data)},F.addEventListener("message",this._onComObjOnMessage)}on(f,E){const F=this.actionHandler;if(F[f])throw new Error(`There is already an actionName called "${f}"`);F[f]=E}send(f,E,F){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,data:E},F)}sendWithPromise(f,E,F){const b=this.callbackId++,y=(0,S.createPromiseCapability)();this.callbackCapabilities[b]=y;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,callbackId:b,data:E},F)}catch(o){y.reject(o)}return y.promise}sendWithStream(f,E,F,b){const y=this.streamId++,o=this.sourceName,t=this.targetName,n=this.comObj;return new ReadableStream({start:r=>{const g=(0,S.createPromiseCapability)();return this.streamControllers[y]={controller:r,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},n.postMessage({sourceName:o,targetName:t,action:f,streamId:y,data:E,desiredSize:r.desiredSize},b),g.promise},pull:r=>{const g=(0,S.createPromiseCapability)();return this.streamControllers[y].pullCall=g,n.postMessage({sourceName:o,targetName:t,stream:Q.PULL,streamId:y,desiredSize:r.desiredSize}),g.promise},cancel:r=>{(0,S.assert)(r instanceof Error,"cancel must have a valid reason");const g=(0,S.createPromiseCapability)();return this.streamControllers[y].cancelCall=g,this.streamControllers[y].isClosed=!0,n.postMessage({sourceName:o,targetName:t,stream:Q.CANCEL,streamId:y,reason:W(r)}),g.promise}},F)}_createStreamSink(f){const E=f.streamId,F=this.sourceName,b=f.sourceName,y=this.comObj,o=this,t=this.actionHandler[f.action],n={enqueue(r,g=1,m){if(this.isCancelled)return;const a=this.desiredSize;this.desiredSize-=g,a>0&&this.desiredSize<=0&&(this.sinkCapability=(0,S.createPromiseCapability)(),this.ready=this.sinkCapability.promise),y.postMessage({sourceName:F,targetName:b,stream:Q.ENQUEUE,streamId:E,chunk:r},m)},close(){this.isCancelled||(this.isCancelled=!0,y.postMessage({sourceName:F,targetName:b,stream:Q.CLOSE,streamId:E}),delete o.streamSinks[E])},error(r){(0,S.assert)(r instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,y.postMessage({sourceName:F,targetName:b,stream:Q.ERROR,streamId:E,reason:W(r)}))},sinkCapability:(0,S.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:f.desiredSize,ready:null};n.sinkCapability.resolve(),n.ready=n.sinkCapability.promise,this.streamSinks[E]=n,new Promise(function(r){r(t(f.data,n))}).then(function(){y.postMessage({sourceName:F,targetName:b,stream:Q.START_COMPLETE,streamId:E,success:!0})},function(r){y.postMessage({sourceName:F,targetName:b,stream:Q.START_COMPLETE,streamId:E,reason:W(r)})})}_processStreamMessage(f){const E=f.streamId,F=this.sourceName,b=f.sourceName,y=this.comObj,o=this.streamControllers[E],t=this.streamSinks[E];switch(f.stream){case Q.START_COMPLETE:f.success?o.startCall.resolve():o.startCall.reject(W(f.reason));break;case Q.PULL_COMPLETE:f.success?o.pullCall.resolve():o.pullCall.reject(W(f.reason));break;case Q.PULL:if(!t){y.postMessage({sourceName:F,targetName:b,stream:Q.PULL_COMPLETE,streamId:E,success:!0});break}t.desiredSize<=0&&f.desiredSize>0&&t.sinkCapability.resolve(),t.desiredSize=f.desiredSize,new Promise(function(n){n(t.onPull&&t.onPull())}).then(function(){y.postMessage({sourceName:F,targetName:b,stream:Q.PULL_COMPLETE,streamId:E,success:!0})},function(n){y.postMessage({sourceName:F,targetName:b,stream:Q.PULL_COMPLETE,streamId:E,reason:W(n)})});break;case Q.ENQUEUE:if((0,S.assert)(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(f.chunk);break;case Q.CLOSE:if((0,S.assert)(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this._deleteStreamController(o,E);break;case Q.ERROR:(0,S.assert)(o,"error should have stream controller"),o.controller.error(W(f.reason)),this._deleteStreamController(o,E);break;case Q.CANCEL_COMPLETE:f.success?o.cancelCall.resolve():o.cancelCall.reject(W(f.reason)),this._deleteStreamController(o,E);break;case Q.CANCEL:if(!t)break;new Promise(function(n){n(t.onCancel&&t.onCancel(W(f.reason)))}).then(function(){y.postMessage({sourceName:F,targetName:b,stream:Q.CANCEL_COMPLETE,streamId:E,success:!0})},function(n){y.postMessage({sourceName:F,targetName:b,stream:Q.CANCEL_COMPLETE,streamId:E,reason:W(n)})}),t.sinkCapability.reject(W(f.reason)),t.isCancelled=!0,delete this.streamSinks[E];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(f,E){await Promise.allSettled([f.startCall&&f.startCall.promise,f.pullCall&&f.pullCall.promise,f.cancelCall&&f.cancelCall.promise]),delete this.streamControllers[E]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}p.MessageHandler=tt},(it,p,$)=>{var Q,W;Object.defineProperty(p,"__esModule",{value:!0}),p.Metadata=void 0;var S=$(1);class C{constructor({parsedData:N,rawData:f}){at(this,Q,void 0);at(this,W,void 0);mt(this,Q,N),mt(this,W,f)}getRaw(){return P(this,W)}get(N){var f;return(f=P(this,Q).get(N))!=null?f:null}getAll(){return(0,S.objectFromMap)(P(this,Q))}has(N){return P(this,Q).has(N)}}Q=new WeakMap,W=new WeakMap,p.Metadata=C},(it,p,$)=>{var tt,N,f,E,F,b,pe;Object.defineProperty(p,"__esModule",{value:!0}),p.OptionalContentConfig=void 0;var S=$(1);const C=Symbol("INTERNAL");class Q{constructor(t,n){at(this,tt,!0);this.name=t,this.intent=n}get visible(){return P(this,tt)}_setVisible(t,n){t!==C&&(0,S.unreachable)("Internal method `_setVisible` called."),mt(this,tt,n)}}tt=new WeakMap;class W{constructor(t){at(this,b);at(this,N,!0);at(this,f,new Map);at(this,E,null);at(this,F,null);if(this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,mt(this,F,t.order);for(const n of t.groups)P(this,f).set(n.id,new Q(n.name,n.intent));if(t.baseState==="OFF")for(const n of P(this,f).values())n._setVisible(C,!1);for(const n of t.on)P(this,f).get(n)._setVisible(C,!0);for(const n of t.off)P(this,f).get(n)._setVisible(C,!1);mt(this,E,new Map);for(const[n,r]of P(this,f))P(this,E).set(n,r.visible)}}isVisible(t){if(P(this,f).size===0)return!0;if(!t)return(0,S.warn)("Optional content group not defined."),!0;if(t.type==="OCG")return P(this,f).has(t.id)?P(this,f).get(t.id).visible:((0,S.warn)(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return ht(this,b,pe).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const n of t.ids){if(!P(this,f).has(n))return(0,S.warn)(`Optional content group not found: ${n}`),!0;if(P(this,f).get(n).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const n of t.ids){if(!P(this,f).has(n))return(0,S.warn)(`Optional content group not found: ${n}`),!0;if(!P(this,f).get(n).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const n of t.ids){if(!P(this,f).has(n))return(0,S.warn)(`Optional content group not found: ${n}`),!0;if(!P(this,f).get(n).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const n of t.ids){if(!P(this,f).has(n))return(0,S.warn)(`Optional content group not found: ${n}`),!0;if(P(this,f).get(n).visible)return!1}return!0}return(0,S.warn)(`Unknown optional content policy ${t.policy}.`),!0}return(0,S.warn)(`Unknown group type ${t.type}.`),!0}setVisibility(t,n=!0){if(!P(this,f).has(t)){(0,S.warn)(`Optional content group not found: ${t}`);return}P(this,f).get(t)._setVisible(C,!!n),mt(this,N,null)}get hasInitialVisibility(){if(P(this,N)!==null)return P(this,N);for(const[t,n]of P(this,f)){const r=P(this,E).get(t);if(n.visible!==r)return mt(this,N,!1)}return mt(this,N,!0)}getOrder(){return P(this,f).size?P(this,F)?P(this,F).slice():[...P(this,f).keys()]:null}getGroups(){return P(this,f).size>0?(0,S.objectFromMap)(P(this,f)):null}getGroup(t){return P(this,f).get(t)||null}}N=new WeakMap,f=new WeakMap,E=new WeakMap,F=new WeakMap,b=new WeakSet,pe=function(t){const n=t.length;if(n<2)return!0;const r=t[0];for(let g=1;g<n;g++){const m=t[g];let a;if(Array.isArray(m))a=ht(this,b,pe).call(this,m);else if(P(this,f).has(m))a=P(this,f).get(m).visible;else return(0,S.warn)(`Optional content group not found: ${m}`),!0;switch(r){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return r==="And"},p.OptionalContentConfig=W},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.PDFDataTransportStream=void 0;var S=$(1),C=$(8);class Q{constructor(f,E){(0,S.assert)(E,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=f.progressiveDone||!1,this._contentDispositionFilename=f.contentDispositionFilename||null;const F=f.initialData;if((F==null?void 0:F.length)>0){const b=new Uint8Array(F).buffer;this._queuedChunks.push(b)}this._pdfDataRangeTransport=E,this._isStreamingSupported=!f.disableStream,this._isRangeSupported=!f.disableRange,this._contentLength=f.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((b,y)=>{this._onReceiveData({begin:b,chunk:y})}),this._pdfDataRangeTransport.addProgressListener((b,y)=>{this._onProgress({loaded:b,total:y})}),this._pdfDataRangeTransport.addProgressiveReadListener(b=>{this._onReceiveData({chunk:b})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(f){const E=new Uint8Array(f.chunk).buffer;if(f.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(E):this._queuedChunks.push(E);else{const F=this._rangeReaders.some(function(b){return b._begin!==f.begin?!1:(b._enqueue(E),!0)});(0,S.assert)(F,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var f,E;return(E=(f=this._fullRequestReader)==null?void 0:f._loaded)!=null?E:0}_onProgress(f){if(f.total===void 0){const E=this._rangeReaders[0];E!=null&&E.onProgress&&E.onProgress({loaded:f.loaded})}else{const E=this._fullRequestReader;E!=null&&E.onProgress&&E.onProgress({loaded:f.loaded,total:f.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const E=this._rangeReaders.indexOf(f);E>=0&&this._rangeReaders.splice(E,1)}getFullReader(){(0,S.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new W(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,E){if(E<=this._progressiveDataLength)return null;const F=new tt(this,f,E);return this._pdfDataRangeTransport.requestDataRange(f,E),this._rangeReaders.push(F),F}cancelAllRequests(f){this._fullRequestReader&&this._fullRequestReader.cancel(f);for(const E of this._rangeReaders.slice(0))E.cancel(f);this._pdfDataRangeTransport.abort()}}p.PDFDataTransportStream=Q;class W{constructor(f,E,F=!1,b=null){this._stream=f,this._done=F||!1,this._filename=(0,C.isPdfFile)(b)?b:null,this._queuedChunks=E||[],this._loaded=0;for(const y of this._queuedChunks)this._loaded+=y.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=(0,S.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class tt{constructor(f,E,F){this._stream=f,this._begin=E,this._end=F,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const E=this._queuedChunk;return this._queuedChunk=null,{value:E,done:!1}}if(this._done)return{value:void 0,done:!0};const f=(0,S.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(it,p)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.XfaText=void 0;class ${static textContent(C){const Q=[],W={items:Q,styles:Object.create(null)};function tt(N){var F;if(!N)return;let f=null;const E=N.name;if(E==="#text")f=N.value;else if($.shouldBuildText(E))(F=N==null?void 0:N.attributes)!=null&&F.textContent?f=N.attributes.textContent:N.value&&(f=N.value);else return;if(f!==null&&Q.push({str:f}),!!N.children)for(const b of N.children)tt(b)}return tt(C),W}static shouldBuildText(C){return!(C==="textarea"||C==="input"||C==="option"||C==="select")}}p.XfaText=$},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.NodeStandardFontDataFactory=p.NodeCanvasFactory=p.NodeCMapReaderFactory=void 0;var S=$(9);const C=function(N){return new Promise((f,E)=>{require$$4.readFile(N,(b,y)=>{if(b||!y){E(new Error(b));return}f(new Uint8Array(y))})})};class Q extends S.BaseCanvasFactory{_createCanvas(f,E){return require$$4.createCanvas(f,E)}}p.NodeCanvasFactory=Q;class W extends S.BaseCMapReaderFactory{_fetchData(f,E){return C(f).then(F=>({cMapData:F,compressionType:E}))}}p.NodeCMapReaderFactory=W;class tt extends S.BaseStandardFontDataFactory{_fetchData(f){return C(f)}}p.NodeStandardFontDataFactory=tt},(it,p,$)=>{var N,f,E,F,b,y,o,t,n,ge,g,Oe,a,me,s,De;Object.defineProperty(p,"__esModule",{value:!0}),p.AnnotationEditorLayer=void 0;var S=$(7),C=$(1),Q=$(23),W=$(24);const x=class{constructor(u){at(this,n);at(this,g);at(this,a);at(this,s);at(this,N,void 0);at(this,f,!1);at(this,E,this.pointerup.bind(this));at(this,F,this.pointerdown.bind(this));at(this,b,new Map);at(this,y,!1);at(this,o,!1);at(this,t,void 0);x._initialized||(x._initialized=!0,Q.FreeTextEditor.initialize(u.l10n),W.InkEditor.initialize(u.l10n),u.uiManager.registerEditorTypes([Q.FreeTextEditor,W.InkEditor])),mt(this,t,u.uiManager),this.annotationStorage=u.annotationStorage,this.pageIndex=u.pageIndex,this.div=u.div,mt(this,N,u.accessibilityManager),P(this,t).addLayer(this)}updateToolbar(u){P(this,t).updateToolbar(u)}updateMode(u=P(this,t).getMode()){ht(this,s,De).call(this),u===C.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),P(this,t).unselectAll()}addInkEditorIfNeeded(u){if(!u&&P(this,t).getMode()!==C.AnnotationEditorType.INK)return;if(!u){for(const J of P(this,b).values())if(J.isEmpty()){J.setInBackground();return}}ht(this,a,me).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(u){P(this,t).setEditingState(u)}addCommands(u){P(this,t).addCommands(u)}enable(){this.div.style.pointerEvents="auto";for(const u of P(this,b).values())u.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const u of P(this,b).values())u.disableEditing()}setActiveEditor(u){P(this,t).getActive()!==u&&P(this,t).setActiveEditor(u)}enableClick(){this.div.addEventListener("pointerdown",P(this,F)),this.div.addEventListener("pointerup",P(this,E))}disableClick(){this.div.removeEventListener("pointerdown",P(this,F)),this.div.removeEventListener("pointerup",P(this,E))}attach(u){P(this,b).set(u.id,u)}detach(u){var w;P(this,b).delete(u.id),(w=P(this,N))==null||w.removePointerInTextLayer(u.contentDiv)}remove(u){P(this,t).removeEditor(u),this.detach(u),this.annotationStorage.remove(u.id),u.div.style.display="none",setTimeout(()=>{u.div.style.display="",u.div.remove(),u.isAttachedToDOM=!1,document.activeElement===document.body&&P(this,t).focusMainContainer()},0),P(this,o)||this.addInkEditorIfNeeded(!1)}add(u){if(ht(this,n,ge).call(this,u),P(this,t).addEditor(u),this.attach(u),!u.isAttachedToDOM){const w=u.render();this.div.append(w),u.isAttachedToDOM=!0}this.moveEditorInDOM(u),u.onceAdded(),this.addToAnnotationStorage(u)}moveEditorInDOM(u){var w;(w=P(this,N))==null||w.moveElementInDOM(this.div,u.div,u.contentDiv,!0)}addToAnnotationStorage(u){!u.isEmpty()&&!this.annotationStorage.has(u.id)&&this.annotationStorage.setValue(u.id,u)}addOrRebuild(u){u.needsToBeRebuilt()?u.rebuild():this.add(u)}addANewEditor(u){const w=()=>{this.addOrRebuild(u)},J=()=>{u.remove()};this.addCommands({cmd:w,undo:J,mustExec:!0})}addUndoableEditor(u){const w=()=>{this.addOrRebuild(u)},J=()=>{u.remove()};this.addCommands({cmd:w,undo:J,mustExec:!1})}getNextId(){return P(this,t).getId()}deserialize(u){switch(u.annotationType){case C.AnnotationEditorType.FREETEXT:return Q.FreeTextEditor.deserialize(u,this);case C.AnnotationEditorType.INK:return W.InkEditor.deserialize(u,this)}return null}setSelected(u){P(this,t).setSelected(u)}toggleSelected(u){P(this,t).toggleSelected(u)}isSelected(u){return P(this,t).isSelected(u)}unselect(u){P(this,t).unselect(u)}pointerup(u){const w=S.KeyboardManager.platform.isMac;if(!(u.button!==0||u.ctrlKey&&w)&&u.target===this.div&&!!P(this,y)){if(mt(this,y,!1),!P(this,f)){mt(this,f,!0);return}ht(this,a,me).call(this,u)}}pointerdown(u){const w=S.KeyboardManager.platform.isMac;if(u.button!==0||u.ctrlKey&&w||u.target!==this.div)return;mt(this,y,!0);const J=P(this,t).getActive();mt(this,f,!J||J.isEmpty())}drop(u){const w=u.dataTransfer.getData("text/plain"),J=P(this,t).getEditor(w);if(!J)return;u.preventDefault(),u.dataTransfer.dropEffect="move",ht(this,n,ge).call(this,J);const st=this.div.getBoundingClientRect(),Y=u.clientX-st.x,z=u.clientY-st.y;J.translate(Y-J.startX,z-J.startY),this.moveEditorInDOM(J),J.div.focus()}dragover(u){u.preventDefault()}destroy(){var u,w;((u=P(this,t).getActive())==null?void 0:u.parent)===this&&P(this,t).setActiveEditor(null);for(const J of P(this,b).values())(w=P(this,N))==null||w.removePointerInTextLayer(J.contentDiv),J.isAttachedToDOM=!1,J.div.remove(),J.parent=null;this.div=null,P(this,b).clear(),P(this,t).removeLayer(this)}render(u){this.viewport=u.viewport,(0,S.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const w of P(this,t).getEditors(this.pageIndex))this.add(w);this.updateMode()}update(u){this.viewport=u.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[u,w,J,st]=this.viewport.viewBox,Y=J-u,z=st-w;return[Y,z]}get viewportBaseDimensions(){const{width:u,height:w,rotation:J}=this.viewport;return J%180===0?[u,w]:[w,u]}setDimensions(){const{width:u,height:w,rotation:J}=this.viewport,st=J%180!==0,Y=Math.floor(u)+"px",z=Math.floor(w)+"px";this.div.style.width=st?z:Y,this.div.style.height=st?Y:z,this.div.setAttribute("data-main-rotation",J)}};let tt=x;N=new WeakMap,f=new WeakMap,E=new WeakMap,F=new WeakMap,b=new WeakMap,y=new WeakMap,o=new WeakMap,t=new WeakMap,n=new WeakSet,ge=function(u){var w;u.parent!==this&&(this.attach(u),u.pageIndex=this.pageIndex,(w=u.parent)==null||w.detach(u),u.parent=this,u.div&&u.isAttachedToDOM&&(u.div.remove(),this.div.append(u.div)))},g=new WeakSet,Oe=function(u){switch(P(this,t).getMode()){case C.AnnotationEditorType.FREETEXT:return new Q.FreeTextEditor(u);case C.AnnotationEditorType.INK:return new W.InkEditor(u)}return null},a=new WeakSet,me=function(u){const w=this.getNextId(),J=ht(this,g,Oe).call(this,{parent:this,id:w,x:u.offsetX,y:u.offsetY});return J&&this.add(J),J},s=new WeakSet,De=function(){mt(this,o,!0);for(const u of P(this,b).values())u.isEmpty()&&u.remove();mt(this,o,!1)},Mt(tt,"_initialized",!1),p.AnnotationEditorLayer=tt},(it,p,$)=>{var tt,N,f,E,F,b,y,o,Ie,n,Le,g,Ne,a,_e;Object.defineProperty(p,"__esModule",{value:!0}),p.FreeTextEditor=void 0;var S=$(1),C=$(7),Q=$(6);const s=class extends Q.AnnotationEditor{constructor(A){super(oe(ae({},A),{name:"freeTextEditor"}));at(this,o);at(this,n);at(this,g);at(this,a);at(this,tt,this.editorDivBlur.bind(this));at(this,N,this.editorDivFocus.bind(this));at(this,f,this.editorDivKeydown.bind(this));at(this,E,void 0);at(this,F,"");at(this,b,!1);at(this,y,void 0);mt(this,E,A.color||s._defaultColor||Q.AnnotationEditor._defaultLineColor),mt(this,y,A.fontSize||s._defaultFontSize)}static initialize(A){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(w=>[w,A.get(w)]));const u=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(u.getPropertyValue("--freetext-padding"))}static updateDefaultParams(A,u){switch(A){case S.AnnotationEditorParamsType.FREETEXT_SIZE:s._defaultFontSize=u;break;case S.AnnotationEditorParamsType.FREETEXT_COLOR:s._defaultColor=u;break}}updateParams(A,u){switch(A){case S.AnnotationEditorParamsType.FREETEXT_SIZE:ht(this,o,Ie).call(this,u);break;case S.AnnotationEditorParamsType.FREETEXT_COLOR:ht(this,n,Le).call(this,u);break}}static get defaultPropertiesToUpdate(){return[[S.AnnotationEditorParamsType.FREETEXT_SIZE,s._defaultFontSize],[S.AnnotationEditorParamsType.FREETEXT_COLOR,s._defaultColor||Q.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[S.AnnotationEditorParamsType.FREETEXT_SIZE,P(this,y)],[S.AnnotationEditorParamsType.FREETEXT_COLOR,P(this,E)]]}getInitialTranslation(){return[-s._internalPadding*this.parent.scaleFactor,-(s._internalPadding+P(this,y))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(S.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",P(this,f)),this.editorDiv.addEventListener("focus",P(this,N)),this.editorDiv.addEventListener("blur",P(this,tt)))}disableEditMode(){!this.isInEditMode()||(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",P(this,f)),this.editorDiv.removeEventListener("focus",P(this,N)),this.editorDiv.removeEventListener("blur",P(this,tt)),this.div.focus(),this.isEditing=!1)}focusin(A){super.focusin(A),A.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),P(this,b)||(mt(this,b,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),mt(this,F,ht(this,g,Ne).call(this).trimEnd()),ht(this,a,_e).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(A){this.enableEditMode(),this.editorDiv.focus()}keydown(A){A.target===this.div&&A.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(A){s._keyboardManager.exec(this,A)}editorDivFocus(A){this.isEditing=!0}editorDivBlur(A){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let A,u;this.width&&(A=this.x,u=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),s._l10nPromise.get("editor_free_text_aria_label").then(J=>{var st;return(st=this.editorDiv)==null?void 0:st.setAttribute("aria-label",J)}),s._l10nPromise.get("free_text_default_content").then(J=>{var st;return(st=this.editorDiv)==null?void 0:st.setAttribute("default-content",J)}),this.editorDiv.contentEditable=!0;const{style:w}=this.editorDiv;if(w.fontSize=`calc(${P(this,y)}px * var(--scale-factor))`,w.color=P(this,E),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,C.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[J,st]=this.parent.viewportBaseDimensions;this.setAt(A*J,u*st,this.width*J,this.height*st);for(const Y of P(this,F).split(`
`)){const z=document.createElement("div");z.append(Y?document.createTextNode(Y):document.createElement("br")),this.editorDiv.append(z)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(A,u){const w=super.deserialize(A,u);return mt(w,y,A.fontSize),mt(w,E,S.Util.makeHexColor(...A.color)),mt(w,F,A.value),w}serialize(){if(this.isEmpty())return null;const A=s._internalPadding*this.parent.scaleFactor,u=this.getRect(A,A),w=Q.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:S.AnnotationEditorType.FREETEXT,color:w,fontSize:P(this,y),value:P(this,F),pageIndex:this.parent.pageIndex,rect:u,rotation:this.rotation}}};let W=s;tt=new WeakMap,N=new WeakMap,f=new WeakMap,E=new WeakMap,F=new WeakMap,b=new WeakMap,y=new WeakMap,o=new WeakSet,Ie=function(A){const u=J=>{this.editorDiv.style.fontSize=`calc(${J}px * var(--scale-factor))`,this.translate(0,-(J-P(this,y))*this.parent.scaleFactor),mt(this,y,J),ht(this,a,_e).call(this)},w=P(this,y);this.parent.addCommands({cmd:()=>{u(A)},undo:()=>{u(w)},mustExec:!0,type:S.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},n=new WeakSet,Le=function(A){const u=P(this,E);this.parent.addCommands({cmd:()=>{mt(this,E,A),this.editorDiv.style.color=A},undo:()=>{mt(this,E,u),this.editorDiv.style.color=u},mustExec:!0,type:S.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},g=new WeakSet,Ne=function(){const A=this.editorDiv.getElementsByTagName("div");if(A.length===0)return this.editorDiv.innerText;const u=[];for(let w=0,J=A.length;w<J;w++){const Y=A[w].firstChild;(Y==null?void 0:Y.nodeName)==="#text"?u.push(Y.data):u.push("")}return u.join(`
`)},a=new WeakSet,_e=function(){const[A,u]=this.parent.viewportBaseDimensions,w=this.div.getBoundingClientRect();this.width=w.width/A,this.height=w.height/u},Mt(W,"_freeTextDefaultContent",""),Mt(W,"_l10nPromise"),Mt(W,"_internalPadding",0),Mt(W,"_defaultColor",null),Mt(W,"_defaultFontSize",10),Mt(W,"_keyboardManager",new C.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],s.prototype.commitOrRemove]])),Mt(W,"_type","freetext"),p.FreeTextEditor=W},(it,p,$)=>{var f,E,F,b,y,o,t,n,r,g,m,a,e,s,d,je,A,Ue,w,Be,st,We,z,be,q,qe,et,He,bt,Ge,c,Gt,T,Ae,O,ee,X,ne,i,Yt,_,ye,k,se,nt,ve,K,Xe,Z,ze,ft,Ve,ut,Se,vt,ie,Tt,Kt,Ft,Ee;Object.defineProperty(p,"__esModule",{value:!0}),p.InkEditor=void 0,Object.defineProperty(p,"fitCurve",{enumerable:!0,get:function(){return Q.fitCurve}});var S=$(1),C=$(6),Q=$(25),W=$(7);const tt=16,xt=class extends C.AnnotationEditor{constructor(rt){super(oe(ae({},rt),{name:"inkEditor"}));at(this,d);at(this,A);at(this,w);at(this,st);at(this,z);at(this,q);at(this,et);at(this,bt);at(this,c);at(this,T);at(this,O);at(this,X);at(this,i);at(this,_);at(this,k);at(this,K);at(this,Z);at(this,ft);at(this,ut);at(this,vt);at(this,Tt);at(this,Ft);at(this,f,0);at(this,E,0);at(this,F,0);at(this,b,this.canvasPointermove.bind(this));at(this,y,this.canvasPointerleave.bind(this));at(this,o,this.canvasPointerup.bind(this));at(this,t,this.canvasPointerdown.bind(this));at(this,n,!1);at(this,r,!1);at(this,g,null);at(this,m,null);at(this,a,0);at(this,e,0);at(this,s,null);this.color=rt.color||null,this.thickness=rt.thickness||null,this.opacity=rt.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(rt){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(pt=>[pt,rt.get(pt)]))}static updateDefaultParams(rt,pt){switch(rt){case S.AnnotationEditorParamsType.INK_THICKNESS:xt._defaultThickness=pt;break;case S.AnnotationEditorParamsType.INK_COLOR:xt._defaultColor=pt;break;case S.AnnotationEditorParamsType.INK_OPACITY:xt._defaultOpacity=pt/100;break}}updateParams(rt,pt){switch(rt){case S.AnnotationEditorParamsType.INK_THICKNESS:ht(this,d,je).call(this,pt);break;case S.AnnotationEditorParamsType.INK_COLOR:ht(this,A,Ue).call(this,pt);break;case S.AnnotationEditorParamsType.INK_OPACITY:ht(this,w,Be).call(this,pt);break}}static get defaultPropertiesToUpdate(){return[[S.AnnotationEditorParamsType.INK_THICKNESS,xt._defaultThickness],[S.AnnotationEditorParamsType.INK_COLOR,xt._defaultColor||C.AnnotationEditor._defaultLineColor],[S.AnnotationEditorParamsType.INK_OPACITY,Math.round(xt._defaultOpacity*100)]]}get propertiesToUpdate(){var rt;return[[S.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||xt._defaultThickness],[S.AnnotationEditorParamsType.INK_COLOR,this.color||xt._defaultColor||C.AnnotationEditor._defaultLineColor],[S.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((rt=this.opacity)!=null?rt:xt._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(ht(this,O,ee).call(this),ht(this,X,ne).call(this)),this.isAttachedToDOM||(this.parent.add(this),ht(this,i,Yt).call(this)),ht(this,Tt,Kt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,P(this,m).disconnect(),mt(this,m,null),super.remove())}enableEditMode(){P(this,n)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",P(this,t)),this.canvas.addEventListener("pointerup",P(this,o)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",P(this,t)),this.canvas.removeEventListener("pointerup",P(this,o)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){P(this,n)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),mt(this,n,!0),this.div.classList.add("disabled"),ht(this,Tt,Kt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(rt){super.focusin(rt),this.enableEditMode()}canvasPointerdown(rt){rt.button!==0||!this.isInEditMode()||P(this,n)||(this.setInForeground(),rt.type!=="mouse"&&this.div.focus(),rt.stopPropagation(),this.canvas.addEventListener("pointerleave",P(this,y)),this.canvas.addEventListener("pointermove",P(this,b)),ht(this,q,qe).call(this,rt.offsetX,rt.offsetY))}canvasPointermove(rt){rt.stopPropagation(),ht(this,et,He).call(this,rt.offsetX,rt.offsetY)}canvasPointerup(rt){rt.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(rt.stopPropagation(),ht(this,T,Ae).call(this,rt),this.setInBackground())}canvasPointerleave(rt){ht(this,T,Ae).call(this,rt),this.setInBackground()}render(){if(this.div)return this.div;let rt,pt;this.width&&(rt=this.x,pt=this.y),super.render(),xt._l10nPromise.get("editor_ink_aria_label").then(_t=>{var yt;return(yt=this.div)==null?void 0:yt.setAttribute("aria-label",_t)});const[V,U,B,gt]=ht(this,st,We).call(this);if(this.setAt(V,U,0,0),this.setDims(B,gt),ht(this,O,ee).call(this),this.width){const[_t,yt]=this.parent.viewportBaseDimensions;this.setAt(rt*_t,pt*yt,this.width*_t,this.height*yt),mt(this,r,!0),ht(this,i,Yt).call(this),this.setDims(this.width*_t,this.height*yt),ht(this,c,Gt).call(this),ht(this,Ft,Ee).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ht(this,X,ne).call(this),this.div}setDimensions(rt,pt){const V=Math.round(rt),U=Math.round(pt);if(P(this,a)===V&&P(this,e)===U)return;mt(this,a,V),mt(this,e,U),this.canvas.style.visibility="hidden",P(this,f)&&Math.abs(P(this,f)-rt/pt)>.01&&(pt=Math.ceil(rt/P(this,f)),this.setDims(rt,pt));const[B,gt]=this.parent.viewportBaseDimensions;this.width=rt/B,this.height=pt/gt,P(this,n)&&ht(this,_,ye).call(this,rt,pt),ht(this,i,Yt).call(this),ht(this,c,Gt).call(this),this.canvas.style.visibility="visible"}static deserialize(rt,pt){var Dt,kt;const V=super.deserialize(rt,pt);V.thickness=rt.thickness,V.color=S.Util.makeHexColor(...rt.color),V.opacity=rt.opacity;const[U,B]=pt.pageDimensions,gt=V.width*U,_t=V.height*B,yt=pt.scaleFactor,St=rt.thickness/2;mt(V,f,gt/_t),mt(V,n,!0),mt(V,a,Math.round(gt)),mt(V,e,Math.round(_t));for(const{bezier:Ct}of rt.paths){const Lt=[];V.paths.push(Lt);let It=yt*(Ct[0]-St),Ut=yt*(_t-Ct[1]-St);for(let Nt=2,Wt=Ct.length;Nt<Wt;Nt+=6){const zt=yt*(Ct[Nt]-St),Vt=yt*(_t-Ct[Nt+1]-St),Ht=yt*(Ct[Nt+2]-St),jt=yt*(_t-Ct[Nt+3]-St),qt=yt*(Ct[Nt+4]-St),$t=yt*(_t-Ct[Nt+5]-St);Lt.push([[It,Ut],[zt,Vt],[Ht,jt],[qt,$t]]),It=qt,Ut=$t}const Pt=ht(this,nt,ve).call(this,Lt);V.bezierPath2D.push(Pt)}const wt=ht(Dt=V,ut,Se).call(Dt);return mt(V,F,Math.max(tt,wt[2]-wt[0])),mt(V,E,Math.max(tt,wt[3]-wt[1])),ht(kt=V,_,ye).call(kt,gt,_t),V}serialize(){if(this.isEmpty())return null;const rt=this.getRect(0,0),pt=this.rotation%180===0?rt[3]-rt[1]:rt[2]-rt[0],V=C.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:S.AnnotationEditorType.INK,color:V,thickness:this.thickness,opacity:this.opacity,paths:ht(this,K,Xe).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,pt),pageIndex:this.parent.pageIndex,rect:rt,rotation:this.rotation}}};let N=xt;f=new WeakMap,E=new WeakMap,F=new WeakMap,b=new WeakMap,y=new WeakMap,o=new WeakMap,t=new WeakMap,n=new WeakMap,r=new WeakMap,g=new WeakMap,m=new WeakMap,a=new WeakMap,e=new WeakMap,s=new WeakMap,d=new WeakSet,je=function(rt){const pt=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=rt,ht(this,Tt,Kt).call(this)},undo:()=>{this.thickness=pt,ht(this,Tt,Kt).call(this)},mustExec:!0,type:S.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},A=new WeakSet,Ue=function(rt){const pt=this.color;this.parent.addCommands({cmd:()=>{this.color=rt,ht(this,c,Gt).call(this)},undo:()=>{this.color=pt,ht(this,c,Gt).call(this)},mustExec:!0,type:S.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},w=new WeakSet,Be=function(rt){rt/=100;const pt=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=rt,ht(this,c,Gt).call(this)},undo:()=>{this.opacity=pt,ht(this,c,Gt).call(this)},mustExec:!0,type:S.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},st=new WeakSet,We=function(){const{width:rt,height:pt,rotation:V}=this.parent.viewport;switch(V){case 90:return[0,rt,rt,pt];case 180:return[rt,pt,rt,pt];case 270:return[pt,0,rt,pt];default:return[0,0,rt,pt]}},z=new WeakSet,be=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,W.opacityToHex)(this.opacity)}`},q=new WeakSet,qe=function(rt,pt){var V;this.isEditing=!0,P(this,r)||(mt(this,r,!0),ht(this,i,Yt).call(this),this.thickness||(this.thickness=xt._defaultThickness),this.color||(this.color=xt._defaultColor||C.AnnotationEditor._defaultLineColor),(V=this.opacity)!=null||(this.opacity=xt._defaultOpacity)),this.currentPath.push([rt,pt]),mt(this,g,null),ht(this,z,be).call(this),this.ctx.beginPath(),this.ctx.moveTo(rt,pt),mt(this,s,()=>{!P(this,s)||(P(this,g)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):ht(this,c,Gt).call(this),this.ctx.lineTo(...P(this,g)),mt(this,g,null),this.ctx.stroke()),window.requestAnimationFrame(P(this,s)))}),window.requestAnimationFrame(P(this,s))},et=new WeakSet,He=function(rt,pt){const[V,U]=this.currentPath.at(-1);rt===V&&pt===U||(this.currentPath.push([rt,pt]),mt(this,g,[rt,pt]))},bt=new WeakSet,Ge=function(rt,pt){var St;this.ctx.closePath(),mt(this,s,null),rt=Math.min(Math.max(rt,0),this.canvas.width),pt=Math.min(Math.max(pt,0),this.canvas.height);const[V,U]=this.currentPath.at(-1);(rt!==V||pt!==U)&&this.currentPath.push([rt,pt]);let B;if(this.currentPath.length!==1)B=(0,Q.fitCurve)(this.currentPath,30,null);else{const wt=[rt,pt];B=[[wt,wt.slice(),wt.slice(),wt]]}const gt=ht(St=xt,nt,ve).call(St,B);this.currentPath.length=0;const _t=()=>{this.paths.push(B),this.bezierPath2D.push(gt),this.rebuild()},yt=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ht(this,O,ee).call(this),ht(this,X,ne).call(this)),ht(this,Tt,Kt).call(this))};this.parent.addCommands({cmd:_t,undo:yt,mustExec:!0})},c=new WeakSet,Gt=function(){if(this.isEmpty()){ht(this,k,se).call(this);return}ht(this,z,be).call(this);const{canvas:rt,ctx:pt}=this;pt.setTransform(1,0,0,1,0,0),pt.clearRect(0,0,rt.width,rt.height),ht(this,k,se).call(this);for(const V of this.bezierPath2D)pt.stroke(V)},T=new WeakSet,Ae=function(rt){ht(this,bt,Ge).call(this,rt.offsetX,rt.offsetY),this.canvas.removeEventListener("pointerleave",P(this,y)),this.canvas.removeEventListener("pointermove",P(this,b)),this.parent.addToAnnotationStorage(this)},O=new WeakSet,ee=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",xt._l10nPromise.get("editor_ink_canvas_aria_label").then(rt=>{var pt;return(pt=this.canvas)==null?void 0:pt.setAttribute("aria-label",rt)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},X=new WeakSet,ne=function(){mt(this,m,new ResizeObserver(rt=>{const pt=rt[0].contentRect;pt.width&&pt.height&&this.setDimensions(pt.width,pt.height)})),P(this,m).observe(this.div)},i=new WeakSet,Yt=function(){if(!P(this,r))return;const[rt,pt]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*rt),this.canvas.height=Math.ceil(this.height*pt),ht(this,k,se).call(this)},_=new WeakSet,ye=function(rt,pt){const V=ht(this,vt,ie).call(this),U=(rt-V)/P(this,F),B=(pt-V)/P(this,E);this.scaleFactor=Math.min(U,B)},k=new WeakSet,se=function(){const rt=ht(this,vt,ie).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+rt,this.translationY*this.scaleFactor+rt)},nt=new WeakSet,ve=function(rt){const pt=new Path2D;for(let V=0,U=rt.length;V<U;V++){const[B,gt,_t,yt]=rt[V];V===0&&pt.moveTo(...B),pt.bezierCurveTo(gt[0],gt[1],_t[0],_t[1],yt[0],yt[1])}return pt},K=new WeakSet,Xe=function(rt,pt,V,U){const gt=[],_t=this.thickness/2;let yt,St;for(const wt of this.paths){yt=[],St=[];for(let Dt=0,kt=wt.length;Dt<kt;Dt++){const[Ct,Lt,It,Ut]=wt[Dt],Pt=rt*(Ct[0]+pt)+_t,Nt=U-rt*(Ct[1]+V)-_t,Wt=rt*(Lt[0]+pt)+_t,zt=U-rt*(Lt[1]+V)-_t,Vt=rt*(It[0]+pt)+_t,Ht=U-rt*(It[1]+V)-_t,jt=rt*(Ut[0]+pt)+_t,qt=U-rt*(Ut[1]+V)-_t;Dt===0&&(yt.push(Pt,Nt),St.push(Pt,Nt)),yt.push(Wt,zt,Vt,Ht,jt,qt),ht(this,Z,ze).call(this,Pt,Nt,Wt,zt,Vt,Ht,jt,qt,4,St)}gt.push({bezier:yt,points:St})}return gt},Z=new WeakSet,ze=function(rt,pt,V,U,B,gt,_t,yt,St,wt){if(ht(this,ft,Ve).call(this,rt,pt,V,U,B,gt,_t,yt)){wt.push(_t,yt);return}for(let Dt=1;Dt<St-1;Dt++){const kt=Dt/St,Ct=1-kt;let Lt=kt*rt+Ct*V,It=kt*pt+Ct*U,Ut=kt*V+Ct*B,Pt=kt*U+Ct*gt;const Nt=kt*B+Ct*_t,Wt=kt*gt+Ct*yt;Lt=kt*Lt+Ct*Ut,It=kt*It+Ct*Pt,Ut=kt*Ut+Ct*Nt,Pt=kt*Pt+Ct*Wt,Lt=kt*Lt+Ct*Ut,It=kt*It+Ct*Pt,wt.push(Lt,It)}wt.push(_t,yt)},ft=new WeakSet,Ve=function(rt,pt,V,U,B,gt,_t,yt){const wt=(3*V-2*rt-_t)**2,Dt=(3*U-2*pt-yt)**2,kt=(3*B-rt-2*_t)**2,Ct=(3*gt-pt-2*yt)**2;return Math.max(wt,kt)+Math.max(Dt,Ct)<=10},ut=new WeakSet,Se=function(){let rt=1/0,pt=-1/0,V=1/0,U=-1/0;for(const B of this.paths)for(const[gt,_t,yt,St]of B){const wt=S.Util.bezierBoundingBox(...gt,..._t,...yt,...St);rt=Math.min(rt,wt[0]),V=Math.min(V,wt[1]),pt=Math.max(pt,wt[2]),U=Math.max(U,wt[3])}return[rt,V,pt,U]},vt=new WeakSet,ie=function(){return P(this,n)?Math.ceil(this.thickness*this.parent.scaleFactor):0},Tt=new WeakSet,Kt=function(rt=!1){if(this.isEmpty())return;if(!P(this,n)){ht(this,c,Gt).call(this);return}const pt=ht(this,ut,Se).call(this),V=ht(this,vt,ie).call(this);mt(this,F,Math.max(tt,pt[2]-pt[0])),mt(this,E,Math.max(tt,pt[3]-pt[1]));const U=Math.ceil(V+P(this,F)*this.scaleFactor),B=Math.ceil(V+P(this,E)*this.scaleFactor),[gt,_t]=this.parent.viewportBaseDimensions;this.width=U/gt,this.height=B/_t,mt(this,f,U/B),ht(this,Ft,Ee).call(this);const yt=this.translationX,St=this.translationY;this.translationX=-pt[0],this.translationY=-pt[1],ht(this,i,Yt).call(this),ht(this,c,Gt).call(this),mt(this,a,U),mt(this,e,B),this.setDims(U,B);const wt=rt?V/this.scaleFactor/2:0;this.translate(yt-this.translationX-wt,St-this.translationY-wt)},Ft=new WeakSet,Ee=function(){const{style:rt}=this.div;P(this,f)>=1?(rt.minHeight=`${tt}px`,rt.minWidth=`${Math.round(P(this,f)*tt)}px`):(rt.minWidth=`${tt}px`,rt.minHeight=`${Math.round(tt/P(this,f))}px`)},at(N,nt),Mt(N,"_defaultColor",null),Mt(N,"_defaultOpacity",1),Mt(N,"_defaultThickness",1),Mt(N,"_l10nPromise"),Mt(N,"_type","ink"),p.InkEditor=N},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.fitCurve=void 0;const S=$(26);p.fitCurve=S},it=>{function p(o,t,n){if(!Array.isArray(o))throw new TypeError("First argument should be an array");if(o.forEach(a=>{if(!Array.isArray(a)||a.some(e=>typeof e!="number")||a.length!==o[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),o=o.filter((a,e)=>e===0||!a.every((s,d)=>s===o[e-1][d])),o.length<2)return[];const r=o.length,g=F(o[1],o[0]),m=F(o[r-2],o[r-1]);return $(o,g,m,t,n)}function $(o,t,n,r,g){var a,e,s,d,x,A,u,w,J,st,Y,z,j;if(o.length===2)return z=b.vectorLen(b.subtract(o[0],o[1]))/3,a=[o[0],b.addArrays(o[0],b.mulItems(t,z)),b.addArrays(o[1],b.mulItems(n,z)),o[1]],[a];if(e=tt(o),[a,d,A]=S(o,e,e,t,n,g),d===0||d<r)return[a];if(d<r*r)for(s=e,x=d,u=A,j=0;j<20;j++){if(s=Q(a,o,s),[a,d,A]=S(o,e,s,t,n,g),d<r)return[a];if(A===u){let q=d/x;if(q>.9999&&q<1.0001)break}x=d,u=A}return Y=[],w=b.subtract(o[A-1],o[A+1]),w.every(q=>q===0)&&(w=b.subtract(o[A-1],o[A]),[w[0],w[1]]=[-w[1],w[0]]),J=b.normalize(w),st=b.mulItems(J,-1),Y=Y.concat($(o.slice(0,A+1),t,J,r,g)),Y=Y.concat($(o.slice(A),st,n,r,g)),Y}function S(o,t,n,r,g,m){var a,e,s;return a=C(o,n,r,g),[e,s]=N(o,a,t),m&&m({bez:a,points:o,params:t,maxErr:e,maxPoint:s}),[a,e,s]}function C(o,t,n,r){var g,m,a,e,s,d,x,A,u,w,J,st,Y,z,j,q,G,et=o[0],ct=o[o.length-1];for(g=[et,null,null,ct],m=b.zeros_Xx2x2(t.length),Y=0,z=t.length;Y<z;Y++)q=t[Y],G=1-q,a=m[Y],a[0]=b.mulItems(n,3*q*(G*G)),a[1]=b.mulItems(r,3*G*(q*q));for(e=[[0,0],[0,0]],s=[0,0],Y=0,z=o.length;Y<z;Y++)q=t[Y],a=m[Y],e[0][0]+=b.dot(a[0],a[0]),e[0][1]+=b.dot(a[0],a[1]),e[1][0]+=b.dot(a[0],a[1]),e[1][1]+=b.dot(a[1],a[1]),j=b.subtract(o[Y],y.q([et,et,ct,ct],q)),s[0]+=b.dot(a[0],j),s[1]+=b.dot(a[1],j);return d=e[0][0]*e[1][1]-e[1][0]*e[0][1],x=e[0][0]*s[1]-e[1][0]*s[0],A=s[0]*e[1][1]-s[1]*e[0][1],u=d===0?0:A/d,w=d===0?0:x/d,st=b.vectorLen(b.subtract(et,ct)),J=1e-6*st,u<J||w<J?(g[1]=b.addArrays(et,b.mulItems(n,st/3)),g[2]=b.addArrays(ct,b.mulItems(r,st/3))):(g[1]=b.addArrays(et,b.mulItems(n,u)),g[2]=b.addArrays(ct,b.mulItems(r,w))),g}function Q(o,t,n){return n.map((r,g)=>W(o,t[g],r))}function W(o,t,n){var r=b.subtract(y.q(o,n),t),g=y.qprime(o,n),m=b.mulMatrix(r,g),a=b.sum(b.squareItems(g))+2*b.mulMatrix(r,y.qprimeprime(o,n));return a===0?n:n-m/a}function tt(o){var t=[],n,r,g;return o.forEach((m,a)=>{n=a?r+b.vectorLen(b.subtract(m,g)):0,t.push(n),r=n,g=m}),t=t.map(m=>m/r),t}function N(o,t,n){var r,g,m,a,e,s,d,x;g=0,m=Math.floor(o.length/2);const A=f(t,10);for(e=0,s=o.length;e<s;e++)d=o[e],x=E(t,n[e],A,10),a=b.subtract(y.q(t,x),d),r=a[0]*a[0]+a[1]*a[1],r>g&&(g=r,m=e);return[g,m]}var f=function(o,t){for(var n,r=[0],g=o[0],m=0,a=1;a<=t;a++)n=y.q(o,a/t),m+=b.vectorLen(b.subtract(n,g)),r.push(m),g=n;return r=r.map(e=>e/m),r};function E(o,t,n,r){if(t<0)return 0;if(t>1)return 1;for(var g,m,a,e,s,d=1;d<=r;d++)if(t<=n[d]){e=(d-1)/r,a=d/r,m=n[d-1],g=n[d],s=(t-m)/(g-m)*(a-e)+e;break}return s}function F(o,t){return b.normalize(b.subtract(o,t))}class b{static zeros_Xx2x2(t){for(var n=[];t--;)n.push([0,0]);return n}static mulItems(t,n){return t.map(r=>r*n)}static mulMatrix(t,n){return t.reduce((r,g,m)=>r+g*n[m],0)}static subtract(t,n){return t.map((r,g)=>r-n[g])}static addArrays(t,n){return t.map((r,g)=>r+n[g])}static addItems(t,n){return t.map(r=>r+n)}static sum(t){return t.reduce((n,r)=>n+r)}static dot(t,n){return b.mulMatrix(t,n)}static vectorLen(t){return Math.hypot(...t)}static divItems(t,n){return t.map(r=>r/n)}static squareItems(t){return t.map(n=>n*n)}static normalize(t){return this.divItems(t,this.vectorLen(t))}}class y{static q(t,n){var r=1-n,g=b.mulItems(t[0],r*r*r),m=b.mulItems(t[1],3*r*r*n),a=b.mulItems(t[2],3*r*n*n),e=b.mulItems(t[3],n*n*n);return b.addArrays(b.addArrays(g,m),b.addArrays(a,e))}static qprime(t,n){var r=1-n,g=b.mulItems(b.subtract(t[1],t[0]),3*r*r),m=b.mulItems(b.subtract(t[2],t[1]),6*r*n),a=b.mulItems(b.subtract(t[3],t[2]),3*n*n);return b.addArrays(b.addArrays(g,m),a)}static qprimeprime(t,n){return b.addArrays(b.mulItems(b.addArrays(b.subtract(t[2],b.mulItems(t[1],2)),t[0]),6*(1-n)),b.mulItems(b.addArrays(b.subtract(t[3],b.mulItems(t[2],2)),t[1]),6*n))}}it.exports=p,it.exports.fitCubic=$,it.exports.createTangent=F},(it,p,$)=>{var c,Ce,T,Te,O,xe;Object.defineProperty(p,"__esModule",{value:!0}),p.AnnotationLayer=void 0;var S=$(1),C=$(8),Q=$(5),W=$(28),tt=$(29);const N=1e3,f=9,E=new WeakSet;function F(H){return{width:H[2]-H[0],height:H[3]-H[1]}}class b{static create(i){switch(i.data.annotationType){case S.AnnotationType.LINK:return new o(i);case S.AnnotationType.TEXT:return new t(i);case S.AnnotationType.WIDGET:switch(i.data.fieldType){case"Tx":return new r(i);case"Btn":return i.data.radioButton?new m(i):i.data.checkBox?new g(i):new a(i);case"Ch":return new e(i)}return new n(i);case S.AnnotationType.POPUP:return new s(i);case S.AnnotationType.FREETEXT:return new x(i);case S.AnnotationType.LINE:return new A(i);case S.AnnotationType.SQUARE:return new u(i);case S.AnnotationType.CIRCLE:return new w(i);case S.AnnotationType.POLYLINE:return new J(i);case S.AnnotationType.CARET:return new Y(i);case S.AnnotationType.INK:return new z(i);case S.AnnotationType.POLYGON:return new st(i);case S.AnnotationType.HIGHLIGHT:return new j(i);case S.AnnotationType.UNDERLINE:return new q(i);case S.AnnotationType.SQUIGGLY:return new G(i);case S.AnnotationType.STRIKEOUT:return new et(i);case S.AnnotationType.STAMP:return new ct(i);case S.AnnotationType.FILEATTACHMENT:return new bt(i);default:return new y(i)}}}class y{constructor(i,{isRenderable:h=!1,ignoreBorder:_=!1,createQuadrilaterals:v=!1}={}){this.isRenderable=h,this.data=i.data,this.layer=i.layer,this.page=i.page,this.viewport=i.viewport,this.linkService=i.linkService,this.downloadManager=i.downloadManager,this.imageResourcesPath=i.imageResourcesPath,this.renderForms=i.renderForms,this.svgFactory=i.svgFactory,this.annotationStorage=i.annotationStorage,this.enableScripting=i.enableScripting,this.hasJSActions=i.hasJSActions,this._fieldObjects=i.fieldObjects,this._mouseState=i.mouseState,h&&(this.container=this._createContainer(_)),v&&(this.quadrilaterals=this._createQuadrilaterals(_))}_createContainer(i=!1){const h=this.data,_=this.page,v=this.viewport,k=document.createElement("section"),{width:L,height:nt}=F(h.rect),[dt,K,ot,Z]=v.viewBox,lt=ot-dt,ft=Z-K;k.setAttribute("data-annotation-id",h.id);const R=S.Util.normalizeRect([h.rect[0],_.view[3]-h.rect[1]+_.view[1],h.rect[2],_.view[3]-h.rect[3]+_.view[1]]);if(!i&&h.borderStyle.width>0){k.style.borderWidth=`${h.borderStyle.width}px`;const At=h.borderStyle.horizontalCornerRadius,vt=h.borderStyle.verticalCornerRadius;if(At>0||vt>0){const Tt=`calc(${At}px * var(--scale-factor)) / calc(${vt}px * var(--scale-factor))`;k.style.borderRadius=Tt}else if(this instanceof m){const Tt=`calc(${L}px * var(--scale-factor)) / calc(${nt}px * var(--scale-factor))`;k.style.borderRadius=Tt}switch(h.borderStyle.style){case S.AnnotationBorderStyleType.SOLID:k.style.borderStyle="solid";break;case S.AnnotationBorderStyleType.DASHED:k.style.borderStyle="dashed";break;case S.AnnotationBorderStyleType.BEVELED:(0,S.warn)("Unimplemented border style: beveled");break;case S.AnnotationBorderStyleType.INSET:(0,S.warn)("Unimplemented border style: inset");break;case S.AnnotationBorderStyleType.UNDERLINE:k.style.borderBottomStyle="solid";break}const Et=h.borderColor||null;Et?k.style.borderColor=S.Util.makeHexColor(Et[0]|0,Et[1]|0,Et[2]|0):k.style.borderWidth=0}k.style.left=`${100*(R[0]-dt)/lt}%`,k.style.top=`${100*(R[1]-K)/ft}%`;const{rotation:ut}=h;return h.hasOwnCanvas||ut===0?(k.style.width=`${100*L/lt}%`,k.style.height=`${100*nt/ft}%`):this.setRotation(ut,k),k}setRotation(i,h=this.container){const[_,v,k,L]=this.viewport.viewBox,nt=k-_,dt=L-v,{width:K,height:ot}=F(this.data.rect);let Z,lt;i%180===0?(Z=100*K/nt,lt=100*ot/dt):(Z=100*ot/nt,lt=100*K/dt),h.style.width=`${Z}%`,h.style.height=`${lt}%`,h.setAttribute("data-main-rotation",(360-i)%360)}get _commonActions(){const i=(h,_,v)=>{const k=v.detail[h];v.target.style[_]=W.ColorConverters[`${k[0]}_HTML`](k.slice(1))};return(0,S.shadow)(this,"_commonActions",{display:h=>{const _=h.detail.display%2===1;this.container.style.visibility=_?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:_,print:h.detail.display===0||h.detail.display===3})},print:h=>{this.annotationStorage.setValue(this.data.id,{print:h.detail.print})},hidden:h=>{this.container.style.visibility=h.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:h.detail.hidden})},focus:h=>{setTimeout(()=>h.target.focus({preventScroll:!1}),0)},userName:h=>{h.target.title=h.detail.userName},readonly:h=>{h.detail.readonly?h.target.setAttribute("readonly",""):h.target.removeAttribute("readonly")},required:h=>{this._setRequired(h.target,h.detail.required)},bgColor:h=>{i("bgColor","backgroundColor",h)},fillColor:h=>{i("fillColor","backgroundColor",h)},fgColor:h=>{i("fgColor","color",h)},textColor:h=>{i("textColor","color",h)},borderColor:h=>{i("borderColor","borderColor",h)},strokeColor:h=>{i("strokeColor","borderColor",h)},rotation:h=>{const _=h.detail.rotation;this.setRotation(_),this.annotationStorage.setValue(this.data.id,{rotation:_})}})}_dispatchEventFromSandbox(i,h){const _=this._commonActions;for(const v of Object.keys(h.detail)){const k=i[v]||_[v];k&&k(h)}}_setDefaultPropertiesFromJS(i){if(!this.enableScripting)return;const h=this.annotationStorage.getRawValue(this.data.id);if(!h)return;const _=this._commonActions;for(const[v,k]of Object.entries(h)){const L=_[v];if(L){const nt={detail:{[v]:k},target:i};L(nt),delete h[v]}}}_createQuadrilaterals(i=!1){if(!this.data.quadPoints)return null;const h=[],_=this.data.rect;for(const v of this.data.quadPoints)this.data.rect=[v[2].x,v[2].y,v[1].x,v[1].y],h.push(this._createContainer(i));return this.data.rect=_,h}_createPopup(i,h){let _=this.container;this.quadrilaterals&&(i=i||this.quadrilaterals,_=this.quadrilaterals[0]),i||(i=document.createElement("div"),i.className="popupTriggerArea",_.append(i));const k=new d({container:_,trigger:i,color:h.color,titleObj:h.titleObj,modificationDate:h.modificationDate,contentsObj:h.contentsObj,richText:h.richText,hideWrapper:!0}).render();k.style.left="100%",_.append(k)}_renderQuadrilaterals(i){for(const h of this.quadrilaterals)h.className=i;return this.quadrilaterals}render(){(0,S.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(i,h=null){const _=[];if(this._fieldObjects){const v=this._fieldObjects[i];if(v)for(const{page:k,id:L,exportValues:nt}of v){if(k===-1||L===h)continue;const dt=typeof nt=="string"?nt:null,K=document.querySelector(`[data-element-id="${L}"]`);if(K&&!E.has(K)){(0,S.warn)(`_getElementsByName - element not allowed: ${L}`);continue}_.push({id:L,exportValue:dt,domElement:K})}return _}for(const v of document.getElementsByName(i)){const{id:k,exportValue:L}=v;k!==h&&(!E.has(v)||_.push({id:k,exportValue:L,domElement:v}))}return _}static get platform(){const i=typeof navigator!="undefined"?navigator.platform:"";return(0,S.shadow)(this,"platform",{isWin:i.includes("Win"),isMac:i.includes("Mac")})}}class o extends y{constructor(i,h=null){super(i,{isRenderable:!0,ignoreBorder:!!(h!=null&&h.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=i.data.isTooltipOnly}render(){const{data:i,linkService:h}=this,_=document.createElement("a");_.setAttribute("data-element-id",i.id);let v=!1;return i.url?(h.addLinkAttributes(_,i.url,i.newWindow),v=!0):i.action?(this._bindNamedAction(_,i.action),v=!0):i.dest?(this._bindLink(_,i.dest),v=!0):(i.actions&&(i.actions.Action||i.actions["Mouse Up"]||i.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(_,i),v=!0),i.resetForm?(this._bindResetFormAction(_,i.resetForm),v=!0):this.isTooltipOnly&&!v&&(this._bindLink(_,""),v=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((k,L)=>{const nt=L===0?_:_.cloneNode();return k.append(nt),k}):(this.container.className="linkAnnotation",v&&this.container.append(_),this.container)}_bindLink(i,h){i.href=this.linkService.getDestinationHash(h),i.onclick=()=>(h&&this.linkService.goToDestination(h),!1),(h||h==="")&&(i.className="internalLink")}_bindNamedAction(i,h){i.href=this.linkService.getAnchorUrl(""),i.onclick=()=>(this.linkService.executeNamedAction(h),!1),i.className="internalLink"}_bindJSAction(i,h){i.href=this.linkService.getAnchorUrl("");const _=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const v of Object.keys(h.actions)){const k=_.get(v);!k||(i[k]=()=>{var L;return(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h.id,name:v}}),!1})}i.onclick||(i.onclick=()=>!1),i.className="internalLink"}_bindResetFormAction(i,h){const _=i.onclick;if(_||(i.href=this.linkService.getAnchorUrl("")),i.className="internalLink",!this._fieldObjects){(0,S.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),_||(i.onclick=()=>!1);return}i.onclick=()=>{var ot;_&&_();const{fields:v,refs:k,include:L}=h,nt=[];if(v.length!==0||k.length!==0){const Z=new Set(k);for(const lt of v){const ft=this._fieldObjects[lt]||[];for(const{id:R}of ft)Z.add(R)}for(const lt of Object.values(this._fieldObjects))for(const ft of lt)Z.has(ft.id)===L&&nt.push(ft)}else for(const Z of Object.values(this._fieldObjects))nt.push(...Z);const dt=this.annotationStorage,K=[];for(const Z of nt){const{id:lt}=Z;switch(K.push(lt),Z.type){case"text":{const R=Z.defaultValue||"";dt.setValue(lt,{value:R});break}case"checkbox":case"radiobutton":{const R=Z.defaultValue===Z.exportValues;dt.setValue(lt,{value:R});break}case"combobox":case"listbox":{const R=Z.defaultValue||"";dt.setValue(lt,{value:R});break}default:continue}const ft=document.querySelector(`[data-element-id="${lt}"]`);if(ft){if(!E.has(ft)){(0,S.warn)(`_bindResetFormAction - element not allowed: ${lt}`);continue}}else continue;ft.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((ot=this.linkService.eventBus)==null||ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:K,name:"ResetForm"}})),!1}}}class t extends y{constructor(i){var _,v,k;const h=!!(i.data.hasPopup||((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h})}render(){this.container.className="textAnnotation";const i=document.createElement("img");return i.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",i.alt="[{{type}} Annotation]",i.dataset.l10nId="text_annotation_type",i.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(i,this.data),this.container.append(i),this.container}}class n extends y{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(i){const{isWin:h,isMac:_}=y.platform;return h&&i.ctrlKey||_&&i.metaKey}_setEventListener(i,h,_,v){h.includes("mouse")?i.addEventListener(h,k=>{var L;(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:_,value:v(k),shift:k.shiftKey,modifier:this._getKeyModifier(k)}})}):i.addEventListener(h,k=>{var L;(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:_,value:v(k)}})})}_setEventListeners(i,h,_){var v;for(const[k,L]of h)(L==="Action"||((v=this.data.actions)==null?void 0:v[L]))&&this._setEventListener(i,k,L,_)}_setBackgroundColor(i){const h=this.data.backgroundColor||null;i.style.backgroundColor=h===null?"transparent":S.Util.makeHexColor(h[0],h[1],h[2])}_setTextStyle(i){const h=["left","center","right"],{fontColor:_}=this.data.defaultAppearanceData,v=this.data.defaultAppearanceData.fontSize||f,k=i.style;let L;if(this.data.multiLine){const nt=Math.abs(this.data.rect[3]-this.data.rect[1]),dt=Math.round(nt/(S.LINE_FACTOR*v))||1,K=nt/dt;L=Math.min(v,Math.round(K/S.LINE_FACTOR))}else{const nt=Math.abs(this.data.rect[3]-this.data.rect[1]);L=Math.min(v,Math.round(nt/S.LINE_FACTOR))}k.fontSize=`calc(${L}px * var(--scale-factor))`,k.color=S.Util.makeHexColor(_[0],_[1],_[2]),this.data.textAlignment!==null&&(k.textAlign=h[this.data.textAlignment])}_setRequired(i,h){h?i.setAttribute("required",!0):i.removeAttribute("required"),i.setAttribute("aria-required",h)}}class r extends n{constructor(i){const h=i.renderForms||!i.data.hasAppearance&&!!i.data.fieldValue;super(i,{isRenderable:h})}setPropertyOnSiblings(i,h,_,v){const k=this.annotationStorage;for(const L of this._getElementsByName(i.name,i.id))L.domElement&&(L.domElement[h]=_),k.setValue(L.id,{[v]:_})}render(){var v;const i=this.annotationStorage,h=this.data.id;this.container.className="textWidgetAnnotation";let _=null;if(this.renderForms){const k=i.getValue(h,{value:this.data.fieldValue});let L=k.formattedValue||k.value||"";const nt=i.getValue(h,{charLimit:this.data.maxLen}).charLimit;nt&&L.length>nt&&(L=L.slice(0,nt));const dt={userValue:L,formattedValue:null,valueOnFocus:""};this.data.multiLine?(_=document.createElement("textarea"),_.textContent=L,this.data.doNotScroll&&(_.style.overflowY="hidden")):(_=document.createElement("input"),_.type="text",_.setAttribute("value",L),this.data.doNotScroll&&(_.style.overflowX="hidden")),E.add(_),_.setAttribute("data-element-id",h),_.disabled=this.data.readOnly,_.name=this.data.fieldName,_.tabIndex=N,this._setRequired(_,this.data.required),nt&&(_.maxLength=nt),_.addEventListener("input",ot=>{i.setValue(h,{value:ot.target.value}),this.setPropertyOnSiblings(_,"value",ot.target.value,"value")}),_.addEventListener("resetform",ot=>{var lt;const Z=(lt=this.data.defaultFieldValue)!=null?lt:"";_.value=dt.userValue=Z,dt.formattedValue=null});let K=ot=>{const{formattedValue:Z}=dt;Z!=null&&(ot.target.value=Z),ot.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){_.addEventListener("focus",Z=>{dt.userValue&&(Z.target.value=dt.userValue),dt.valueOnFocus=Z.target.value}),_.addEventListener("updatefromsandbox",Z=>{const lt={value(ft){var R;dt.userValue=(R=ft.detail.value)!=null?R:"",i.setValue(h,{value:dt.userValue.toString()}),ft.target.value=dt.userValue},formattedValue(ft){const{formattedValue:R}=ft.detail;dt.formattedValue=R,R!=null&&ft.target!==document.activeElement&&(ft.target.value=R),i.setValue(h,{formattedValue:R})},selRange(ft){ft.target.setSelectionRange(...ft.detail.selRange)},charLimit:ft=>{var vt;const{charLimit:R}=ft.detail,{target:ut}=ft;if(R===0){ut.removeAttribute("maxLength");return}ut.setAttribute("maxLength",R);let At=dt.userValue;!At||At.length<=R||(At=At.slice(0,R),ut.value=dt.userValue=At,i.setValue(h,{value:At}),(vt=this.linkService.eventBus)==null||vt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:At,willCommit:!0,commitKey:1,selStart:ut.selectionStart,selEnd:ut.selectionEnd}}))}};this._dispatchEventFromSandbox(lt,Z)}),_.addEventListener("keydown",Z=>{var R;let lt=-1;if(Z.key==="Escape"?lt=0:Z.key==="Enter"?lt=2:Z.key==="Tab"&&(lt=3),lt===-1)return;const{value:ft}=Z.target;dt.valueOnFocus!==ft&&(dt.userValue=ft,(R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:ft,willCommit:!0,commitKey:lt,selStart:Z.target.selectionStart,selEnd:Z.target.selectionEnd}}))});const ot=K;K=null,_.addEventListener("blur",Z=>{var ft;const{value:lt}=Z.target;dt.userValue=lt,this._mouseState.isDown&&dt.valueOnFocus!==lt&&((ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:lt,willCommit:!0,commitKey:1,selStart:Z.target.selectionStart,selEnd:Z.target.selectionEnd}})),ot(Z)}),(v=this.data.actions)!=null&&v.Keystroke&&_.addEventListener("beforeinput",Z=>{var Tt;const{data:lt,target:ft}=Z,{value:R,selectionStart:ut,selectionEnd:At}=ft;let vt=ut,Et=At;switch(Z.inputType){case"deleteWordBackward":{const Rt=R.substring(0,ut).match(/\w*[^\w]*$/);Rt&&(vt-=Rt[0].length);break}case"deleteWordForward":{const Rt=R.substring(ut).match(/^[^\w]*\w*/);Rt&&(Et+=Rt[0].length);break}case"deleteContentBackward":ut===At&&(vt-=1);break;case"deleteContentForward":ut===At&&(Et+=1);break}Z.preventDefault(),(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:R,change:lt||"",willCommit:!1,selStart:vt,selEnd:Et}})}),this._setEventListeners(_,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Z=>Z.target.value)}if(K&&_.addEventListener("blur",K),this.data.comb){const Z=(this.data.rect[2]-this.data.rect[0])/nt;_.classList.add("comb"),_.style.letterSpacing=`calc(${Z}px * var(--scale-factor) - 1ch)`}}else _=document.createElement("div"),_.textContent=this.data.fieldValue,_.style.verticalAlign="middle",_.style.display="table-cell";return this._setTextStyle(_),this._setBackgroundColor(_),this._setDefaultPropertiesFromJS(_),this.container.append(_),this.container}}class g extends n{constructor(i){super(i,{isRenderable:i.renderForms})}render(){const i=this.annotationStorage,h=this.data,_=h.id;let v=i.getValue(_,{value:h.exportValue===h.fieldValue}).value;typeof v=="string"&&(v=v!=="Off",i.setValue(_,{value:v})),this.container.className="buttonWidgetAnnotation checkBox";const k=document.createElement("input");return E.add(k),k.setAttribute("data-element-id",_),k.disabled=h.readOnly,this._setRequired(k,this.data.required),k.type="checkbox",k.name=h.fieldName,v&&k.setAttribute("checked",!0),k.setAttribute("exportValue",h.exportValue),k.tabIndex=N,k.addEventListener("change",L=>{const{name:nt,checked:dt}=L.target;for(const K of this._getElementsByName(nt,_)){const ot=dt&&K.exportValue===h.exportValue;K.domElement&&(K.domElement.checked=ot),i.setValue(K.id,{value:ot})}i.setValue(_,{value:dt})}),k.addEventListener("resetform",L=>{const nt=h.defaultFieldValue||"Off";L.target.checked=nt===h.exportValue}),this.enableScripting&&this.hasJSActions&&(k.addEventListener("updatefromsandbox",L=>{const nt={value(dt){dt.target.checked=dt.detail.value!=="Off",i.setValue(_,{value:dt.target.checked})}};this._dispatchEventFromSandbox(nt,L)}),this._setEventListeners(k,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],L=>L.target.checked)),this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class m extends n{constructor(i){super(i,{isRenderable:i.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const i=this.annotationStorage,h=this.data,_=h.id;let v=i.getValue(_,{value:h.fieldValue===h.buttonValue}).value;typeof v=="string"&&(v=v!==h.buttonValue,i.setValue(_,{value:v}));const k=document.createElement("input");if(E.add(k),k.setAttribute("data-element-id",_),k.disabled=h.readOnly,this._setRequired(k,this.data.required),k.type="radio",k.name=h.fieldName,v&&k.setAttribute("checked",!0),k.tabIndex=N,k.addEventListener("change",L=>{const{name:nt,checked:dt}=L.target;for(const K of this._getElementsByName(nt,_))i.setValue(K.id,{value:!1});i.setValue(_,{value:dt})}),k.addEventListener("resetform",L=>{const nt=h.defaultFieldValue;L.target.checked=nt!=null&&nt===h.buttonValue}),this.enableScripting&&this.hasJSActions){const L=h.buttonValue;k.addEventListener("updatefromsandbox",nt=>{const dt={value:K=>{const ot=L===K.detail.value;for(const Z of this._getElementsByName(K.target.name)){const lt=ot&&Z.id===_;Z.domElement&&(Z.domElement.checked=lt),i.setValue(Z.id,{value:lt})}}};this._dispatchEventFromSandbox(dt,nt)}),this._setEventListeners(k,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],nt=>nt.target.checked)}return this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class a extends o{constructor(i){super(i,{ignoreBorder:i.data.hasAppearance})}render(){const i=super.render();i.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(i.title=this.data.alternativeText);const h=i.lastChild;return this.enableScripting&&this.hasJSActions&&h&&(this._setDefaultPropertiesFromJS(h),h.addEventListener("updatefromsandbox",_=>{this._dispatchEventFromSandbox({},_)})),i}}class e extends n{constructor(i){super(i,{isRenderable:i.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const i=this.annotationStorage,h=this.data.id,_=i.getValue(h,{value:this.data.fieldValue}),v=document.createElement("select");E.add(v),v.setAttribute("data-element-id",h),v.disabled=this.data.readOnly,this._setRequired(v,this.data.required),v.name=this.data.fieldName,v.tabIndex=N;let k=this.data.combo&&this.data.options.length>0;this.data.combo||(v.size=this.data.options.length,this.data.multiSelect&&(v.multiple=!0)),v.addEventListener("resetform",K=>{const ot=this.data.defaultFieldValue;for(const Z of v.options)Z.selected=Z.value===ot});for(const K of this.data.options){const ot=document.createElement("option");ot.textContent=K.displayValue,ot.value=K.exportValue,_.value.includes(K.exportValue)&&(ot.setAttribute("selected",!0),k=!1),v.append(ot)}let L=null;if(k){const K=document.createElement("option");K.value=" ",K.setAttribute("hidden",!0),K.setAttribute("selected",!0),v.prepend(K),L=()=>{K.remove(),v.removeEventListener("input",L),L=null},v.addEventListener("input",L)}const nt=(K,ot)=>{const Z=ot?"value":"textContent",lt=K.target.options;return K.target.multiple?Array.prototype.filter.call(lt,ft=>ft.selected).map(ft=>ft[Z]):lt.selectedIndex===-1?null:lt[lt.selectedIndex][Z]},dt=K=>{const ot=K.target.options;return Array.prototype.map.call(ot,Z=>({displayValue:Z.textContent,exportValue:Z.value}))};return this.enableScripting&&this.hasJSActions?(v.addEventListener("updatefromsandbox",K=>{const ot={value(Z){L==null||L();const lt=Z.detail.value,ft=new Set(Array.isArray(lt)?lt:[lt]);for(const R of v.options)R.selected=ft.has(R.value);i.setValue(h,{value:nt(Z,!0)})},multipleSelection(Z){v.multiple=!0},remove(Z){const lt=v.options,ft=Z.detail.remove;lt[ft].selected=!1,v.remove(ft),lt.length>0&&Array.prototype.findIndex.call(lt,ut=>ut.selected)===-1&&(lt[0].selected=!0),i.setValue(h,{value:nt(Z,!0),items:dt(Z)})},clear(Z){for(;v.length!==0;)v.remove(0);i.setValue(h,{value:null,items:[]})},insert(Z){const{index:lt,displayValue:ft,exportValue:R}=Z.detail.insert,ut=v.children[lt],At=document.createElement("option");At.textContent=ft,At.value=R,ut?ut.before(At):v.append(At),i.setValue(h,{value:nt(Z,!0),items:dt(Z)})},items(Z){const{items:lt}=Z.detail;for(;v.length!==0;)v.remove(0);for(const ft of lt){const{displayValue:R,exportValue:ut}=ft,At=document.createElement("option");At.textContent=R,At.value=ut,v.append(At)}v.options.length>0&&(v.options[0].selected=!0),i.setValue(h,{value:nt(Z,!0),items:dt(Z)})},indices(Z){const lt=new Set(Z.detail.indices);for(const ft of Z.target.options)ft.selected=lt.has(ft.index);i.setValue(h,{value:nt(Z,!0)})},editable(Z){Z.target.disabled=!Z.detail.editable}};this._dispatchEventFromSandbox(ot,K)}),v.addEventListener("input",K=>{var lt;const ot=nt(K,!0),Z=nt(K,!1);i.setValue(h,{value:ot}),(lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:h,name:"Keystroke",value:Z,changeEx:ot,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(v,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],K=>K.target.checked)):v.addEventListener("input",function(K){i.setValue(h,{value:nt(K,!0)})}),this.data.combo&&this._setTextStyle(v),this._setBackgroundColor(v),this._setDefaultPropertiesFromJS(v),this.container.append(v),this.container}}class s extends y{constructor(i){var _,v,k;const h=!!(((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h})}render(){const i=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",i.includes(this.data.parentType))return this.container;const h=`[data-annotation-id="${this.data.parentId}"]`,_=this.layer.querySelectorAll(h);if(_.length===0)return this.container;const v=new d({container:this.container,trigger:Array.from(_),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),k=this.page,L=S.Util.normalizeRect([this.data.parentRect[0],k.view[3]-this.data.parentRect[1]+k.view[1],this.data.parentRect[2],k.view[3]-this.data.parentRect[3]+k.view[1]]),nt=L[0]+this.data.parentRect[2]-this.data.parentRect[0],dt=L[1],[K,ot,Z,lt]=this.viewport.viewBox,ft=Z-K,R=lt-ot;return this.container.style.left=`${100*(nt-K)/ft}%`,this.container.style.top=`${100*(dt-ot)/R}%`,this.container.append(v.render()),this.container}}class d{constructor(i){this.container=i.container,this.trigger=i.trigger,this.color=i.color,this.titleObj=i.titleObj,this.modificationDate=i.modificationDate,this.contentsObj=i.contentsObj,this.richText=i.richText,this.hideWrapper=i.hideWrapper||!1,this.pinned=!1}render(){var nt,dt;const h=document.createElement("div");h.className="popupWrapper",this.hideElement=this.hideWrapper?h:this.container,this.hideElement.hidden=!0;const _=document.createElement("div");_.className="popup";const v=this.color;if(v){const K=.7*(255-v[0])+v[0],ot=.7*(255-v[1])+v[1],Z=.7*(255-v[2])+v[2];_.style.backgroundColor=S.Util.makeHexColor(K|0,ot|0,Z|0)}const k=document.createElement("h1");k.dir=this.titleObj.dir,k.textContent=this.titleObj.str,_.append(k);const L=C.PDFDateString.toDateObject(this.modificationDate);if(L){const K=document.createElement("span");K.className="popupDate",K.textContent="{{date}}, {{time}}",K.dataset.l10nId="annotation_date_string",K.dataset.l10nArgs=JSON.stringify({date:L.toLocaleDateString(),time:L.toLocaleTimeString()}),_.append(K)}if(((nt=this.richText)==null?void 0:nt.str)&&(!((dt=this.contentsObj)!=null&&dt.str)||this.contentsObj.str===this.richText.str))tt.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:_}),_.lastChild.className="richText popupContent";else{const K=this._formatContents(this.contentsObj);_.append(K)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const K of this.trigger)K.addEventListener("click",this._toggle.bind(this)),K.addEventListener("mouseover",this._show.bind(this,!1)),K.addEventListener("mouseout",this._hide.bind(this,!1));return _.addEventListener("click",this._hide.bind(this,!0)),h.append(_),h}_formatContents({str:i,dir:h}){const _=document.createElement("p");_.className="popupContent",_.dir=h;const v=i.split(/(?:\r\n?|\n)/);for(let k=0,L=v.length;k<L;++k){const nt=v[k];_.append(document.createTextNode(nt)),k<L-1&&_.append(document.createElement("br"))}return _}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(i=!1){i&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(i=!0){i&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class x extends y{constructor(i){var _,v,k;const h=!!(i.data.hasPopup||((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h,ignoreBorder:!0}),this.textContent=i.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const i=document.createElement("div");i.className="annotationTextContent",i.setAttribute("role","comment");for(const h of this.textContent){const _=document.createElement("span");_.textContent=h,i.append(_)}this.container.append(i)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class A extends y{constructor(i){var _,v,k;const h=!!(i.data.hasPopup||((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const i=this.data,{width:h,height:_}=F(i.rect),v=this.svgFactory.create(h,_,!0),k=this.svgFactory.createElement("svg:line");return k.setAttribute("x1",i.rect[2]-i.lineCoordinates[0]),k.setAttribute("y1",i.rect[3]-i.lineCoordinates[1]),k.setAttribute("x2",i.rect[2]-i.lineCoordinates[2]),k.setAttribute("y2",i.rect[3]-i.lineCoordinates[3]),k.setAttribute("stroke-width",i.borderStyle.width||1),k.setAttribute("stroke","transparent"),k.setAttribute("fill","transparent"),v.append(k),this.container.append(v),this._createPopup(k,i),this.container}}class u extends y{constructor(i){var _,v,k;const h=!!(i.data.hasPopup||((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const i=this.data,{width:h,height:_}=F(i.rect),v=this.svgFactory.create(h,_,!0),k=i.borderStyle.width,L=this.svgFactory.createElement("svg:rect");return L.setAttribute("x",k/2),L.setAttribute("y",k/2),L.setAttribute("width",h-k),L.setAttribute("height",_-k),L.setAttribute("stroke-width",k||1),L.setAttribute("stroke","transparent"),L.setAttribute("fill","transparent"),v.append(L),this.container.append(v),this._createPopup(L,i),this.container}}class w extends y{constructor(i){var _,v,k;const h=!!(i.data.hasPopup||((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const i=this.data,{width:h,height:_}=F(i.rect),v=this.svgFactory.create(h,_,!0),k=i.borderStyle.width,L=this.svgFactory.createElement("svg:ellipse");return L.setAttribute("cx",h/2),L.setAttribute("cy",_/2),L.setAttribute("rx",h/2-k/2),L.setAttribute("ry",_/2-k/2),L.setAttribute("stroke-width",k||1),L.setAttribute("stroke","transparent"),L.setAttribute("fill","transparent"),v.append(L),this.container.append(v),this._createPopup(L,i),this.container}}class J extends y{constructor(i){var _,v,k;const h=!!(i.data.hasPopup||((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const i=this.data,{width:h,height:_}=F(i.rect),v=this.svgFactory.create(h,_,!0);let k=[];for(const nt of i.vertices){const dt=nt.x-i.rect[0],K=i.rect[3]-nt.y;k.push(dt+","+K)}k=k.join(" ");const L=this.svgFactory.createElement(this.svgElementName);return L.setAttribute("points",k),L.setAttribute("stroke-width",i.borderStyle.width||1),L.setAttribute("stroke","transparent"),L.setAttribute("fill","transparent"),v.append(L),this.container.append(v),this._createPopup(L,i),this.container}}class st extends J{constructor(i){super(i),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Y extends y{constructor(i){var _,v,k;const h=!!(i.data.hasPopup||((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class z extends y{constructor(i){var _,v,k;const h=!!(i.data.hasPopup||((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const i=this.data,{width:h,height:_}=F(i.rect),v=this.svgFactory.create(h,_,!0);for(const k of i.inkLists){let L=[];for(const dt of k){const K=dt.x-i.rect[0],ot=i.rect[3]-dt.y;L.push(`${K},${ot}`)}L=L.join(" ");const nt=this.svgFactory.createElement(this.svgElementName);nt.setAttribute("points",L),nt.setAttribute("stroke-width",i.borderStyle.width||1),nt.setAttribute("stroke","transparent"),nt.setAttribute("fill","transparent"),this._createPopup(nt,i),v.append(nt)}return this.container.append(v),this.container}}class j extends y{constructor(i){var _,v,k;const h=!!(i.data.hasPopup||((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class q extends y{constructor(i){var _,v,k;const h=!!(i.data.hasPopup||((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class G extends y{constructor(i){var _,v,k;const h=!!(i.data.hasPopup||((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class et extends y{constructor(i){var _,v,k;const h=!!(i.data.hasPopup||((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class ct extends y{constructor(i){var _,v,k;const h=!!(i.data.hasPopup||((_=i.data.titleObj)==null?void 0:_.str)||((v=i.data.contentsObj)==null?void 0:v.str)||((k=i.data.richText)==null?void 0:k.str));super(i,{isRenderable:h,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class bt extends y{constructor(i){var v;super(i,{isRenderable:!0});const{filename:h,content:_}=this.data.file;this.filename=(0,C.getFilenameFromUrl)(h),this.content=_,(v=this.linkService.eventBus)==null||v.dispatch("fileattachmentannotation",{source:this,filename:h,content:_})}render(){var h,_;this.container.className="fileAttachmentAnnotation";const i=document.createElement("div");return i.className="popupTriggerArea",i.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(((h=this.data.titleObj)==null?void 0:h.str)||((_=this.data.contentsObj)==null?void 0:_.str)||this.data.richText)&&this._createPopup(i,this.data),this.container.append(i),this.container}_download(){var i;(i=this.downloadManager)==null||i.openOrDownloadData(this.container,this.content,this.filename)}}const X=class{static render(i){var nt,dt;const{annotations:h,div:_,viewport:v,accessibilityManager:k}=i;ht(this,T,Te).call(this,_,v);let L=0;for(const K of h){if(K.annotationType!==S.AnnotationType.POPUP){const{width:Z,height:lt}=F(K.rect);if(Z<=0||lt<=0)continue}const ot=b.create({data:K,layer:_,page:i.page,viewport:v,linkService:i.linkService,downloadManager:i.downloadManager,imageResourcesPath:i.imageResourcesPath||"",renderForms:i.renderForms!==!1,svgFactory:new C.DOMSVGFactory,annotationStorage:i.annotationStorage||new Q.AnnotationStorage,enableScripting:i.enableScripting,hasJSActions:i.hasJSActions,fieldObjects:i.fieldObjects,mouseState:i.mouseState||{isDown:!1}});if(ot.isRenderable){const Z=ot.render();if(K.hidden&&(Z.style.visibility="hidden"),Array.isArray(Z))for(const lt of Z)lt.style.zIndex=L++,ht(nt=X,c,Ce).call(nt,lt,K.id,_,k);else Z.style.zIndex=L++,ot instanceof s?_.prepend(Z):ht(dt=X,c,Ce).call(dt,Z,K.id,_,k)}}ht(this,O,xe).call(this,_,i.annotationCanvasMap)}static update(i){const{annotationCanvasMap:h,div:_,viewport:v}=i;ht(this,T,Te).call(this,_,v),ht(this,O,xe).call(this,_,h),_.hidden=!1}};let D=X;c=new WeakSet,Ce=function(i,h,_,v){const k=i.firstChild||i;k.id=`${C.AnnotationPrefix}${h}`,_.append(i),v==null||v.moveElementInDOM(_,i,k,!1)},T=new WeakSet,Te=function(i,{width:h,height:_,rotation:v}){const{style:k}=i,L=v%180!==0,nt=Math.floor(h)+"px",dt=Math.floor(_)+"px";k.width=L?dt:nt,k.height=L?nt:dt,i.setAttribute("data-main-rotation",v)},O=new WeakSet,xe=function(i,h){if(!!h){for(const[_,v]of h){const k=i.querySelector(`[data-annotation-id="${_}"]`);if(!k)continue;const{firstChild:L}=k;L?L.nodeName==="CANVAS"?L.replaceWith(v):L.before(v):k.append(v)}h.clear()}},at(D,c),at(D,T),at(D,O),p.AnnotationLayer=D},(it,p)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.ColorConverters=void 0;function $(C){return Math.floor(Math.max(0,Math.min(1,C))*255).toString(16).padStart(2,"0")}class S{static CMYK_G([Q,W,tt,N]){return["G",1-Math.min(1,.3*Q+.59*tt+.11*W+N)]}static G_CMYK([Q]){return["CMYK",0,0,0,1-Q]}static G_RGB([Q]){return["RGB",Q,Q,Q]}static G_HTML([Q]){const W=$(Q);return`#${W}${W}${W}`}static RGB_G([Q,W,tt]){return["G",.3*Q+.59*W+.11*tt]}static RGB_HTML([Q,W,tt]){const N=$(Q),f=$(W),E=$(tt);return`#${N}${f}${E}`}static T_HTML(){return"#00000000"}static CMYK_RGB([Q,W,tt,N]){return["RGB",1-Math.min(1,Q+N),1-Math.min(1,tt+N),1-Math.min(1,W+N)]}static CMYK_HTML(Q){const W=this.CMYK_RGB(Q).slice(1);return this.RGB_HTML(W)}static RGB_CMYK([Q,W,tt]){const N=1-Q,f=1-W,E=1-tt,F=Math.min(N,f,E);return["CMYK",N,f,E,F]}}p.ColorConverters=S},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.XfaLayer=void 0;var S=$(20);class C{static setupStorage(W,tt,N,f,E){const F=f.getValue(tt,{value:null});switch(N.name){case"textarea":if(F.value!==null&&(W.textContent=F.value),E==="print")break;W.addEventListener("input",b=>{f.setValue(tt,{value:b.target.value})});break;case"input":if(N.attributes.type==="radio"||N.attributes.type==="checkbox"){if(F.value===N.attributes.xfaOn?W.setAttribute("checked",!0):F.value===N.attributes.xfaOff&&W.removeAttribute("checked"),E==="print")break;W.addEventListener("change",b=>{f.setValue(tt,{value:b.target.checked?b.target.getAttribute("xfaOn"):b.target.getAttribute("xfaOff")})})}else{if(F.value!==null&&W.setAttribute("value",F.value),E==="print")break;W.addEventListener("input",b=>{f.setValue(tt,{value:b.target.value})})}break;case"select":if(F.value!==null)for(const b of N.children)b.attributes.value===F.value&&(b.attributes.selected=!0);W.addEventListener("input",b=>{const y=b.target.options,o=y.selectedIndex===-1?"":y[y.selectedIndex].value;f.setValue(tt,{value:o})});break}}static setAttributes({html:W,element:tt,storage:N=null,intent:f,linkService:E}){const{attributes:F}=tt,b=W instanceof HTMLAnchorElement;F.type==="radio"&&(F.name=`${F.name}-${f}`);for(const[y,o]of Object.entries(F))if(o!=null)switch(y){case"class":o.length&&W.setAttribute(y,o.join(" "));break;case"dataId":break;case"id":W.setAttribute("data-element-id",o);break;case"style":Object.assign(W.style,o);break;case"textContent":W.textContent=o;break;default:(!b||y!=="href"&&y!=="newWindow")&&W.setAttribute(y,o)}b&&E.addLinkAttributes(W,F.href,F.newWindow),N&&F.dataId&&this.setupStorage(W,F.dataId,tt,N)}static render(W){var t;const tt=W.annotationStorage,N=W.linkService,f=W.xfaHtml,E=W.intent||"display",F=document.createElement(f.name);f.attributes&&this.setAttributes({html:F,element:f,intent:E,linkService:N});const b=[[f,-1,F]],y=W.div;if(y.append(F),W.viewport){const n=`matrix(${W.viewport.transform.join(",")})`;y.style.transform=n}E!=="richText"&&y.setAttribute("class","xfaLayer xfaFont");const o=[];for(;b.length>0;){const[n,r,g]=b.at(-1);if(r+1===n.children.length){b.pop();continue}const m=n.children[++b.at(-1)[1]];if(m===null)continue;const{name:a}=m;if(a==="#text"){const s=document.createTextNode(m.value);o.push(s),g.append(s);continue}let e;if((t=m==null?void 0:m.attributes)!=null&&t.xmlns?e=document.createElementNS(m.attributes.xmlns,a):e=document.createElement(a),g.append(e),m.attributes&&this.setAttributes({html:e,element:m,storage:tt,intent:E,linkService:N}),m.children&&m.children.length>0)b.push([m,-1,e]);else if(m.value){const s=document.createTextNode(m.value);S.XfaText.shouldBuildText(a)&&o.push(s),e.append(s)}}for(const n of y.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))n.setAttribute("readOnly",!0);return{textDivs:o}}static update(W){const tt=`matrix(${W.viewport.transform.join(",")})`;W.div.style.transform=tt,W.div.hidden=!1}}p.XfaLayer=C},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.TextLayerRenderTask=void 0,p.renderTextLayer=g;var S=$(1),C=$(8);const Q=1e5,W=30,tt=.8,N=new Map,f=/^\s+$/g;function E(m,a){const e=N.get(m);if(e)return e;a.save(),a.font=`${W}px ${m}`;const s=a.measureText("");let d=s.fontBoundingBoxAscent,x=Math.abs(s.fontBoundingBoxDescent);if(d){a.restore();const u=d/(d+x);return N.set(m,u),u}a.strokeStyle="red",a.clearRect(0,0,W,W),a.strokeText("g",0,0);let A=a.getImageData(0,0,W,W).data;x=0;for(let u=A.length-1-3;u>=0;u-=4)if(A[u]>0){x=Math.ceil(u/4/W);break}a.clearRect(0,0,W,W),a.strokeText("A",0,W),A=a.getImageData(0,0,W,W).data,d=0;for(let u=0,w=A.length;u<w;u+=4)if(A[u]>0){d=W-Math.floor(u/4/W);break}if(a.restore(),d){const u=d/(d+x);return N.set(m,u),u}return N.set(m,tt),tt}function F(m,a,e,s){const d=document.createElement("span"),x=m._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:a.str!=="",hasEOL:a.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:a.str!=="",hasEOL:a.hasEOL,fontSize:0};m._textDivs.push(d);const A=S.Util.transform(m._viewport.transform,a.transform);let u=Math.atan2(A[1],A[0]);const w=e[a.fontName];w.vertical&&(u+=Math.PI/2);const J=Math.hypot(A[2],A[3]),st=J*E(w.fontFamily,s);let Y,z;u===0?(Y=A[4],z=A[5]-st):(Y=A[4]+st*Math.sin(u),z=A[5]-st*Math.cos(u)),d.style.left=`${Y}px`,d.style.top=`${z}px`,d.style.fontSize=`${J}px`,d.style.fontFamily=w.fontFamily,x.fontSize=J,d.setAttribute("role","presentation"),d.textContent=a.str,d.dir=a.dir,m._fontInspectorEnabled&&(d.dataset.fontName=a.fontName),u!==0&&(x.angle=u*(180/Math.PI));let j=!1;if(a.str.length>1||m._enhanceTextSelection&&f.test(a.str))j=!0;else if(a.str!==" "&&a.transform[0]!==a.transform[3]){const q=Math.abs(a.transform[0]),G=Math.abs(a.transform[3]);q!==G&&Math.max(q,G)/Math.min(q,G)>1.5&&(j=!0)}if(j&&(w.vertical?x.canvasWidth=a.height*m._viewport.scale:x.canvasWidth=a.width*m._viewport.scale),m._textDivProperties.set(d,x),m._textContentStream&&m._layoutText(d),m._enhanceTextSelection&&x.hasText){let q=1,G=0;u!==0&&(q=Math.cos(u),G=Math.sin(u));const et=(w.vertical?a.height:a.width)*m._viewport.scale,ct=J;let bt,D;u!==0?(bt=[q,G,-G,q,Y,z],D=S.Util.getAxialAlignedBoundingBox([0,0,et,ct],bt)):D=[Y,z,Y+et,z+ct],m._bounds.push({left:D[0],top:D[1],right:D[2],bottom:D[3],div:d,size:[et,ct],m:bt})}}function b(m){if(m._canceled)return;const a=m._textDivs,e=m._capability,s=a.length;if(s>Q){m._renderingDone=!0,e.resolve();return}if(!m._textContentStream)for(let d=0;d<s;d++)m._layoutText(a[d]);m._renderingDone=!0,e.resolve()}function y(m,a,e){let s=0;for(let d=0;d<e;d++){const x=m[a++];x>0&&(s=s?Math.min(x,s):x)}return s}function o(m){const a=m._bounds,e=m._viewport,s=t(e.width,e.height,a);for(let d=0;d<s.length;d++){const x=a[d].div,A=m._textDivProperties.get(x);if(A.angle===0){A.paddingLeft=a[d].left-s[d].left,A.paddingTop=a[d].top-s[d].top,A.paddingRight=s[d].right-a[d].right,A.paddingBottom=s[d].bottom-a[d].bottom,m._textDivProperties.set(x,A);continue}const u=s[d],w=a[d],J=w.m,st=J[0],Y=J[1],z=[[0,0],[0,w.size[1]],[w.size[0],0],w.size],j=new Float64Array(64);for(let G=0,et=z.length;G<et;G++){const ct=S.Util.applyTransform(z[G],J);j[G+0]=st&&(u.left-ct[0])/st,j[G+4]=Y&&(u.top-ct[1])/Y,j[G+8]=st&&(u.right-ct[0])/st,j[G+12]=Y&&(u.bottom-ct[1])/Y,j[G+16]=Y&&(u.left-ct[0])/-Y,j[G+20]=st&&(u.top-ct[1])/st,j[G+24]=Y&&(u.right-ct[0])/-Y,j[G+28]=st&&(u.bottom-ct[1])/st,j[G+32]=st&&(u.left-ct[0])/-st,j[G+36]=Y&&(u.top-ct[1])/-Y,j[G+40]=st&&(u.right-ct[0])/-st,j[G+44]=Y&&(u.bottom-ct[1])/-Y,j[G+48]=Y&&(u.left-ct[0])/Y,j[G+52]=st&&(u.top-ct[1])/-st,j[G+56]=Y&&(u.right-ct[0])/Y,j[G+60]=st&&(u.bottom-ct[1])/-st}const q=1+Math.min(Math.abs(st),Math.abs(Y));A.paddingLeft=y(j,32,16)/q,A.paddingTop=y(j,48,16)/q,A.paddingRight=y(j,0,16)/q,A.paddingBottom=y(j,16,16)/q,m._textDivProperties.set(x,A)}}function t(m,a,e){const s=e.map(function(x,A){return{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom,index:A,x1New:void 0,x2New:void 0}});n(m,s);const d=new Array(e.length);for(const x of s){const A=x.index;d[A]={left:x.x1New,top:0,right:x.x2New,bottom:0}}e.map(function(x,A){const u=d[A],w=s[A];w.x1=x.top,w.y1=m-u.right,w.x2=x.bottom,w.y2=m-u.left,w.index=A,w.x1New=void 0,w.x2New=void 0}),n(a,s);for(const x of s){const A=x.index;d[A].top=x.x1New,d[A].bottom=x.x2New}return d}function n(m,a){a.sort(function(d,x){return d.x1-x.x1||d.index-x.index});const s=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const d of a){let x=0;for(;x<s.length&&s[x].end<=d.y1;)x++;let A=s.length-1;for(;A>=0&&s[A].start>=d.y2;)A--;let u,w,J,st,Y=-1/0;for(J=x;J<=A;J++){u=s[J],w=u.boundary;let q;w.x2>d.x1?q=w.index>d.index?w.x1New:d.x1:w.x2New===void 0?q=(w.x2+d.x1)/2:q=w.x2New,q>Y&&(Y=q)}for(d.x1New=Y,J=x;J<=A;J++)u=s[J],w=u.boundary,w.x2New===void 0?w.x2>d.x1?w.index>d.index&&(w.x2New=w.x2):w.x2New=Y:w.x2New>Y&&(w.x2New=Math.max(Y,w.x2));const z=[];let j=null;for(J=x;J<=A;J++){u=s[J],w=u.boundary;const q=w.x2>d.x2?w:d;j===q?z.at(-1).end=u.end:(z.push({start:u.start,end:u.end,boundary:q}),j=q)}for(s[x].start<d.y1&&(z[0].start=d.y1,z.unshift({start:s[x].start,end:d.y1,boundary:s[x].boundary})),d.y2<s[A].end&&(z.at(-1).end=d.y2,z.push({start:d.y2,end:s[A].end,boundary:s[A].boundary})),J=x;J<=A;J++){if(u=s[J],w=u.boundary,w.x2New!==void 0)continue;let q=!1;for(st=x-1;!q&&st>=0&&s[st].start>=w.y1;st--)q=s[st].boundary===w;for(st=A+1;!q&&st<s.length&&s[st].end<=w.y2;st++)q=s[st].boundary===w;for(st=0;!q&&st<z.length;st++)q=z[st].boundary===w;q||(w.x2New=Y)}Array.prototype.splice.apply(s,[x,A-x+1,...z])}for(const d of s){const x=d.boundary;x.x2New===void 0&&(x.x2New=Math.max(m,x.x2))}}class r{constructor({textContent:a,textContentStream:e,container:s,viewport:d,textDivs:x,textContentItemsStr:A,enhanceTextSelection:u}){var w;u&&(0,C.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=a,this._textContentStream=e,this._container=s,this._document=s.ownerDocument,this._viewport=d,this._textDivs=x||[],this._textContentItemsStr=A||[],this._enhanceTextSelection=!!u,this._fontInspectorEnabled=!!((w=globalThis.FontInspector)!=null&&w.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,S.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new S.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(a,e){for(let s=0,d=a.length;s<d;s++){if(a[s].str===void 0){if(a[s].type==="beginMarkedContentProps"||a[s].type==="beginMarkedContent"){const x=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),a[s].id!==null&&this._container.setAttribute("id",`${a[s].id}`),x.append(this._container)}else a[s].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(a[s].str),F(this,a[s],e,this._layoutTextCtx)}}_layoutText(a){const e=this._textDivProperties.get(a);let s="";if(e.canvasWidth!==0&&e.hasText){const{fontFamily:d}=a.style,{fontSize:x}=e;(x!==this._layoutTextLastFontSize||d!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${x*this._devicePixelRatio}px ${d}`,this._layoutTextLastFontSize=x,this._layoutTextLastFontFamily=d);const{width:A}=this._layoutTextCtx.measureText(a.textContent);if(A>0){const u=this._devicePixelRatio*e.canvasWidth/A;this._enhanceTextSelection&&(e.scale=u),s=`scaleX(${u})`}}if(e.angle!==0&&(s=`rotate(${e.angle}deg) ${s}`),s.length>0&&(this._enhanceTextSelection&&(e.originalTransform=s),a.style.transform=s),e.hasText&&this._container.append(a),e.hasEOL){const d=document.createElement("br");d.setAttribute("role","presentation"),this._container.append(d)}}_render(a=0){const e=(0,S.createPromiseCapability)();let s=Object.create(null);const d=this._document.createElement("canvas");if(d.height=d.width=W,this._layoutTextCtx=d.getContext("2d",{alpha:!1}),this._textContent){const x=this._textContent.items,A=this._textContent.styles;this._processItems(x,A),e.resolve()}else if(this._textContentStream){const x=()=>{this._reader.read().then(({value:A,done:u})=>{if(u){e.resolve();return}Object.assign(s,A.styles),this._processItems(A.items,s),x()},e.reject)};this._reader=this._textContentStream.getReader(),x()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');e.promise.then(()=>{s=null,a?this._renderTimer=setTimeout(()=>{b(this),this._renderTimer=null},a):b(this)},this._capability.reject)}expandTextDivs(a=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(o(this),this._bounds=null);const e=[],s=[];for(let d=0,x=this._textDivs.length;d<x;d++){const A=this._textDivs[d],u=this._textDivProperties.get(A);!u.hasText||(a?(e.length=0,s.length=0,u.originalTransform&&e.push(u.originalTransform),u.paddingTop>0?(s.push(`${u.paddingTop}px`),e.push(`translateY(${-u.paddingTop}px)`)):s.push(0),u.paddingRight>0?s.push(`${u.paddingRight/u.scale}px`):s.push(0),u.paddingBottom>0?s.push(`${u.paddingBottom}px`):s.push(0),u.paddingLeft>0?(s.push(`${u.paddingLeft/u.scale}px`),e.push(`translateX(${-u.paddingLeft/u.scale}px)`)):s.push(0),A.style.padding=s.join(" "),e.length&&(A.style.transform=e.join(" "))):(A.style.padding=null,A.style.transform=u.originalTransform))}}}p.TextLayerRenderTask=r;function g(m){const a=new r({textContent:m.textContent,textContentStream:m.textContentStream,container:m.container,viewport:m.viewport,textDivs:m.textDivs,textContentItemsStr:m.textContentItemsStr,enhanceTextSelection:m.enhanceTextSelection});return a._render(m.timeout),a}},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.SVGGraphics=void 0;var S=$(8),C=$(1),Q=$(3);let W=class{constructor(){(0,C.unreachable)("Not implemented: SVGGraphics")}};p.SVGGraphics=W;{let t=function(e){let s=[];const d=[];for(const x of e){if(x.fn==="save"){s.push({fnId:92,fn:"group",items:[]}),d.push(s),s=s.at(-1).items;continue}x.fn==="restore"?s=d.pop():s.push(x)}return s},n=function(e){if(Number.isInteger(e))return e.toString();const s=e.toFixed(10);let d=s.length-1;if(s[d]!=="0")return s;do d--;while(s[d]==="0");return s.substring(0,s[d]==="."?d:d+1)},r=function(e){if(e[4]===0&&e[5]===0){if(e[1]===0&&e[2]===0)return e[0]===1&&e[3]===1?"":`scale(${n(e[0])} ${n(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2]){const s=Math.acos(e[0])*180/Math.PI;return`rotate(${n(s)})`}}else if(e[0]===1&&e[1]===0&&e[2]===0&&e[3]===1)return`translate(${n(e[4])} ${n(e[5])})`;return`matrix(${n(e[0])} ${n(e[1])} ${n(e[2])} ${n(e[3])} ${n(e[4])} ${n(e[5])})`};const tt={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},N="http://www.w3.org/XML/1998/namespace",f="http://www.w3.org/1999/xlink",E=["butt","round","square"],F=["miter","round","bevel"],b=function(e,s="",d=!1){if(URL.createObjectURL&&typeof Blob!="undefined"&&!d)return URL.createObjectURL(new Blob([e],{type:s}));const x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let A=`data:${s};base64,`;for(let u=0,w=e.length;u<w;u+=3){const J=e[u]&255,st=e[u+1]&255,Y=e[u+2]&255,z=J>>2,j=(J&3)<<4|st>>4,q=u+1<w?(st&15)<<2|Y>>6:64,G=u+2<w?Y&63:64;A+=x[z]+x[j]+x[q]+x[G]}return A},y=function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),s=12,d=new Int32Array(256);for(let Y=0;Y<256;Y++){let z=Y;for(let j=0;j<8;j++)z&1?z=3988292384^z>>1&2147483647:z=z>>1&2147483647;d[Y]=z}function x(Y,z,j){let q=-1;for(let G=z;G<j;G++){const et=(q^Y[G])&255,ct=d[et];q=q>>>8^ct}return q^-1}function A(Y,z,j,q){let G=q;const et=z.length;j[G]=et>>24&255,j[G+1]=et>>16&255,j[G+2]=et>>8&255,j[G+3]=et&255,G+=4,j[G]=Y.charCodeAt(0)&255,j[G+1]=Y.charCodeAt(1)&255,j[G+2]=Y.charCodeAt(2)&255,j[G+3]=Y.charCodeAt(3)&255,G+=4,j.set(z,G),G+=z.length;const ct=x(j,q+4,G);j[G]=ct>>24&255,j[G+1]=ct>>16&255,j[G+2]=ct>>8&255,j[G+3]=ct&255}function u(Y,z,j){let q=1,G=0;for(let et=z;et<j;++et)q=(q+(Y[et]&255))%65521,G=(G+q)%65521;return G<<16|q}function w(Y){if(!Q.isNodeJS)return J(Y);try{let z;parseInt(process.versions.node)>=8?z=Y:z=Buffer.from(Y);const j=require("zlib").deflateSync(z,{level:9});return j instanceof Uint8Array?j:new Uint8Array(j)}catch(z){(0,C.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+z)}return J(Y)}function J(Y){let z=Y.length;const j=65535,q=Math.ceil(z/j),G=new Uint8Array(2+z+q*5+4);let et=0;G[et++]=120,G[et++]=156;let ct=0;for(;z>j;)G[et++]=0,G[et++]=255,G[et++]=255,G[et++]=0,G[et++]=0,G.set(Y.subarray(ct,ct+j),et),et+=j,ct+=j,z-=j;G[et++]=1,G[et++]=z&255,G[et++]=z>>8&255,G[et++]=~z&65535&255,G[et++]=(~z&65535)>>8&255,G.set(Y.subarray(ct),et),et+=Y.length-ct;const bt=u(Y,0,Y.length);return G[et++]=bt>>24&255,G[et++]=bt>>16&255,G[et++]=bt>>8&255,G[et++]=bt&255,G}function st(Y,z,j,q){const G=Y.width,et=Y.height;let ct,bt,D;const c=Y.data;switch(z){case C.ImageKind.GRAYSCALE_1BPP:bt=0,ct=1,D=G+7>>3;break;case C.ImageKind.RGB_24BPP:bt=2,ct=8,D=G*3;break;case C.ImageKind.RGBA_32BPP:bt=6,ct=8,D=G*4;break;default:throw new Error("invalid format")}const l=new Uint8Array((1+D)*et);let T=0,M=0;for(let h=0;h<et;++h)l[T++]=0,l.set(c.subarray(M,M+D),T),M+=D,T+=D;if(z===C.ImageKind.GRAYSCALE_1BPP&&q){T=0;for(let h=0;h<et;h++){T++;for(let _=0;_<D;_++)l[T++]^=255}}const O=new Uint8Array([G>>24&255,G>>16&255,G>>8&255,G&255,et>>24&255,et>>16&255,et>>8&255,et&255,ct,bt,0,0,0]),I=w(l),X=e.length+s*3+O.length+I.length,H=new Uint8Array(X);let i=0;return H.set(e,i),i+=e.length,A("IHDR",O,H,i),i+=s+O.length,A("IDATA",I,H,i),i+=s+I.length,A("IEND",new Uint8Array(0),H,i),b(H,"image/png",j)}return function(z,j,q){const G=z.kind===void 0?C.ImageKind.GRAYSCALE_1BPP:z.kind;return st(z,G,j,q)}}();class o{constructor(){this.fontSizeScale=1,this.fontWeight=tt.fontWeight,this.fontSize=0,this.textMatrix=C.IDENTITY_MATRIX,this.fontMatrix=C.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=C.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=tt.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(s,d){this.x=s,this.y=d}}let g=0,m=0,a=0;p.SVGGraphics=W=class{constructor(e,s,d=!1){(0,S.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new S.DOMSVGFactory,this.current=new o,this.transformMatrix=C.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=s,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!d,this._operatorIdMapping=[];for(const x in C.OPS)this._operatorIdMapping[C.OPS[x]]=x}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const s=e.fnArray,d=e.argsArray;for(let x=0,A=s.length;x<A;x++)if(s[x]===C.OPS.dependency)for(const u of d[x]){const w=u.startsWith("g_")?this.commonObjs:this.objs,J=new Promise(st=>{w.get(u,st)});this.current.dependencies.push(J)}return Promise.all(this.current.dependencies)}transform(e,s,d,x,A,u){const w=[e,s,d,x,A,u];this.transformMatrix=C.Util.transform(this.transformMatrix,w),this.tgrp=null}getSVG(e,s){this.viewport=s;const d=this._initialize(s);return this.loadDependencies(e).then(()=>(this.transformMatrix=C.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),d))}convertOpList(e){const s=this._operatorIdMapping,d=e.argsArray,x=e.fnArray,A=[];for(let u=0,w=x.length;u<w;u++){const J=x[u];A.push({fnId:J,fn:s[J],args:d[u]})}return t(A)}executeOpTree(e){for(const s of e){const d=s.fn,x=s.fnId,A=s.args;switch(x|0){case C.OPS.beginText:this.beginText();break;case C.OPS.dependency:break;case C.OPS.setLeading:this.setLeading(A);break;case C.OPS.setLeadingMoveText:this.setLeadingMoveText(A[0],A[1]);break;case C.OPS.setFont:this.setFont(A);break;case C.OPS.showText:this.showText(A[0]);break;case C.OPS.showSpacedText:this.showText(A[0]);break;case C.OPS.endText:this.endText();break;case C.OPS.moveText:this.moveText(A[0],A[1]);break;case C.OPS.setCharSpacing:this.setCharSpacing(A[0]);break;case C.OPS.setWordSpacing:this.setWordSpacing(A[0]);break;case C.OPS.setHScale:this.setHScale(A[0]);break;case C.OPS.setTextMatrix:this.setTextMatrix(A[0],A[1],A[2],A[3],A[4],A[5]);break;case C.OPS.setTextRise:this.setTextRise(A[0]);break;case C.OPS.setTextRenderingMode:this.setTextRenderingMode(A[0]);break;case C.OPS.setLineWidth:this.setLineWidth(A[0]);break;case C.OPS.setLineJoin:this.setLineJoin(A[0]);break;case C.OPS.setLineCap:this.setLineCap(A[0]);break;case C.OPS.setMiterLimit:this.setMiterLimit(A[0]);break;case C.OPS.setFillRGBColor:this.setFillRGBColor(A[0],A[1],A[2]);break;case C.OPS.setStrokeRGBColor:this.setStrokeRGBColor(A[0],A[1],A[2]);break;case C.OPS.setStrokeColorN:this.setStrokeColorN(A);break;case C.OPS.setFillColorN:this.setFillColorN(A);break;case C.OPS.shadingFill:this.shadingFill(A[0]);break;case C.OPS.setDash:this.setDash(A[0],A[1]);break;case C.OPS.setRenderingIntent:this.setRenderingIntent(A[0]);break;case C.OPS.setFlatness:this.setFlatness(A[0]);break;case C.OPS.setGState:this.setGState(A[0]);break;case C.OPS.fill:this.fill();break;case C.OPS.eoFill:this.eoFill();break;case C.OPS.stroke:this.stroke();break;case C.OPS.fillStroke:this.fillStroke();break;case C.OPS.eoFillStroke:this.eoFillStroke();break;case C.OPS.clip:this.clip("nonzero");break;case C.OPS.eoClip:this.clip("evenodd");break;case C.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case C.OPS.paintImageXObject:this.paintImageXObject(A[0]);break;case C.OPS.paintInlineImageXObject:this.paintInlineImageXObject(A[0]);break;case C.OPS.paintImageMaskXObject:this.paintImageMaskXObject(A[0]);break;case C.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(A[0],A[1]);break;case C.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case C.OPS.closePath:this.closePath();break;case C.OPS.closeStroke:this.closeStroke();break;case C.OPS.closeFillStroke:this.closeFillStroke();break;case C.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case C.OPS.nextLine:this.nextLine();break;case C.OPS.transform:this.transform(A[0],A[1],A[2],A[3],A[4],A[5]);break;case C.OPS.constructPath:this.constructPath(A[0],A[1]);break;case C.OPS.endPath:this.endPath();break;case 92:this.group(s.items);break;default:(0,C.warn)(`Unimplemented operator ${d}`);break}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,s,d,x,A,u){const w=this.current;w.textMatrix=w.lineMatrix=[e,s,d,x,A,u],w.textMatrixScale=Math.hypot(e,s),w.x=w.lineX=0,w.y=w.lineY=0,w.xcoords=[],w.ycoords=[],w.tspan=this.svgFactory.createElement("svg:tspan"),w.tspan.setAttributeNS(null,"font-family",w.fontFamily),w.tspan.setAttributeNS(null,"font-size",`${n(w.fontSize)}px`),w.tspan.setAttributeNS(null,"y",n(-w.y)),w.txtElement=this.svgFactory.createElement("svg:text"),w.txtElement.append(w.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=C.IDENTITY_MATRIX,e.lineMatrix=C.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,s){const d=this.current;d.x=d.lineX+=e,d.y=d.lineY+=s,d.xcoords=[],d.ycoords=[],d.tspan=this.svgFactory.createElement("svg:tspan"),d.tspan.setAttributeNS(null,"font-family",d.fontFamily),d.tspan.setAttributeNS(null,"font-size",`${n(d.fontSize)}px`),d.tspan.setAttributeNS(null,"y",n(-d.y))}showText(e){const s=this.current,d=s.font,x=s.fontSize;if(x===0)return;const A=s.fontSizeScale,u=s.charSpacing,w=s.wordSpacing,J=s.fontDirection,st=s.textHScale*J,Y=d.vertical,z=Y?1:-1,j=d.defaultVMetrics,q=x*s.fontMatrix[0];let G=0;for(const bt of e){if(bt===null){G+=J*w;continue}else if(typeof bt=="number"){G+=z*bt*x/1e3;continue}const D=(bt.isSpace?w:0)+u,c=bt.fontChar;let l,T,M=bt.width;if(Y){let I;const X=bt.vmetric||j;I=bt.vmetric?X[1]:M*.5,I=-I*q;const H=X[2]*q;M=X?-X[0]:M,l=I/A,T=(G+H)/A}else l=G/A,T=0;(bt.isInFont||d.missingFile)&&(s.xcoords.push(s.x+l),Y&&s.ycoords.push(-s.y+T),s.tspan.textContent+=c);let O;Y?O=M*q-D*J:O=M*q+D*J,G+=O}s.tspan.setAttributeNS(null,"x",s.xcoords.map(n).join(" ")),Y?s.tspan.setAttributeNS(null,"y",s.ycoords.map(n).join(" ")):s.tspan.setAttributeNS(null,"y",n(-s.y)),Y?s.y-=G:s.x+=G*st,s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",`${n(s.fontSize)}px`),s.fontStyle!==tt.fontStyle&&s.tspan.setAttributeNS(null,"font-style",s.fontStyle),s.fontWeight!==tt.fontWeight&&s.tspan.setAttributeNS(null,"font-weight",s.fontWeight);const et=s.textRenderingMode&C.TextRenderingMode.FILL_STROKE_MASK;if(et===C.TextRenderingMode.FILL||et===C.TextRenderingMode.FILL_STROKE?(s.fillColor!==tt.fillColor&&s.tspan.setAttributeNS(null,"fill",s.fillColor),s.fillAlpha<1&&s.tspan.setAttributeNS(null,"fill-opacity",s.fillAlpha)):s.textRenderingMode===C.TextRenderingMode.ADD_TO_PATH?s.tspan.setAttributeNS(null,"fill","transparent"):s.tspan.setAttributeNS(null,"fill","none"),et===C.TextRenderingMode.STROKE||et===C.TextRenderingMode.FILL_STROKE){const bt=1/(s.textMatrixScale||1);this._setStrokeAttributes(s.tspan,bt)}let ct=s.textMatrix;s.textRise!==0&&(ct=ct.slice(),ct[5]+=s.textRise),s.txtElement.setAttributeNS(null,"transform",`${r(ct)} scale(${n(st)}, -1)`),s.txtElement.setAttributeNS(N,"xml:space","preserve"),s.txtElement.append(s.tspan),s.txtgrp.append(s.txtElement),this._ensureTransformGroup().append(s.txtElement)}setLeadingMoveText(e,s){this.setLeading(-s),this.moveText(e,s)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const s=b(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${s}); }
`}setFont(e){const s=this.current,d=this.commonObjs.get(e[0]);let x=e[1];s.font=d,this.embedFonts&&!d.missingFile&&!this.embeddedFonts[d.loadedName]&&(this.addFontStyle(d),this.embeddedFonts[d.loadedName]=d),s.fontMatrix=d.fontMatrix||C.FONT_IDENTITY_MATRIX;let A="normal";d.black?A="900":d.bold&&(A="bold");const u=d.italic?"italic":"normal";x<0?(x=-x,s.fontDirection=-1):s.fontDirection=1,s.fontSize=x,s.fontFamily=d.loadedName,s.fontWeight=A,s.fontStyle=u,s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"y",n(-s.y)),s.xcoords=[],s.ycoords=[]}endText(){var s;const e=this.current;e.textRenderingMode&C.TextRenderingMode.ADD_TO_PATH_FLAG&&((s=e.txtElement)==null?void 0:s.hasChildNodes())&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=E[e]}setLineJoin(e){this.current.lineJoin=F[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,s,d){this.current.strokeColor=C.Util.makeHexColor(e,s,d)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,s,d){this.current.fillColor=C.Util.makeHexColor(e,s,d),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const s=this.viewport.width,d=this.viewport.height,x=C.Util.inverseTransform(this.transformMatrix),A=C.Util.applyTransform([0,0],x),u=C.Util.applyTransform([0,d],x),w=C.Util.applyTransform([s,0],x),J=C.Util.applyTransform([s,d],x),st=Math.min(A[0],u[0],w[0],J[0]),Y=Math.min(A[1],u[1],w[1],J[1]),z=Math.max(A[0],u[0],w[0],J[0]),j=Math.max(A[1],u[1],w[1],J[1]),q=this.svgFactory.createElement("svg:rect");q.setAttributeNS(null,"x",st),q.setAttributeNS(null,"y",Y),q.setAttributeNS(null,"width",z-st),q.setAttributeNS(null,"height",j-Y),q.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&q.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(q)}_makeColorN_Pattern(e){return e[0]==="TilingPattern"?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const s=e[1],d=e[2],x=e[3]||C.IDENTITY_MATRIX,[A,u,w,J]=e[4],st=e[5],Y=e[6],z=e[7],j=`shading${a++}`,[q,G,et,ct]=C.Util.normalizeRect([...C.Util.applyTransform([A,u],x),...C.Util.applyTransform([w,J],x)]),[bt,D]=C.Util.singularValueDecompose2dScale(x),c=st*bt,l=Y*D,T=this.svgFactory.createElement("svg:pattern");T.setAttributeNS(null,"id",j),T.setAttributeNS(null,"patternUnits","userSpaceOnUse"),T.setAttributeNS(null,"width",c),T.setAttributeNS(null,"height",l),T.setAttributeNS(null,"x",`${q}`),T.setAttributeNS(null,"y",`${G}`);const M=this.svg,O=this.transformMatrix,I=this.current.fillColor,X=this.current.strokeColor,H=this.svgFactory.create(et-q,ct-G);if(this.svg=H,this.transformMatrix=x,z===2){const i=C.Util.makeHexColor(...s);this.current.fillColor=i,this.current.strokeColor=i}return this.executeOpTree(this.convertOpList(d)),this.svg=M,this.transformMatrix=O,this.current.fillColor=I,this.current.strokeColor=X,T.append(H.childNodes[0]),this.defs.append(T),`url(#${j})`}_makeShadingPattern(e){switch(typeof e=="string"&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const s=`shading${a++}`,d=e[3];let x;switch(e[1]){case"axial":const A=e[4],u=e[5];x=this.svgFactory.createElement("svg:linearGradient"),x.setAttributeNS(null,"id",s),x.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),x.setAttributeNS(null,"x1",A[0]),x.setAttributeNS(null,"y1",A[1]),x.setAttributeNS(null,"x2",u[0]),x.setAttributeNS(null,"y2",u[1]);break;case"radial":const w=e[4],J=e[5],st=e[6],Y=e[7];x=this.svgFactory.createElement("svg:radialGradient"),x.setAttributeNS(null,"id",s),x.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),x.setAttributeNS(null,"cx",J[0]),x.setAttributeNS(null,"cy",J[1]),x.setAttributeNS(null,"r",Y),x.setAttributeNS(null,"fx",w[0]),x.setAttributeNS(null,"fy",w[1]),x.setAttributeNS(null,"fr",st);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const A of d){const u=this.svgFactory.createElement("svg:stop");u.setAttributeNS(null,"offset",A[0]),u.setAttributeNS(null,"stop-color",A[1]),x.append(u)}return this.defs.append(x),`url(#${s})`;case"Mesh":return(0,C.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,s){this.current.dashArray=e,this.current.dashPhase=s}constructPath(e,s){const d=this.current;let x=d.x,A=d.y,u=[],w=0;for(const J of e)switch(J|0){case C.OPS.rectangle:x=s[w++],A=s[w++];const st=s[w++],Y=s[w++],z=x+st,j=A+Y;u.push("M",n(x),n(A),"L",n(z),n(A),"L",n(z),n(j),"L",n(x),n(j),"Z");break;case C.OPS.moveTo:x=s[w++],A=s[w++],u.push("M",n(x),n(A));break;case C.OPS.lineTo:x=s[w++],A=s[w++],u.push("L",n(x),n(A));break;case C.OPS.curveTo:x=s[w+4],A=s[w+5],u.push("C",n(s[w]),n(s[w+1]),n(s[w+2]),n(s[w+3]),n(x),n(A)),w+=6;break;case C.OPS.curveTo2:u.push("C",n(x),n(A),n(s[w]),n(s[w+1]),n(s[w+2]),n(s[w+3])),x=s[w+2],A=s[w+3],w+=4;break;case C.OPS.curveTo3:x=s[w+2],A=s[w+3],u.push("C",n(s[w]),n(s[w+1]),n(x),n(A),n(x),n(A)),w+=4;break;case C.OPS.closePath:u.push("Z");break}u=u.join(" "),d.path&&e.length>0&&e[0]!==C.OPS.rectangle&&e[0]!==C.OPS.moveTo?u=d.path.getAttributeNS(null,"d")+u:(d.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(d.path)),d.path.setAttributeNS(null,"d",u),d.path.setAttributeNS(null,"fill","none"),d.element=d.path,d.setCurrentPoint(x,A)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element){this.pendingClip=null;return}const s=`clippath${g++}`,d=this.svgFactory.createElement("svg:clipPath");d.setAttributeNS(null,"id",s),d.setAttributeNS(null,"transform",r(this.transformMatrix));const x=e.element.cloneNode(!0);if(this.pendingClip==="evenodd"?x.setAttributeNS(null,"clip-rule","evenodd"):x.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,d.append(x),this.defs.append(d),e.activeClipUrl){e.clipGroup=null;for(const A of this.extraStack)A.clipGroup=null;d.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl=`url(#${s})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const s=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",s)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[s,d]of e)switch(s){case"LW":this.setLineWidth(d);break;case"LC":this.setLineCap(d);break;case"LJ":this.setLineJoin(d);break;case"ML":this.setMiterLimit(d);break;case"D":this.setDash(d[0],d[1]);break;case"RI":this.setRenderingIntent(d);break;case"FL":this.setFlatness(d);break;case"Font":this.setFont(d);break;case"CA":this.setStrokeAlpha(d);break;case"ca":this.setFillAlpha(d);break;default:(0,C.warn)(`Unimplemented graphic state operator ${s}`);break}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,s=1){const d=this.current;let x=d.dashArray;s!==1&&x.length>0&&(x=x.map(function(A){return s*A})),e.setAttributeNS(null,"stroke",d.strokeColor),e.setAttributeNS(null,"stroke-opacity",d.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",n(d.miterLimit)),e.setAttributeNS(null,"stroke-linecap",d.lineCap),e.setAttributeNS(null,"stroke-linejoin",d.lineJoin),e.setAttributeNS(null,"stroke-width",n(s*d.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",x.map(n).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",n(s*d.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(e)}paintImageXObject(e){const s=e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e);if(!s){(0,C.warn)(`Dependent image with object ID ${e} is not ready yet`);return}this.paintInlineImageXObject(s)}paintInlineImageXObject(e,s){const d=e.width,x=e.height,A=y(e,this.forceDataSchema,!!s),u=this.svgFactory.createElement("svg:rect");u.setAttributeNS(null,"x","0"),u.setAttributeNS(null,"y","0"),u.setAttributeNS(null,"width",n(d)),u.setAttributeNS(null,"height",n(x)),this.current.element=u,this.clip("nonzero");const w=this.svgFactory.createElement("svg:image");w.setAttributeNS(f,"xlink:href",A),w.setAttributeNS(null,"x","0"),w.setAttributeNS(null,"y",n(-x)),w.setAttributeNS(null,"width",n(d)+"px"),w.setAttributeNS(null,"height",n(x)+"px"),w.setAttributeNS(null,"transform",`scale(${n(1/d)} ${n(-1/x)})`),s?s.append(w):this._ensureTransformGroup().append(w)}paintImageMaskXObject(e){const s=this.current,d=e.width,x=e.height,A=s.fillColor;s.maskId=`mask${m++}`;const u=this.svgFactory.createElement("svg:mask");u.setAttributeNS(null,"id",s.maskId);const w=this.svgFactory.createElement("svg:rect");w.setAttributeNS(null,"x","0"),w.setAttributeNS(null,"y","0"),w.setAttributeNS(null,"width",n(d)),w.setAttributeNS(null,"height",n(x)),w.setAttributeNS(null,"fill",A),w.setAttributeNS(null,"mask",`url(#${s.maskId})`),this.defs.append(u),this._ensureTransformGroup().append(w),this.paintInlineImageXObject(e,u)}paintFormXObjectBegin(e,s){if(Array.isArray(e)&&e.length===6&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),s){const d=s[2]-s[0],x=s[3]-s[1],A=this.svgFactory.createElement("svg:rect");A.setAttributeNS(null,"x",s[0]),A.setAttributeNS(null,"y",s[1]),A.setAttributeNS(null,"width",n(d)),A.setAttributeNS(null,"height",n(x)),this.current.element=A,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const s=this.svgFactory.create(e.width,e.height),d=this.svgFactory.createElement("svg:defs");s.append(d),this.defs=d;const x=this.svgFactory.createElement("svg:g");return x.setAttributeNS(null,"transform",r(e.transform)),s.append(x),this.svg=x,s}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",r(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.PDFNodeStream=void 0;var S=$(1),C=$(33);const Q=require$$4,W=require$$4,tt=require$$4,N=require$$4,f=/^file:\/\/\/[a-zA-Z]:\//;function E(m){const a=N.parse(m);return a.protocol==="file:"||a.host?a:/^[a-z]:[/\\]/i.test(m)?N.parse(`file:///${m}`):(a.host||(a.protocol="file:"),a)}class F{constructor(a){this.source=a,this.url=E(a.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&a.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var a,e;return(e=(a=this._fullRequestReader)==null?void 0:a._loaded)!=null?e:0}getFullReader(){return(0,S.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new r(this):new t(this),this._fullRequestReader}getRangeReader(a,e){if(e<=this._progressiveDataLength)return null;const s=this.isFsUrl?new g(this,a,e):new n(this,a,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(a){this._fullRequestReader&&this._fullRequestReader.cancel(a);for(const e of this._rangeRequestReaders.slice(0))e.cancel(a)}}p.PDFNodeStream=F;class b{constructor(a){this._url=a.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=a.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=(0,S.createPromiseCapability)(),this._headersCapability=(0,S.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const a=this._readableStream.read();return a===null?(this._readCapability=(0,S.createPromiseCapability)(),this.read()):(this._loaded+=a.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(a).buffer,done:!1})}cancel(a){if(!this._readableStream){this._error(a);return}this._readableStream.destroy(a)}_error(a){this._storedError=a,this._readCapability.resolve()}_setReadableStream(a){this._readableStream=a,a.on("readable",()=>{this._readCapability.resolve()}),a.on("end",()=>{a.destroy(),this._done=!0,this._readCapability.resolve()}),a.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new S.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class y{constructor(a){this._url=a.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,S.createPromiseCapability)();const e=a.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const a=this._readableStream.read();return a===null?(this._readCapability=(0,S.createPromiseCapability)(),this.read()):(this._loaded+=a.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(a).buffer,done:!1})}cancel(a){if(!this._readableStream){this._error(a);return}this._readableStream.destroy(a)}_error(a){this._storedError=a,this._readCapability.resolve()}_setReadableStream(a){this._readableStream=a,a.on("readable",()=>{this._readCapability.resolve()}),a.on("end",()=>{a.destroy(),this._done=!0,this._readCapability.resolve()}),a.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function o(m,a){return{protocol:m.protocol,auth:m.auth,host:m.hostname,port:m.port,path:m.path,method:"GET",headers:a}}class t extends b{constructor(a){super(a);const e=s=>{if(s.statusCode===404){const u=new S.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=u,this._headersCapability.reject(u);return}this._headersCapability.resolve(),this._setReadableStream(s);const d=u=>this._readableStream.headers[u.toLowerCase()],{allowRangeRequests:x,suggestedLength:A}=(0,C.validateRangeRequestCapabilities)({getResponseHeader:d,isHttp:a.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=x,this._contentLength=A||this._contentLength,this._filename=(0,C.extractFilenameFromHeader)(d)};this._request=null,this._url.protocol==="http:"?this._request=W.request(o(this._url,a.httpHeaders),e):this._request=tt.request(o(this._url,a.httpHeaders),e),this._request.on("error",s=>{this._storedError=s,this._headersCapability.reject(s)}),this._request.end()}}class n extends y{constructor(a,e,s){super(a),this._httpHeaders={};for(const x in a.httpHeaders){const A=a.httpHeaders[x];typeof A!="undefined"&&(this._httpHeaders[x]=A)}this._httpHeaders.Range=`bytes=${e}-${s-1}`;const d=x=>{if(x.statusCode===404){const A=new S.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=A;return}this._setReadableStream(x)};this._request=null,this._url.protocol==="http:"?this._request=W.request(o(this._url,this._httpHeaders),d):this._request=tt.request(o(this._url,this._httpHeaders),d),this._request.on("error",x=>{this._storedError=x}),this._request.end()}}class r extends b{constructor(a){super(a);let e=decodeURIComponent(this._url.path);f.test(this._url.href)&&(e=e.replace(/^\//,"")),Q.lstat(e,(s,d)=>{if(s){s.code==="ENOENT"&&(s=new S.MissingPDFException(`Missing PDF "${e}".`)),this._storedError=s,this._headersCapability.reject(s);return}this._contentLength=d.size,this._setReadableStream(Q.createReadStream(e)),this._headersCapability.resolve()})}}class g extends y{constructor(a,e,s){super(a);let d=decodeURIComponent(this._url.path);f.test(this._url.href)&&(d=d.replace(/^\//,"")),this._setReadableStream(Q.createReadStream(d,{start:e,end:s-1}))}}},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.createResponseStatusError=N,p.extractFilenameFromHeader=tt,p.validateRangeRequestCapabilities=W,p.validateResponseStatus=f;var S=$(1),C=$(34),Q=$(8);function W({getResponseHeader:E,isHttp:F,rangeChunkSize:b,disableRange:y}){const o={allowRangeRequests:!1,suggestedLength:void 0},t=parseInt(E("Content-Length"),10);return!Number.isInteger(t)||(o.suggestedLength=t,t<=2*b)||y||!F||E("Accept-Ranges")!=="bytes"||(E("Content-Encoding")||"identity")!=="identity"||(o.allowRangeRequests=!0),o}function tt(E){const F=E("Content-Disposition");if(F){let b=(0,C.getFilenameFromContentDispositionHeader)(F);if(b.includes("%"))try{b=decodeURIComponent(b)}catch{}if((0,Q.isPdfFile)(b))return b}return null}function N(E,F){return E===404||E===0&&F.startsWith("file:")?new S.MissingPDFException('Missing PDF "'+F+'".'):new S.UnexpectedResponseException(`Unexpected server response (${E}) while retrieving PDF "${F}".`,E)}function f(E){return E===200||E===206}},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.getFilenameFromContentDispositionHeader=C;var S=$(1);function C(Q){let W=!0,tt=N("filename\\*","i").exec(Q);if(tt){tt=tt[1];let t=b(tt);return t=unescape(t),t=y(t),t=o(t),E(t)}if(tt=F(Q),tt){const t=o(tt);return E(t)}if(tt=N("filename","i").exec(Q),tt){tt=tt[1];let t=b(tt);return t=o(t),E(t)}function N(t,n){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',n)}function f(t,n){if(t){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const r=new TextDecoder(t,{fatal:!0}),g=(0,S.stringToBytes)(n);n=r.decode(g),W=!1}catch{}}return n}function E(t){return W&&/[\x80-\xff]/.test(t)&&(t=f("utf-8",t),W&&(t=f("iso-8859-1",t))),t}function F(t){const n=[];let r;const g=N("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(r=g.exec(t))!==null;){let[,a,e,s]=r;if(a=parseInt(a,10),a in n){if(a===0)break;continue}n[a]=[e,s]}const m=[];for(let a=0;a<n.length&&a in n;++a){let[e,s]=n[a];s=b(s),e&&(s=unescape(s),a===0&&(s=y(s))),m.push(s)}return m.join("")}function b(t){if(t.startsWith('"')){const n=t.slice(1).split('\\"');for(let r=0;r<n.length;++r){const g=n[r].indexOf('"');g!==-1&&(n[r]=n[r].slice(0,g),n.length=r+1),n[r]=n[r].replace(/\\(.)/g,"$1")}t=n.join('"')}return t}function y(t){const n=t.indexOf("'");if(n===-1)return t;const r=t.slice(0,n),m=t.slice(n+1).replace(/^[^']*'/,"");return f(r,m)}function o(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(n,r,g,m){if(g==="q"||g==="Q")return m=m.replace(/_/g," "),m=m.replace(/=([0-9a-fA-F]{2})/g,function(a,e){return String.fromCharCode(parseInt(e,16))}),f(r,m);try{m=atob(m)}catch{}return f(r,m)})}return""}},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.PDFNetworkStream=void 0;var S=$(1),C=$(33);const Q=200,W=206;function tt(b){const y=b.response;return typeof y!="string"?y:(0,S.stringToBytes)(y).buffer}class N{constructor(y,o={}){this.url=y,this.isHttp=/^https?:/i.test(y),this.httpHeaders=this.isHttp&&o.httpHeaders||Object.create(null),this.withCredentials=o.withCredentials||!1,this.getXhr=o.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(y,o,t){const n={begin:y,end:o};for(const r in t)n[r]=t[r];return this.request(n)}requestFull(y){return this.request(y)}request(y){const o=this.getXhr(),t=this.currXhrId++,n=this.pendingRequests[t]={xhr:o};o.open("GET",this.url),o.withCredentials=this.withCredentials;for(const r in this.httpHeaders){const g=this.httpHeaders[r];typeof g!="undefined"&&o.setRequestHeader(r,g)}return this.isHttp&&"begin"in y&&"end"in y?(o.setRequestHeader("Range",`bytes=${y.begin}-${y.end-1}`),n.expectedStatus=W):n.expectedStatus=Q,o.responseType="arraybuffer",y.onError&&(o.onerror=function(r){y.onError(o.status)}),o.onreadystatechange=this.onStateChange.bind(this,t),o.onprogress=this.onProgress.bind(this,t),n.onHeadersReceived=y.onHeadersReceived,n.onDone=y.onDone,n.onError=y.onError,n.onProgress=y.onProgress,o.send(null),t}onProgress(y,o){var n;const t=this.pendingRequests[y];!t||(n=t.onProgress)==null||n.call(t,o)}onStateChange(y,o){var a,e,s;const t=this.pendingRequests[y];if(!t)return;const n=t.xhr;if(n.readyState>=2&&t.onHeadersReceived&&(t.onHeadersReceived(),delete t.onHeadersReceived),n.readyState!==4||!(y in this.pendingRequests))return;if(delete this.pendingRequests[y],n.status===0&&this.isHttp){(a=t.onError)==null||a.call(t,n.status);return}const r=n.status||Q;if(!(r===Q&&t.expectedStatus===W)&&r!==t.expectedStatus){(e=t.onError)==null||e.call(t,n.status);return}const m=tt(n);if(r===W){const d=n.getResponseHeader("Content-Range"),x=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);t.onDone({begin:parseInt(x[1],10),chunk:m})}else m?t.onDone({begin:0,chunk:m}):(s=t.onError)==null||s.call(t,n.status)}getRequestXhr(y){return this.pendingRequests[y].xhr}isPendingRequest(y){return y in this.pendingRequests}abortRequest(y){const o=this.pendingRequests[y].xhr;delete this.pendingRequests[y],o.abort()}}class f{constructor(y){this._source=y,this._manager=new N(y.url,{httpHeaders:y.httpHeaders,withCredentials:y.withCredentials}),this._rangeChunkSize=y.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(y){const o=this._rangeRequestReaders.indexOf(y);o>=0&&this._rangeRequestReaders.splice(o,1)}getFullReader(){return(0,S.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new E(this._manager,this._source),this._fullRequestReader}getRangeReader(y,o){const t=new F(this._manager,y,o);return t.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(t),t}cancelAllRequests(y){var o;(o=this._fullRequestReader)==null||o.cancel(y);for(const t of this._rangeRequestReaders.slice(0))t.cancel(y)}}p.PDFNetworkStream=f;class E{constructor(y,o){this._manager=y;const t={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=o.url,this._fullRequestId=y.requestFull(t),this._headersReceivedCapability=(0,S.createPromiseCapability)(),this._disableRange=o.disableRange||!1,this._contentLength=o.length,this._rangeChunkSize=o.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const y=this._fullRequestId,o=this._manager.getRequestXhr(y),t=g=>o.getResponseHeader(g),{allowRangeRequests:n,suggestedLength:r}=(0,C.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});n&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=(0,C.extractFilenameFromHeader)(t),this._isRangeSupported&&this._manager.abortRequest(y),this._headersReceivedCapability.resolve()}_onDone(y){if(y&&(this._requests.length>0?this._requests.shift().resolve({value:y.chunk,done:!1}):this._cachedChunks.push(y.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const o of this._requests)o.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(y){this._storedError=(0,C.createResponseStatusError)(y,this._url),this._headersReceivedCapability.reject(this._storedError);for(const o of this._requests)o.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(y){var o;(o=this.onProgress)==null||o.call(this,{loaded:y.loaded,total:y.lengthComputable?y.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const y=(0,S.createPromiseCapability)();return this._requests.push(y),y.promise}cancel(y){this._done=!0,this._headersReceivedCapability.reject(y);for(const o of this._requests)o.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class F{constructor(y,o,t){this._manager=y;const n={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=y.url,this._requestId=y.requestRange(o,t,n),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var y;(y=this.onClosed)==null||y.call(this,this)}_onDone(y){const o=y.chunk;this._requests.length>0?this._requests.shift().resolve({value:o,done:!1}):this._queuedChunk=o,this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(y){this._storedError=(0,C.createResponseStatusError)(y,this._url);for(const o of this._requests)o.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(y){var o;this.isStreamingSupported||(o=this.onProgress)==null||o.call(this,{loaded:y.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const o=this._queuedChunk;return this._queuedChunk=null,{value:o,done:!1}}if(this._done)return{value:void 0,done:!0};const y=(0,S.createPromiseCapability)();return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const o of this._requests)o.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(it,p,$)=>{Object.defineProperty(p,"__esModule",{value:!0}),p.PDFFetchStream=void 0;var S=$(1),C=$(33);function Q(E,F,b){return{method:"GET",headers:E,signal:b.signal,mode:"cors",credentials:F?"include":"same-origin",redirect:"follow"}}function W(E){const F=new Headers;for(const b in E){const y=E[b];typeof y!="undefined"&&F.append(b,y)}return F}class tt{constructor(F){this.source=F,this.isHttp=/^https?:/i.test(F.url),this.httpHeaders=this.isHttp&&F.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var F,b;return(b=(F=this._fullRequestReader)==null?void 0:F._loaded)!=null?b:0}getFullReader(){return(0,S.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new N(this),this._fullRequestReader}getRangeReader(F,b){if(b<=this._progressiveDataLength)return null;const y=new f(this,F,b);return this._rangeRequestReaders.push(y),y}cancelAllRequests(F){this._fullRequestReader&&this._fullRequestReader.cancel(F);for(const b of this._rangeRequestReaders.slice(0))b.cancel(F)}}p.PDFFetchStream=tt;class N{constructor(F){this._stream=F,this._reader=null,this._loaded=0,this._filename=null;const b=F.source;this._withCredentials=b.withCredentials||!1,this._contentLength=b.length,this._headersCapability=(0,S.createPromiseCapability)(),this._disableRange=b.disableRange||!1,this._rangeChunkSize=b.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!b.disableStream,this._isRangeSupported=!b.disableRange,this._headers=W(this._stream.httpHeaders);const y=b.url;fetch(y,Q(this._headers,this._withCredentials,this._abortController)).then(o=>{if(!(0,C.validateResponseStatus)(o.status))throw(0,C.createResponseStatusError)(o.status,y);this._reader=o.body.getReader(),this._headersCapability.resolve();const t=g=>o.headers.get(g),{allowRangeRequests:n,suggestedLength:r}=(0,C.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=n,this._contentLength=r||this._contentLength,this._filename=(0,C.extractFilenameFromHeader)(t),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new S.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:F,done:b}=await this._reader.read();return b?{value:F,done:b}:(this._loaded+=F.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){this._reader&&this._reader.cancel(F),this._abortController.abort()}}class f{constructor(F,b,y){this._stream=F,this._reader=null,this._loaded=0;const o=F.source;this._withCredentials=o.withCredentials||!1,this._readCapability=(0,S.createPromiseCapability)(),this._isStreamingSupported=!o.disableStream,this._abortController=new AbortController,this._headers=W(this._stream.httpHeaders),this._headers.append("Range",`bytes=${b}-${y-1}`);const t=o.url;fetch(t,Q(this._headers,this._withCredentials,this._abortController)).then(n=>{if(!(0,C.validateResponseStatus)(n.status))throw(0,C.createResponseStatusError)(n.status,t);this._readCapability.resolve(),this._reader=n.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:F,done:b}=await this._reader.read();return b?{value:F,done:b}:(this._loaded+=F.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){this._reader&&this._reader.cancel(F),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(it){var p=__webpack_module_cache__[it];if(p!==void 0)return p.exports;var $=__webpack_module_cache__[it]={exports:{}};return __webpack_modules__[it]($,$.exports,__w_pdfjs_require__),$.exports}var __webpack_exports__={};return(()=>{var it=__webpack_exports__;Object.defineProperty(it,"__esModule",{value:!0}),Object.defineProperty(it,"AnnotationEditorLayer",{enumerable:!0,get:function(){return C.AnnotationEditorLayer}}),Object.defineProperty(it,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return p.AnnotationEditorParamsType}}),Object.defineProperty(it,"AnnotationEditorType",{enumerable:!0,get:function(){return p.AnnotationEditorType}}),Object.defineProperty(it,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return Q.AnnotationEditorUIManager}}),Object.defineProperty(it,"AnnotationLayer",{enumerable:!0,get:function(){return W.AnnotationLayer}}),Object.defineProperty(it,"AnnotationMode",{enumerable:!0,get:function(){return p.AnnotationMode}}),Object.defineProperty(it,"CMapCompressionType",{enumerable:!0,get:function(){return p.CMapCompressionType}}),Object.defineProperty(it,"GlobalWorkerOptions",{enumerable:!0,get:function(){return tt.GlobalWorkerOptions}}),Object.defineProperty(it,"InvalidPDFException",{enumerable:!0,get:function(){return p.InvalidPDFException}}),Object.defineProperty(it,"LoopbackPort",{enumerable:!0,get:function(){return $.LoopbackPort}}),Object.defineProperty(it,"MissingPDFException",{enumerable:!0,get:function(){return p.MissingPDFException}}),Object.defineProperty(it,"OPS",{enumerable:!0,get:function(){return p.OPS}}),Object.defineProperty(it,"PDFDataRangeTransport",{enumerable:!0,get:function(){return $.PDFDataRangeTransport}}),Object.defineProperty(it,"PDFDateString",{enumerable:!0,get:function(){return S.PDFDateString}}),Object.defineProperty(it,"PDFWorker",{enumerable:!0,get:function(){return $.PDFWorker}}),Object.defineProperty(it,"PasswordResponses",{enumerable:!0,get:function(){return p.PasswordResponses}}),Object.defineProperty(it,"PermissionFlag",{enumerable:!0,get:function(){return p.PermissionFlag}}),Object.defineProperty(it,"PixelsPerInch",{enumerable:!0,get:function(){return S.PixelsPerInch}}),Object.defineProperty(it,"RenderingCancelledException",{enumerable:!0,get:function(){return S.RenderingCancelledException}}),Object.defineProperty(it,"SVGGraphics",{enumerable:!0,get:function(){return E.SVGGraphics}}),Object.defineProperty(it,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return p.UNSUPPORTED_FEATURES}}),Object.defineProperty(it,"UnexpectedResponseException",{enumerable:!0,get:function(){return p.UnexpectedResponseException}}),Object.defineProperty(it,"Util",{enumerable:!0,get:function(){return p.Util}}),Object.defineProperty(it,"VerbosityLevel",{enumerable:!0,get:function(){return p.VerbosityLevel}}),Object.defineProperty(it,"XfaLayer",{enumerable:!0,get:function(){return F.XfaLayer}}),Object.defineProperty(it,"build",{enumerable:!0,get:function(){return $.build}}),Object.defineProperty(it,"createPromiseCapability",{enumerable:!0,get:function(){return p.createPromiseCapability}}),Object.defineProperty(it,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return p.createValidAbsoluteUrl}}),Object.defineProperty(it,"getDocument",{enumerable:!0,get:function(){return $.getDocument}}),Object.defineProperty(it,"getFilenameFromUrl",{enumerable:!0,get:function(){return S.getFilenameFromUrl}}),Object.defineProperty(it,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return S.getPdfFilenameFromUrl}}),Object.defineProperty(it,"getXfaPageViewport",{enumerable:!0,get:function(){return S.getXfaPageViewport}}),Object.defineProperty(it,"isPdfFile",{enumerable:!0,get:function(){return S.isPdfFile}}),Object.defineProperty(it,"loadScript",{enumerable:!0,get:function(){return S.loadScript}}),Object.defineProperty(it,"renderTextLayer",{enumerable:!0,get:function(){return f.renderTextLayer}}),Object.defineProperty(it,"shadow",{enumerable:!0,get:function(){return p.shadow}}),Object.defineProperty(it,"version",{enumerable:!0,get:function(){return $.version}});var p=__w_pdfjs_require__(1),$=__w_pdfjs_require__(4),S=__w_pdfjs_require__(8),C=__w_pdfjs_require__(22),Q=__w_pdfjs_require__(7),W=__w_pdfjs_require__(27),tt=__w_pdfjs_require__(15),N=__w_pdfjs_require__(3),f=__w_pdfjs_require__(30),E=__w_pdfjs_require__(31),F=__w_pdfjs_require__(29);if(N.isNodeJS){const{PDFNodeStream:b}=__w_pdfjs_require__(32);(0,$.setPDFNetworkStreamFactory)(y=>new b(y))}else{const{PDFNetworkStream:b}=__w_pdfjs_require__(35),{PDFFetchStream:y}=__w_pdfjs_require__(36);(0,$.setPDFNetworkStreamFactory)(o=>(0,S.isValidFetchUrl)(o.url)?new y(o):new b(o))}})(),__webpack_exports__})())})(pdf);const gw_opts=pdf.exports.GlobalWorkerOptions,orig_src=gw_opts==null?void 0:gw_opts.workerSrc;let worker_src=orig_src!=null?orig_src:`https://cdn.jsdelivr.net/npm/pdfjs-dist@${pdf.exports.version}/build/pdf.worker.min.js`;function set_worker_src(it){worker_src=it}const PDFWorker=readable(null,it=>{gw_opts.workerSrc=worker_src;const p=new pdf.exports.PDFWorker;return gw_opts.workerSrc=orig_src,it(p),()=>p.destroy()});var FileSaver_min={exports:{}};(function(it,p){(function($,S){S()})(commonjsGlobal,function(){function $(f,E){return typeof E=="undefined"?E={autoBom:!1}:typeof E!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),E={autoBom:!E}),E.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob(["\uFEFF",f],{type:f.type}):f}function S(f,E,F){var b=new XMLHttpRequest;b.open("GET",f),b.responseType="blob",b.onload=function(){N(b.response,E,F)},b.onerror=function(){console.error("could not download file")},b.send()}function C(f){var E=new XMLHttpRequest;E.open("HEAD",f,!1);try{E.send()}catch{}return 200<=E.status&&299>=E.status}function Q(f){try{f.dispatchEvent(new MouseEvent("click"))}catch{var E=document.createEvent("MouseEvents");E.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),f.dispatchEvent(E)}}var W=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof commonjsGlobal=="object"&&commonjsGlobal.global===commonjsGlobal?commonjsGlobal:void 0,tt=W.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),N=W.saveAs||(typeof window!="object"||window!==W?function(){}:"download"in HTMLAnchorElement.prototype&&!tt?function(f,E,F){var b=W.URL||W.webkitURL,y=document.createElement("a");E=E||f.name||"download",y.download=E,y.rel="noopener",typeof f=="string"?(y.href=f,y.origin===location.origin?Q(y):C(y.href)?S(f,E,F):Q(y,y.target="_blank")):(y.href=b.createObjectURL(f),setTimeout(function(){b.revokeObjectURL(y.href)},4e4),setTimeout(function(){Q(y)},0))}:"msSaveOrOpenBlob"in navigator?function(f,E,F){if(E=E||f.name||"download",typeof f!="string")navigator.msSaveOrOpenBlob($(f,F),E);else if(C(f))S(f,E,F);else{var b=document.createElement("a");b.href=f,b.target="_blank",setTimeout(function(){Q(b)})}}:function(f,E,F,b){if(b=b||open("","_blank"),b&&(b.document.title=b.document.body.innerText="downloading..."),typeof f=="string")return S(f,E,F);var y=f.type==="application/octet-stream",o=/constructor/i.test(W.HTMLElement)||W.safari,t=/CriOS\/[\d]+/.test(navigator.userAgent);if((t||y&&o||tt)&&typeof FileReader!="undefined"){var n=new FileReader;n.onloadend=function(){var m=n.result;m=t?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),b?b.location.href=m:location=m,b=null},n.readAsDataURL(f)}else{var r=W.URL||W.webkitURL,g=r.createObjectURL(f);b?b.location=g:location.href=g,b=null,setTimeout(function(){r.revokeObjectURL(g)},4e4)}});W.saveAs=N.saveAs=N,it.exports=N})})(FileSaver_min);var FileSaver=FileSaver_min.exports,PDF_svelte_svelte_type_style_lang="";export{FileSaver as F,PDFWorker as P,pdf as p,set_worker_src as s};
