var $e=Object.defineProperty,Ye=Object.defineProperties;var Ke=Object.getOwnPropertyDescriptors;var xe=Object.getOwnPropertySymbols;var Je=Object.prototype.hasOwnProperty,Qe=Object.prototype.propertyIsEnumerable;var ae=(X,a,R)=>a in X?$e(X,a,{enumerable:!0,configurable:!0,writable:!0,value:R}):X[a]=R,te=(X,a)=>{for(var R in a||(a={}))Je.call(a,R)&&ae(X,R,a[R]);if(xe)for(var R of xe(a))Qe.call(a,R)&&ae(X,R,a[R]);return X},oe=(X,a)=>Ye(X,Ke(a));var Mt=(X,a,R)=>(ae(X,typeof a!="symbol"?a+"":a,R),R),le=(X,a,R)=>{if(!a.has(X))throw TypeError("Cannot "+R)};var P=(X,a,R)=>(le(X,a,"read from private field"),R?R.call(X):a.get(X)),at=(X,a,R)=>{if(a.has(X))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(X):a.set(X,R)},mt=(X,a,R,u)=>(le(X,a,"write to private field"),u?u.call(X,R):a.set(X,R),R),ce=(X,a,R,u)=>({set _(p){mt(X,a,p,R)},get _(){return P(X,a,u)}}),ht=(X,a,R)=>(le(X,a,"access private method"),R);import{S as SvelteComponent,i as init,s as safe_not_equal,H as create_slot,L as update_slot_base,M as get_all_dirty_from_scope,N as get_slot_changes,q as transition_in,o as transition_out,Q as component_subscribe,P as createEventDispatcher,r as setContext,a6 as onDestroy,aa as not_equal,ab as handle_promise,l as empty,g as insert_hydration,ac as update_await_block_branch,d as detach,F as getContext,E as noop,w as create_component,x as claim_component,y as mount_component,n as group_outros,B as destroy_component,p as check_outros,e as element,t as text,k as space,c as claim_element,a as children,h as claim_text,m as claim_space,b as attr,f as set_style,T as append_hydration,ad as set_input_value,J as listen,ae as to_number,j as set_data}from"./index-f48ee692.js";import{r as readable,w as writable,_ as __vitePreload}from"./preload-helper-780d7a89.js";import{B as Button}from"./TypographyProvider.styles-4c06a18d.js";import{b as base}from"./paths-396f020f.js";var workerUrl="/_app/immutable/assets/pdf.worker.min-99732130.js",commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function getAugmentedNamespace(X){if(X.__esModule)return X;var a=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(X).forEach(function(R){var u=Object.getOwnPropertyDescriptor(X,R);Object.defineProperty(a,R,u.get?u:{enumerable:!0,get:function(){return X[R]}})}),a}function commonjsRequire(X){throw new Error('Could not dynamically require "'+X+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}},__viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$4=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(a,R){module.exports=R()})(globalThis,()=>(()=>{var __webpack_modules__=[,(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.VerbosityLevel=a.Util=a.UnknownErrorException=a.UnexpectedResponseException=a.UNSUPPORTED_FEATURES=a.TextRenderingMode=a.StreamType=a.RenderingIntentFlag=a.PermissionFlag=a.PasswordResponses=a.PasswordException=a.PageActionEventType=a.OPS=a.MissingPDFException=a.LINE_FACTOR=a.LINE_DESCENT_FACTOR=a.InvalidPDFException=a.ImageKind=a.IDENTITY_MATRIX=a.FormatError=a.FontType=a.FeatureTest=a.FONT_IDENTITY_MATRIX=a.DocumentActionEventType=a.CMapCompressionType=a.BaseException=a.AnnotationType=a.AnnotationStateModelType=a.AnnotationReviewState=a.AnnotationReplyType=a.AnnotationMode=a.AnnotationMarkedState=a.AnnotationFlag=a.AnnotationFieldFlag=a.AnnotationEditorType=a.AnnotationEditorPrefix=a.AnnotationEditorParamsType=a.AnnotationBorderStyleType=a.AnnotationActionEventType=a.AbortException=void 0,a.arrayByteLength=st,a.arraysToBytes=dt,a.assert=h,a.bytesToString=F,a.createPromiseCapability=pt,a.createValidAbsoluteUrl=w,a.escapeString=Tt,a.getModificationDate=rt,a.getVerbosityLevel=nt,a.info=ct,a.isArrayBuffer=Ot,a.isArrayEqual=Zt,a.isAscii=Rt,a.objectFromMap=et,a.objectSize=ot,a.setVerbosityLevel=V,a.shadow=O,a.string32=tt,a.stringToBytes=U,a.stringToPDFString=Et,a.stringToUTF16BEString=Ft,a.stringToUTF8String=Xt,a.unreachable=N,a.utf8StringToString=wt,a.warn=bt,R(2);const u=[1,0,0,1,0,0];a.IDENTITY_MATRIX=u;const p=[.001,0,0,.001,0,0];a.FONT_IDENTITY_MATRIX=p;const B=1.35;a.LINE_FACTOR=B;const D=.35;a.LINE_DESCENT_FACTOR=D;const J={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};a.RenderingIntentFlag=J;const L={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};a.AnnotationMode=L;const f="pdfjs_internal_editor_";a.AnnotationEditorPrefix=f;const E={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};a.AnnotationEditorType=E;const k={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};a.AnnotationEditorParamsType=k;const y={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};a.PermissionFlag=y;const v={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};a.TextRenderingMode=v;const r={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};a.ImageKind=r;const t={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};a.AnnotationType=t;const s={MARKED:"Marked",REVIEW:"Review"};a.AnnotationStateModelType=s;const l={MARKED:"Marked",UNMARKED:"Unmarked"};a.AnnotationMarkedState=l;const _={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};a.AnnotationReviewState=_;const b={GROUP:"Group",REPLY:"R"};a.AnnotationReplyType=b;const o={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};a.AnnotationFlag=o;const e={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};a.AnnotationFieldFlag=e;const n={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};a.AnnotationBorderStyleType=n;const d={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};a.AnnotationActionEventType=d;const T={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};a.DocumentActionEventType=T;const S={O:"PageOpen",C:"PageClose"};a.PageActionEventType=S;const m={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};a.StreamType=m;const x={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};a.FontType=x;const Q={ERRORS:0,WARNINGS:1,INFOS:5};a.VerbosityLevel=Q;const it={NONE:0,BINARY:1,STREAM:2};a.CMapCompressionType=it;const Z={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};a.OPS=Z;const Y={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};a.UNSUPPORTED_FEATURES=Y;const W={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};a.PasswordResponses=W;let G=Q.WARNINGS;function V(K){Number.isInteger(K)&&(G=K)}function nt(){return G}function ct(K){G>=Q.INFOS&&console.log(`Info: ${K}`)}function bt(K){G>=Q.WARNINGS&&console.log(`Warning: ${K}`)}function N(K){throw new Error(K)}function h(K,q){K||N(q)}function c(K){if(!K)return!1;switch(K.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function w(K,q=null,H=null){if(!K)return null;try{if(H&&typeof K=="string"){if(H.addDefaultProtocol&&K.startsWith("www.")){const _t=K.match(/\./g);_t&&_t.length>=2&&(K=`http://${K}`)}if(H.tryConvertEncoding)try{K=Xt(K)}catch{}}const gt=q?new URL(K,q):new URL(K);if(c(gt))return gt}catch{}return null}function O(K,q,H){return Object.defineProperty(K,q,{value:H,enumerable:!0,configurable:!0,writable:!1}),H}const I=function(){function q(H,gt){this.constructor===q&&N("Cannot initialize BaseException."),this.message=H,this.name=gt}return q.prototype=new Error,q.constructor=q,q}();a.BaseException=I;class j extends I{constructor(q,H){super(q,"PasswordException"),this.code=H}}a.PasswordException=j;class $ extends I{constructor(q,H){super(q,"UnknownErrorException"),this.details=H}}a.UnknownErrorException=$;class z extends I{constructor(q){super(q,"InvalidPDFException")}}a.InvalidPDFException=z;class i extends I{constructor(q){super(q,"MissingPDFException")}}a.MissingPDFException=i;class g extends I{constructor(q,H){super(q,"UnexpectedResponseException"),this.status=H}}a.UnexpectedResponseException=g;class A extends I{constructor(q){super(q,"FormatError")}}a.FormatError=A;class C extends I{constructor(q){super(q,"AbortException")}}a.AbortException=C;function F(K){(typeof K!="object"||K===null||K.length===void 0)&&N("Invalid argument for bytesToString");const q=K.length,H=8192;if(q<H)return String.fromCharCode.apply(null,K);const gt=[];for(let _t=0;_t<q;_t+=H){const yt=Math.min(_t+H,q),St=K.subarray(_t,yt);gt.push(String.fromCharCode.apply(null,St))}return gt.join("")}function U(K){typeof K!="string"&&N("Invalid argument for stringToBytes");const q=K.length,H=new Uint8Array(q);for(let gt=0;gt<q;++gt)H[gt]=K.charCodeAt(gt)&255;return H}function st(K){if(K.length!==void 0)return K.length;if(K.byteLength!==void 0)return K.byteLength;N("Invalid argument for arrayByteLength")}function dt(K){const q=K.length;if(q===1&&K[0]instanceof Uint8Array)return K[0];let H=0;for(let yt=0;yt<q;yt++)H+=st(K[yt]);let gt=0;const _t=new Uint8Array(H);for(let yt=0;yt<q;yt++){let St=K[yt];St instanceof Uint8Array||(typeof St=="string"?St=U(St):St=new Uint8Array(St));const xt=St.byteLength;_t.set(St,gt),gt+=xt}return _t}function tt(K){return String.fromCharCode(K>>24&255,K>>16&255,K>>8&255,K&255)}function ot(K){return Object.keys(K).length}function et(K){const q=Object.create(null);for(const[H,gt]of K)q[H]=gt;return q}function lt(){const K=new Uint8Array(4);return K[0]=1,new Uint32Array(K.buffer,0,1)[0]===1}function ft(){try{return new Function(""),!0}catch{return!1}}class M{static get isLittleEndian(){return O(this,"isLittleEndian",lt())}static get isEvalSupported(){return O(this,"isEvalSupported",ft())}static get isOffscreenCanvasSupported(){return O(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas!="undefined")}}a.FeatureTest=M;const ut=[...Array(256).keys()].map(K=>K.toString(16).padStart(2,"0"));class At{static makeHexColor(q,H,gt){return`#${ut[q]}${ut[H]}${ut[gt]}`}static scaleMinMax(q,H){let gt;q[0]?(q[0]<0&&(gt=H[0],H[0]=H[1],H[1]=gt),H[0]*=q[0],H[1]*=q[0],q[3]<0&&(gt=H[2],H[2]=H[3],H[3]=gt),H[2]*=q[3],H[3]*=q[3]):(gt=H[0],H[0]=H[2],H[2]=gt,gt=H[1],H[1]=H[3],H[3]=gt,q[1]<0&&(gt=H[2],H[2]=H[3],H[3]=gt),H[2]*=q[1],H[3]*=q[1],q[2]<0&&(gt=H[0],H[0]=H[1],H[1]=gt),H[0]*=q[2],H[1]*=q[2]),H[0]+=q[4],H[1]+=q[4],H[2]+=q[5],H[3]+=q[5]}static transform(q,H){return[q[0]*H[0]+q[2]*H[1],q[1]*H[0]+q[3]*H[1],q[0]*H[2]+q[2]*H[3],q[1]*H[2]+q[3]*H[3],q[0]*H[4]+q[2]*H[5]+q[4],q[1]*H[4]+q[3]*H[5]+q[5]]}static applyTransform(q,H){const gt=q[0]*H[0]+q[1]*H[2]+H[4],_t=q[0]*H[1]+q[1]*H[3]+H[5];return[gt,_t]}static applyInverseTransform(q,H){const gt=H[0]*H[3]-H[1]*H[2],_t=(q[0]*H[3]-q[1]*H[2]+H[2]*H[5]-H[4]*H[3])/gt,yt=(-q[0]*H[1]+q[1]*H[0]+H[4]*H[1]-H[5]*H[0])/gt;return[_t,yt]}static getAxialAlignedBoundingBox(q,H){const gt=At.applyTransform(q,H),_t=At.applyTransform(q.slice(2,4),H),yt=At.applyTransform([q[0],q[3]],H),St=At.applyTransform([q[2],q[1]],H);return[Math.min(gt[0],_t[0],yt[0],St[0]),Math.min(gt[1],_t[1],yt[1],St[1]),Math.max(gt[0],_t[0],yt[0],St[0]),Math.max(gt[1],_t[1],yt[1],St[1])]}static inverseTransform(q){const H=q[0]*q[3]-q[1]*q[2];return[q[3]/H,-q[1]/H,-q[2]/H,q[0]/H,(q[2]*q[5]-q[4]*q[3])/H,(q[4]*q[1]-q[5]*q[0])/H]}static apply3dTransform(q,H){return[q[0]*H[0]+q[1]*H[1]+q[2]*H[2],q[3]*H[0]+q[4]*H[1]+q[5]*H[2],q[6]*H[0]+q[7]*H[1]+q[8]*H[2]]}static singularValueDecompose2dScale(q){const H=[q[0],q[2],q[1],q[3]],gt=q[0]*H[0]+q[1]*H[2],_t=q[0]*H[1]+q[1]*H[3],yt=q[2]*H[0]+q[3]*H[2],St=q[2]*H[1]+q[3]*H[3],xt=(gt+St)/2,Dt=Math.sqrt((gt+St)**2-4*(gt*St-yt*_t))/2,kt=xt+Dt||1,Ct=xt-Dt||1;return[Math.sqrt(kt),Math.sqrt(Ct)]}static normalizeRect(q){const H=q.slice(0);return q[0]>q[2]&&(H[0]=q[2],H[2]=q[0]),q[1]>q[3]&&(H[1]=q[3],H[3]=q[1]),H}static intersect(q,H){const gt=Math.max(Math.min(q[0],q[2]),Math.min(H[0],H[2])),_t=Math.min(Math.max(q[0],q[2]),Math.max(H[0],H[2]));if(gt>_t)return null;const yt=Math.max(Math.min(q[1],q[3]),Math.min(H[1],H[3])),St=Math.min(Math.max(q[1],q[3]),Math.max(H[1],H[3]));return yt>St?null:[gt,yt,_t,St]}static bezierBoundingBox(q,H,gt,_t,yt,St,xt,Dt){const kt=[],Ct=[[],[]];let Lt,It,Ut,Pt,Nt,Wt,zt,Vt;for(let $t=0;$t<2;++$t){if($t===0?(It=6*q-12*gt+6*yt,Lt=-3*q+9*gt-9*yt+3*xt,Ut=3*gt-3*q):(It=6*H-12*_t+6*St,Lt=-3*H+9*_t-9*St+3*Dt,Ut=3*_t-3*H),Math.abs(Lt)<1e-12){if(Math.abs(It)<1e-12)continue;Pt=-Ut/It,0<Pt&&Pt<1&&kt.push(Pt);continue}zt=It*It-4*Ut*Lt,Vt=Math.sqrt(zt),!(zt<0)&&(Nt=(-It+Vt)/(2*Lt),0<Nt&&Nt<1&&kt.push(Nt),Wt=(-It-Vt)/(2*Lt),0<Wt&&Wt<1&&kt.push(Wt))}let Ht=kt.length,jt;const qt=Ht;for(;Ht--;)Pt=kt[Ht],jt=1-Pt,Ct[0][Ht]=jt*jt*jt*q+3*jt*jt*Pt*gt+3*jt*Pt*Pt*yt+Pt*Pt*Pt*xt,Ct[1][Ht]=jt*jt*jt*H+3*jt*jt*Pt*_t+3*jt*Pt*Pt*St+Pt*Pt*Pt*Dt;return Ct[0][qt]=q,Ct[1][qt]=H,Ct[0][qt+1]=xt,Ct[1][qt+1]=Dt,Ct[0].length=Ct[1].length=qt+2,[Math.min(...Ct[0]),Math.min(...Ct[1]),Math.max(...Ct[0]),Math.max(...Ct[1])]}}a.Util=At;const vt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Et(K){if(K[0]>="\xEF"){let H;if(K[0]==="\xFE"&&K[1]==="\xFF"?H="utf-16be":K[0]==="\xFF"&&K[1]==="\xFE"?H="utf-16le":K[0]==="\xEF"&&K[1]==="\xBB"&&K[2]==="\xBF"&&(H="utf-8"),H)try{const gt=new TextDecoder(H,{fatal:!0}),_t=U(K);return gt.decode(_t)}catch(gt){bt(`stringToPDFString: "${gt}".`)}}const q=[];for(let H=0,gt=K.length;H<gt;H++){const _t=vt[K.charCodeAt(H)];q.push(_t?String.fromCharCode(_t):K.charAt(H))}return q.join("")}function Tt(K){return K.replace(/([()\\\n\r])/g,q=>q===`
`?"\\n":q==="\r"?"\\r":`\\${q}`)}function Rt(K){return/^[\x00-\x7F]*$/.test(K)}function Ft(K){const q=["\xFE\xFF"];for(let H=0,gt=K.length;H<gt;H++){const _t=K.charCodeAt(H);q.push(String.fromCharCode(_t>>8&255),String.fromCharCode(_t&255))}return q.join("")}function Xt(K){return decodeURIComponent(escape(K))}function wt(K){return unescape(encodeURIComponent(K))}function Ot(K){return typeof K=="object"&&K!==null&&K.byteLength!==void 0}function Zt(K,q){if(K.length!==q.length)return!1;for(let H=0,gt=K.length;H<gt;H++)if(K[H]!==q[H])return!1;return!0}function rt(K=new Date){return[K.getUTCFullYear().toString(),(K.getUTCMonth()+1).toString().padStart(2,"0"),K.getUTCDate().toString().padStart(2,"0"),K.getUTCHours().toString().padStart(2,"0"),K.getUTCMinutes().toString().padStart(2,"0"),K.getUTCSeconds().toString().padStart(2,"0")].join("")}function pt(){const K=Object.create(null);let q=!1;return Object.defineProperty(K,"settled",{get(){return q}}),K.promise=new Promise(function(H,gt){K.resolve=function(_t){q=!0,H(_t)},K.reject=function(_t){q=!0,gt(_t)}}),K}},(X,a,R)=>{R(3)},(X,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.isNodeJS=void 0;const R=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");a.isNodeJS=R},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var X,R,u,p,B,D,J,L,f,he,k,y;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:r,NodeCMapReaderFactory:t,NodeStandardFontDataFactory:s}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=r,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=t,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=s}let createPDFNetworkStream;function setPDFNetworkStreamFactory(r){createPDFNetworkStream=r}function getDocument(r){const t=new PDFDocumentLoadingTask;let s;if(typeof r=="string"||r instanceof URL)s={url:r};else if((0,_util.isArrayBuffer)(r))s={data:r};else if(r instanceof PDFDataRangeTransport)s={range:r};else{if(typeof r!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!r.url&&!r.data&&!r.range)throw new Error("Invalid parameter object: need either .data, .range or .url");s=r}const l=Object.create(null);let _=null,b=null;for(const e in s){const n=s[e];switch(e){case"url":if(typeof window!="undefined")try{l[e]=new URL(n,window.location).href;continue}catch(d){(0,_util.warn)(`Cannot create valid URL: "${d}".`)}else if(typeof n=="string"||n instanceof URL){l[e]=n.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":_=n;continue;case"worker":b=n;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer!="undefined"&&n instanceof Buffer)l[e]=new Uint8Array(n);else{if(n instanceof Uint8Array)break;if(typeof n=="string")l[e]=(0,_util.stringToBytes)(n);else if(typeof n=="object"&&n!==null&&!isNaN(n.length))l[e]=new Uint8Array(n);else if((0,_util.isArrayBuffer)(n))l[e]=new Uint8Array(n);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}l[e]=n}if(l.CMapReaderFactory=l.CMapReaderFactory||DefaultCMapReaderFactory,l.StandardFontDataFactory=l.StandardFontDataFactory||DefaultStandardFontDataFactory,l.ignoreErrors=l.stopAtErrors!==!0,l.fontExtraProperties=l.fontExtraProperties===!0,l.pdfBug=l.pdfBug===!0,l.enableXfa=l.enableXfa===!0,(!Number.isInteger(l.rangeChunkSize)||l.rangeChunkSize<1)&&(l.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof l.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(l.docBaseUrl))&&(l.docBaseUrl=null),(!Number.isInteger(l.maxImageSize)||l.maxImageSize<-1)&&(l.maxImageSize=-1),typeof l.cMapUrl!="string"&&(l.cMapUrl=null),typeof l.standardFontDataUrl!="string"&&(l.standardFontDataUrl=null),typeof l.useWorkerFetch!="boolean"&&(l.useWorkerFetch=l.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&l.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof l.isEvalSupported!="boolean"&&(l.isEvalSupported=!0),typeof l.disableFontFace!="boolean"&&(l.disableFontFace=_is_node.isNodeJS),typeof l.useSystemFonts!="boolean"&&(l.useSystemFonts=!_is_node.isNodeJS&&!l.disableFontFace),(typeof l.ownerDocument!="object"||l.ownerDocument===null)&&(l.ownerDocument=globalThis.document),typeof l.disableRange!="boolean"&&(l.disableRange=!1),typeof l.disableStream!="boolean"&&(l.disableStream=!1),typeof l.disableAutoFetch!="boolean"&&(l.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(l.verbosity),!b){const e={verbosity:l.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};b=e.port?PDFWorker.fromPort(e):new PDFWorker(e),t._worker=b}const o=t.docId;return b.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");const e=_fetchDocument(b,l,_,o),n=new Promise(function(d){let T;_?T=new _transport_stream.PDFDataTransportStream({length:l.length,initialData:l.initialData,progressiveDone:l.progressiveDone,contentDispositionFilename:l.contentDispositionFilename,disableRange:l.disableRange,disableStream:l.disableStream},_):l.data||(T=createPDFNetworkStream({url:l.url,length:l.length,httpHeaders:l.httpHeaders,withCredentials:l.withCredentials,rangeChunkSize:l.rangeChunkSize,disableRange:l.disableRange,disableStream:l.disableStream})),d(T)});return Promise.all([e,n]).then(function([d,T]){if(t.destroyed)throw new Error("Loading aborted");const S=new _message_handler.MessageHandler(o,d,b.port),m=new WorkerTransport(S,t,T,l);t._transport=m,S.send("Ready",null)})}).catch(t._capability.reject),t}async function _fetchDocument(r,t,s,l){if(r.destroyed)throw new Error("Worker was destroyed");s&&(t.length=s.length,t.initialData=s.initialData,t.progressiveDone=s.progressiveDone,t.contentDispositionFilename=s.contentDispositionFilename);const _=await r.messageHandler.sendWithPromise("GetDocRequest",{docId:l,apiVersion:"2.16.105",source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,docBaseUrl:t.docBaseUrl,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported,fontExtraProperties:t.fontExtraProperties,enableXfa:t.enableXfa,useSystemFonts:t.useSystemFonts,cMapUrl:t.useWorkerFetch?t.cMapUrl:null,standardFontDataUrl:t.useWorkerFetch?t.standardFontDataUrl:null});if(t.data&&(t.data=null),r.destroyed)throw new Error("Worker was destroyed");return _}const a=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${ce(a,X)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var t;this.destroyed=!0,await((t=this._transport)==null?void 0:t.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=a;X=new WeakMap,at(PDFDocumentLoadingTask,X,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(t,s,l=!1,_=null){this.length=t,this.initialData=s,this.progressiveDone=l,this.contentDispositionFilename=_,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,s){for(const l of this._rangeListeners)l(t,s)}onDataProgress(t,s){this._readyCapability.promise.then(()=>{for(const l of this._progressListeners)l(t,s)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const s of this._progressiveReadListeners)s(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,s){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,s){this._pdfInfo=t,this._transport=s,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(t,s,l,_,b=!1){this._pageIndex=t,this._pageInfo=s,this._ownerDocument=_,this._transport=l,this._stats=b?new _display_utils.StatTimer:null,this._pdfBug=b,this.commonObjs=l.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:s=this.rotate,offsetX:l=0,offsetY:_=0,dontFlip:b=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:s,offsetX:l,offsetY:_,dontFlip:b})}getAnnotations({intent:t="display"}={}){const s=this._transport.getRenderingIntent(t);let l=this._annotationPromises.get(s.cacheKey);return l||(l=this._transport.getAnnotations(this._pageIndex,s.renderingIntent),this._annotationPromises.set(s.cacheKey,l),l=l.then(_=>{for(const b of _)b.titleObj!==void 0&&Object.defineProperty(b,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),b.titleObj.str}}),b.contentsObj!==void 0&&Object.defineProperty(b,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),b.contentsObj.str}});return _})),l}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:s,intent:l="display",annotationMode:_=_util.AnnotationMode.ENABLE,transform:b=null,imageLayer:o=null,canvasFactory:e=null,background:n=null,optionalContentConfigPromise:d=null,annotationCanvasMap:T=null,pageColors:S=null,printAnnotationStorage:m=null}){var V,nt;((V=arguments[0])==null?void 0:V.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&_===_util.AnnotationMode.ENABLE&&(_=_util.AnnotationMode.ENABLE_FORMS)),((nt=arguments[0])==null?void 0:nt.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&_===_util.AnnotationMode.ENABLE&&(_=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const x=this._transport.getRenderingIntent(l,_,m);this.pendingCleanup=!1,d||(d=this._transport.getOptionalContentConfig());let Q=this._intentStates.get(x.cacheKey);Q||(Q=Object.create(null),this._intentStates.set(x.cacheKey,Q)),Q.streamReaderCancelTimeout&&(clearTimeout(Q.streamReaderCancelTimeout),Q.streamReaderCancelTimeout=null);const it=e||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),Z=!!(x.renderingIntent&_util.RenderingIntentFlag.PRINT);Q.displayReadyCapability||(Q.displayReadyCapability=(0,_util.createPromiseCapability)(),Q.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(x));const Y=ct=>{Q.renderTasks.delete(W),(this.cleanupAfterRender||Z)&&(this.pendingCleanup=!0),this._tryCleanup(),ct?(W.capability.reject(ct),this._abortOperatorList({intentState:Q,reason:ct instanceof Error?ct:new Error(ct)})):W.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},W=new InternalRenderTask({callback:Y,params:{canvasContext:t,viewport:s,transform:b,imageLayer:o,background:n},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:T,operatorList:Q.operatorList,pageIndex:this._pageIndex,canvasFactory:it,useRequestAnimationFrame:!Z,pdfBug:this._pdfBug,pageColors:S});(Q.renderTasks||(Q.renderTasks=new Set)).add(W);const G=W.task;return Promise.all([Q.displayReadyCapability.promise,d]).then(([ct,bt])=>{if(this.pendingCleanup){Y();return}this._stats&&this._stats.time("Rendering"),W.initializeGraphics({transparency:ct,optionalContentConfig:bt}),W.operatorListChanged()}).catch(Y),G}getOperatorList({intent:t="display",annotationMode:s=_util.AnnotationMode.ENABLE,printAnnotationStorage:l=null}={}){function _(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(e))}const b=this._transport.getRenderingIntent(t,s,l,!0);let o=this._intentStates.get(b.cacheKey);o||(o=Object.create(null),this._intentStates.set(b.cacheKey,o));let e;return o.opListReadCapability||(e=Object.create(null),e.operatorListChanged=_,o.opListReadCapability=(0,_util.createPromiseCapability)(),(o.renderTasks||(o.renderTasks=new Set)).add(e),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(b)),o.opListReadCapability.promise}streamTextContent({disableCombineTextItems:t=!1,includeMarkedContent:s=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:t!==!0,includeMarkedContent:s===!0},{highWaterMark:100,size(_){return _.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(l=>_xfa_text.XfaText.textContent(l));const s=this.streamTextContent(t);return new Promise(function(l,_){function b(){o.read().then(function({value:n,done:d}){if(d){l(e);return}Object.assign(e.styles,n.styles),e.items.push(...n.items),b()},_)}const o=s.getReader(),e={items:[],styles:Object.create(null)};b()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const t=[];for(const s of this._intentStates.values())if(this._abortOperatorList({intentState:s,reason:new Error("Page was destroyed."),force:!0}),!s.opListReadCapability)for(const l of s.renderTasks)t.push(l.completed),l.cancel();this.objs.clear();for(const s of this._bitmaps)s.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(t)}cleanup(t=!1){return this.pendingCleanup=!0,this._tryCleanup(t)}_tryCleanup(t=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:s,operatorList:l}of this._intentStates.values())if(s.size>0||!l.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,t&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const s of this._bitmaps)s.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(t,s){const l=this._intentStates.get(s);!l||(this._stats&&this._stats.timeEnd("Page Request"),l.displayReadyCapability&&l.displayReadyCapability.resolve(t))}_renderPageChunk(t,s){for(let l=0,_=t.length;l<_;l++)s.operatorList.fnArray.push(t.fnArray[l]),s.operatorList.argsArray.push(t.argsArray[l]);s.operatorList.lastChunk=t.lastChunk,s.operatorList.separateAnnots=t.separateAnnots;for(const l of s.renderTasks)l.operatorListChanged();t.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:t,cacheKey:s,annotationStorageMap:l}){const b=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:s,annotationStorage:l}).getReader(),o=this._intentStates.get(s);o.streamReader=b;const e=()=>{b.read().then(({value:n,done:d})=>{if(d){o.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(n,o),e())},n=>{if(o.streamReader=null,!this._transport.destroyed){if(o.operatorList){o.operatorList.lastChunk=!0;for(const d of o.renderTasks)d.operatorListChanged();this._tryCleanup()}if(o.displayReadyCapability)o.displayReadyCapability.reject(n);else if(o.opListReadCapability)o.opListReadCapability.reject(n);else throw n}})};e()}_abortOperatorList({intentState:t,reason:s,force:l=!1}){if(!!t.streamReader){if(!l){if(t.renderTasks.size>0)return;if(s instanceof _display_utils.RenderingCancelledException){t.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:t,reason:s,force:!0}),t.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(t.streamReader.cancel(new _util.AbortException(s.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[_,b]of this._intentStates)if(b===t){this._intentStates.delete(_);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(t,s){const l={data:structuredClone(t,s)};this._deferred.then(()=>{for(const _ of this._listeners)_.call(this,l)})}addEventListener(t,s){this._listeners.push(s)}removeEventListener(t,s){const l=this._listeners.indexOf(s);this._listeners.splice(l,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const r=(R=document==null?void 0:document.currentScript)==null?void 0:R.src;r&&(PDFWorkerUtil.fallbackWorkerSrc=r.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(r,t){let s;try{if(s=new URL(r),!s.origin||s.origin==="null")return!1}catch{return!1}const l=new URL(t,s);return s.origin===l.origin},PDFWorkerUtil.createCDNWrapper=function(r){const t=`importScripts("${r}");`;return URL.createObjectURL(new Blob([t]))}}const _PDFWorker=class{constructor({name:r=null,port:t=null,verbosity:s=(0,_util.getVerbosityLevel)()}={}){if(t&&P(_PDFWorker,u).has(t))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=r,this.destroyed=!1,this.verbosity=s,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,t){P(_PDFWorker,u).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(r){this._port=r,this._messageHandler=new _message_handler.MessageHandler("main","worker",r),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:r}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,r)||(r=PDFWorkerUtil.createCDNWrapper(new URL(r,window.location).href));const t=new Worker(r),s=new _message_handler.MessageHandler("main","worker",t),l=()=>{t.removeEventListener("error",_),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},_=()=>{this._webWorker||l()};t.addEventListener("error",_),s.on("test",o=>{if(t.removeEventListener("error",_),this.destroyed){l();return}o?(this._messageHandler=s,this._port=t,this._webWorker=t,this._readyCapability.resolve(),s.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),s.destroy(),t.terminate())}),s.on("ready",o=>{if(t.removeEventListener("error",_),this.destroyed){l();return}try{b()}catch{this._setupFakeWorker()}});const b=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};b();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(r=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new LoopbackPort;this._port=t;const s=`fake${PDFWorkerUtil.fakeWorkerId++}`,l=new _message_handler.MessageHandler(s+"_worker",s,t);r.setup(l,t);const _=new _message_handler.MessageHandler(s,s+"_worker",t);this._messageHandler=_,this._readyCapability.resolve(),_.send("configure",{verbosity:this.verbosity})}).catch(r=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${r.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),P(_PDFWorker,u).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(r){if(!(r!=null&&r.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return P(this,u).has(r.port)?P(this,u).get(r.port):new _PDFWorker(r)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var r;try{return((r=globalThis.pdfjsWorker)==null?void 0:r.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;u=new WeakMap,at(PDFWorker,u,new WeakMap),exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(t,s,l,_){at(this,p,null);at(this,B,new Map);at(this,D,new Map);at(this,J,null);this.messageHandler=t,this.loadingTask=s,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:s.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:_.ownerDocument,styleElement:_.styleElement}),this._params=_,_.useWorkerFetch||(this.CMapReaderFactory=new _.CMapReaderFactory({baseUrl:_.cMapUrl,isCompressed:_.cMapPacked}),this.StandardFontDataFactory=new _.StandardFontDataFactory({baseUrl:_.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=l,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return P(this,p)}getRenderingIntent(t,s=_util.AnnotationMode.ENABLE,l=null,_=!1){let b=_util.RenderingIntentFlag.DISPLAY,o=null;switch(t){case"any":b=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":b=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(s){case _util.AnnotationMode.DISABLE:b+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:b+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:b+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,o=(b&_util.RenderingIntentFlag.PRINT&&l instanceof _annotation_storage.PrintAnnotationStorage?l:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${s}`)}return _&&(b+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:b,cacheKey:`${b}_${_annotation_storage.AnnotationStorage.getHash(o)}`,annotationStorageMap:o}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const l of P(this,B).values())t.push(l._destroy());P(this,B).clear(),P(this,D).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const s=this.messageHandler.sendWithPromise("Terminate",null);return t.push(s),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),mt(this,J,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:s}=this;t.on("GetReader",(l,_)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=b=>{this._lastProgress={loaded:b.loaded,total:b.total}},_.onPull=()=>{this._fullReader.read().then(function({value:b,done:o}){if(o){_.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(b),"GetReader - expected an ArrayBuffer."),_.enqueue(new Uint8Array(b),1,[b])}).catch(b=>{_.error(b)})},_.onCancel=b=>{this._fullReader.cancel(b),_.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",l=>{const _=(0,_util.createPromiseCapability)(),b=this._fullReader;return b.headersReady.then(()=>{var o;(!b.isStreamingSupported||!b.isRangeSupported)&&(this._lastProgress&&((o=s.onProgress)==null||o.call(s,this._lastProgress)),b.onProgress=e=>{var n;(n=s.onProgress)==null||n.call(s,{loaded:e.loaded,total:e.total})}),_.resolve({isStreamingSupported:b.isStreamingSupported,isRangeSupported:b.isRangeSupported,contentLength:b.contentLength})},_.reject),_.promise}),t.on("GetRangeReader",(l,_)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const b=this._networkStream.getRangeReader(l.begin,l.end);if(!b){_.close();return}_.onPull=()=>{b.read().then(function({value:o,done:e}){if(e){_.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(o),"GetRangeReader - expected an ArrayBuffer."),_.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{_.error(o)})},_.onCancel=o=>{b.cancel(o),_.ready.catch(e=>{if(!this.destroyed)throw e})}}),t.on("GetDoc",({pdfInfo:l})=>{this._numPages=l.numPages,this._htmlForXfa=l.htmlForXfa,delete l.htmlForXfa,s._capability.resolve(new PDFDocumentProxy(l,this))}),t.on("DocException",function(l){let _;switch(l.name){case"PasswordException":_=new _util.PasswordException(l.message,l.code);break;case"InvalidPDFException":_=new _util.InvalidPDFException(l.message);break;case"MissingPDFException":_=new _util.MissingPDFException(l.message);break;case"UnexpectedResponseException":_=new _util.UnexpectedResponseException(l.message,l.status);break;case"UnknownErrorException":_=new _util.UnknownErrorException(l.message,l.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}s._capability.reject(_)}),t.on("PasswordRequest",l=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),s.onPassword){const _=b=>{b instanceof Error?this._passwordCapability.reject(b):this._passwordCapability.resolve({password:b})};try{s.onPassword(_,l.code)}catch(b){this._passwordCapability.reject(b)}}else this._passwordCapability.reject(new _util.PasswordException(l.message,l.code));return this._passwordCapability.promise}),t.on("DataLoaded",l=>{var _;(_=s.onProgress)==null||_.call(s,{loaded:l.length,total:l.length}),this.downloadInfoCapability.resolve(l)}),t.on("StartRenderPage",l=>{if(this.destroyed)return;P(this,B).get(l.pageIndex)._startRenderPage(l.transparency,l.cacheKey)}),t.on("commonobj",([l,_,b])=>{var o;if(!this.destroyed&&!this.commonObjs.has(l))switch(_){case"Font":const e=this._params;if("error"in b){const T=b.error;(0,_util.warn)(`Error during font loading: ${T}`),this.commonObjs.resolve(l,T);break}let n=null;e.pdfBug&&((o=globalThis.FontInspector)==null?void 0:o.enabled)&&(n={registerFont(T,S){globalThis.FontInspector.fontAdded(T,S)}});const d=new _font_loader.FontFaceObject(b,{isEvalSupported:e.isEvalSupported,disableFontFace:e.disableFontFace,ignoreErrors:e.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:n});this.fontLoader.bind(d).catch(T=>t.sendWithPromise("FontFallback",{id:l})).finally(()=>{!e.fontExtraProperties&&d.data&&(d.data=null),this.commonObjs.resolve(l,d)});break;case"FontPath":case"Image":this.commonObjs.resolve(l,b);break;default:throw new Error(`Got unknown common object type ${_}`)}}),t.on("obj",([l,_,b,o])=>{var n;if(this.destroyed)return;const e=P(this,B).get(_);if(!e.objs.has(l))switch(b){case"Image":e.objs.resolve(l,o);const d=8e6;if(o){let T;if(o.bitmap){const{bitmap:S,width:m,height:x}=o;T=m*x*4,e._bitmaps.add(S)}else T=((n=o.data)==null?void 0:n.length)||0;T>d&&(e.cleanupAfterRender=!0)}break;case"Pattern":e.objs.resolve(l,o);break;default:throw new Error(`Got unknown object type ${b}`)}}),t.on("DocProgress",l=>{var _;this.destroyed||(_=s.onProgress)==null||_.call(s,{loaded:l.loaded,total:l.total})}),t.on("DocStats",l=>{this.destroyed||mt(this,p,Object.freeze({streamTypes:Object.freeze(l.streamTypes),fontTypes:Object.freeze(l.fontTypes)}))}),t.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),t.on("FetchBuiltInCMap",l=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(l):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",l=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(l):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:t}){var s,l;this.destroyed||(l=(s=this.loadingTask).onUnsupportedFeature)==null||l.call(s,t)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const s=t-1,l=P(this,D).get(s);if(l)return l;const _=this.messageHandler.sendWithPromise("GetPage",{pageIndex:s}).then(b=>{if(this.destroyed)throw new Error("Transport destroyed");const o=new PDFPageProxy(s,b,this,this._params.ownerDocument,this._params.pdfBug);return P(this,B).set(s,o),o});return P(this,D).set(s,_),_}getPageIndex(t){return typeof t!="object"||t===null||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,s){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:s})}saveDocument(){var t,s;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:(s=(t=this._fullReader)==null?void 0:t.filename)!=null?s:null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(t=>new _optional_content_config.OptionalContentConfig(t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return P(this,J)||mt(this,J,this.messageHandler.sendWithPromise("GetMetadata",null).then(t=>{var s,l,_,b;return{info:t[0],metadata:t[1]?new _metadata.Metadata(t[1]):null,contentDispositionFilename:(l=(s=this._fullReader)==null?void 0:s.filename)!=null?l:null,contentLength:(b=(_=this._fullReader)==null?void 0:_.contentLength)!=null?b:null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const s of P(this,B).values())if(!s.cleanup())throw new Error(`startCleanup: Page ${s.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),mt(this,J,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const t=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t.disableAutoFetch,enableXfa:t.enableXfa})}}p=new WeakMap,B=new WeakMap,D=new WeakMap,J=new WeakMap;class PDFObjects{constructor(){at(this,f);at(this,L,Object.create(null))}get(t,s=null){if(s){const _=ht(this,f,he).call(this,t);return _.capability.promise.then(()=>s(_.data)),null}const l=P(this,L)[t];if(!(l!=null&&l.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${t}.`);return l.data}has(t){const s=P(this,L)[t];return(s==null?void 0:s.capability.settled)||!1}resolve(t,s=null){const l=ht(this,f,he).call(this,t);l.data=s,l.capability.resolve()}clear(){mt(this,L,Object.create(null))}}L=new WeakMap,f=new WeakSet,he=function(t){const s=P(this,L)[t];return s||(P(this,L)[t]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(t){at(this,k,null);mt(this,k,t),this.onContinue=null}get promise(){return P(this,k).capability.promise}cancel(){P(this,k).cancel()}get separateAnnots(){const{separateAnnots:t}=P(this,k).operatorList;if(!t)return!1;const{annotationCanvasMap:s}=P(this,k);return t.form||t.canvas&&(s==null?void 0:s.size)>0}}k=new WeakMap,exports.RenderTask=RenderTask;const v=class{constructor({callback:t,params:s,objs:l,commonObjs:_,annotationCanvasMap:b,operatorList:o,pageIndex:e,canvasFactory:n,useRequestAnimationFrame:d=!1,pdfBug:T=!1,pageColors:S=null}){this.callback=t,this.params=s,this.objs=l,this.commonObjs=_,this.annotationCanvasMap=b,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=e,this.canvasFactory=n,this._pdfBug=T,this.pageColors=S,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window!="undefined",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=s.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:s}){var n;if(this.cancelled)return;if(this._canvas){if(P(v,y).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");P(v,y).add(this._canvas)}this._pdfBug&&((n=globalThis.StepperManager)==null?void 0:n.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:l,viewport:_,transform:b,imageLayer:o,background:e}=this.params;this.gfx=new _canvas.CanvasGraphics(l,this.commonObjs,this.objs,this.canvasFactory,o,s,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:b,viewport:_,transparency:t,background:e}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(t=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&P(v,y).delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&P(v,y).delete(this._canvas),this.callback())))}};let InternalRenderTask=v;y=new WeakMap,at(InternalRenderTask,y,new WeakSet);const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(X,a,R)=>{var L,Pe,E;Object.defineProperty(a,"__esModule",{value:!0}),a.PrintAnnotationStorage=a.AnnotationStorage=void 0;var u=R(1),p=R(6),B=R(10);class D{constructor(){at(this,L);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(y,v){const r=this._storage.get(y);return r===void 0?v:Object.assign(v,r)}getRawValue(y){return this._storage.get(y)}remove(y){if(this._storage.delete(y),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const v of this._storage.values())if(v instanceof p.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(y,v){const r=this._storage.get(y);let t=!1;if(r!==void 0)for(const[s,l]of Object.entries(v))r[s]!==l&&(t=!0,r[s]=l);else t=!0,this._storage.set(y,v);t&&ht(this,L,Pe).call(this),v instanceof p.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(v.constructor._type)}has(y){return this._storage.has(y)}getAll(){return this._storage.size>0?(0,u.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new J(this)}get serializable(){if(this._storage.size===0)return null;const y=new Map;for(const[v,r]of this._storage){const t=r instanceof p.AnnotationEditor?r.serialize():r;t&&y.set(v,t)}return y}static getHash(y){if(!y)return"";const v=new B.MurmurHash3_64;for(const[r,t]of y)v.update(`${r}:${JSON.stringify(t)}`);return v.hexdigest()}}L=new WeakSet,Pe=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},a.AnnotationStorage=D;class J extends D{constructor(v){super();at(this,E,null);mt(this,E,structuredClone(v.serializable))}get print(){(0,u.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return P(this,E)}}E=new WeakMap,a.PrintAnnotationStorage=J},(X,a,R)=>{var D,J,L,f,E,k;Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationEditor=void 0;var u=R(7),p=R(1);const y=class{constructor(r){at(this,D,this.focusin.bind(this));at(this,J,this.focusout.bind(this));at(this,L,!1);at(this,f,!1);at(this,E,!1);at(this,k,y._zIndex++);this.constructor===y&&(0,p.unreachable)("Cannot initialize AnnotationEditor."),this.parent=r.parent,this.id=r.id,this.width=this.height=null,this.pageIndex=r.parent.pageIndex,this.name=r.name,this.div=null;const[t,s]=this.parent.viewportBaseDimensions;this.x=r.x/t,this.y=r.y/s,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,p.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=P(this,k)}focusin(r){P(this,L)?mt(this,L,!1):this.parent.setSelected(this)}focusout(r){if(!this.isAttachedToDOM)return;const t=r.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(r.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(r){const t=this.parent.div.getBoundingClientRect();this.startX=r.clientX-t.x,this.startY=r.clientY-t.y,r.dataTransfer.setData("text/plain",this.id),r.dataTransfer.effectAllowed="move"}setAt(r,t,s,l){const[_,b]=this.parent.viewportBaseDimensions;[s,l]=this.screenToPageTranslation(s,l),this.x=(r+s)/_,this.y=(t+l)/b,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(r,t){const[s,l]=this.parent.viewportBaseDimensions;[r,t]=this.screenToPageTranslation(r,t),this.x+=r/s,this.y+=t/l,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(r,t){const{rotation:s}=this.parent.viewport;switch(s){case 90:return[t,-r];case 180:return[-r,-t];case 270:return[-t,r];default:return[r,t]}}setDims(r,t){const[s,l]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*r/s}%`,this.div.style.height=`${100*t/l}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",P(this,D)),this.div.addEventListener("focusout",P(this,J));const[r,t]=this.getInitialTranslation();return this.translate(r,t),(0,u.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(r){const t=u.KeyboardManager.platform.isMac;if(r.button!==0||r.ctrlKey&&t){r.preventDefault();return}r.ctrlKey&&!t||r.shiftKey||r.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this),mt(this,L,!0)}getRect(r,t){const[s,l]=this.parent.viewportBaseDimensions,[_,b]=this.parent.pageDimensions,o=_*r/s,e=b*t/l,n=this.x*_,d=this.y*b,T=this.width*_,S=this.height*b;switch(this.rotation){case 0:return[n+o,b-d-e-S,n+o+T,b-d-e];case 90:return[n+e,b-d+o,n+e+S,b-d+o+T];case 180:return[n-o-T,b-d+e,n-o,b-d+e+S];case 270:return[n-e-S,b-d-o-T,n-e,b-d-o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(r,t){const[s,l,_,b]=r,o=_-s,e=b-l;switch(this.rotation){case 0:return[s,t-b,o,e];case 90:return[s,t-l,e,o];case 180:return[_,t-l,o,e];case 270:return[_,t-b,e,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){mt(this,E,!0)}disableEditMode(){mt(this,E,!1)}isInEditMode(){return P(this,E)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var r;(r=this.div)==null||r.addEventListener("focusin",P(this,D))}serialize(){(0,p.unreachable)("An editor must be serializable")}static deserialize(r,t){const s=new this.prototype.constructor({parent:t,id:t.getNextId()});s.rotation=r.rotation;const[l,_]=t.pageDimensions,[b,o,e,n]=s.getRectInCurrentCoords(r.rect,_);return s.x=b/l,s.y=o/_,s.width=e/l,s.height=n/_,s}remove(){this.div.removeEventListener("focusin",P(this,D)),this.div.removeEventListener("focusout",P(this,J)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var r;(r=this.div)==null||r.classList.add("selectedEditor")}unselect(){var r;(r=this.div)==null||r.classList.remove("selectedEditor")}updateParams(r,t){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return P(this,f)}set isEditing(r){mt(this,f,r),r?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let B=y;D=new WeakMap,J=new WeakMap,L=new WeakMap,f=new WeakMap,E=new WeakMap,k=new WeakMap,Mt(B,"_colorManager",new u.ColorManager),Mt(B,"_zIndex",1),a.AnnotationEditor=B},(X,a,R)=>{var v,r,t,s,l,_,ke,e,d,T,S,m,x,Q,it,Z,Y,W,G,V,nt,ct,bt,N,h,c,Fe,O,de,j,Bt,z,Jt,g,Re,C,Me,U,ue,dt,Qt,ot,ee;Object.defineProperty(a,"__esModule",{value:!0}),a.KeyboardManager=a.CommandManager=a.ColorManager=a.AnnotationEditorUIManager=void 0,a.bindEvents=B,a.opacityToHex=D;var u=R(1),p=R(8);function B(ft,M,ut){for(const At of ut)M.addEventListener(At,ft[At].bind(ft))}function D(ft){return Math.round(Math.min(255,Math.max(1,255*ft))).toString(16).padStart(2,"0")}class J{constructor(){at(this,v,0)}getId(){return`${u.AnnotationEditorPrefix}${ce(this,v)._++}`}}v=new WeakMap;class L{constructor(M=128){at(this,r,[]);at(this,t,!1);at(this,s,void 0);at(this,l,-1);mt(this,s,M)}add({cmd:M,undo:ut,mustExec:At,type:vt=NaN,overwriteIfSameType:Et=!1,keepUndo:Tt=!1}){if(At&&M(),P(this,t))return;const Rt={cmd:M,undo:ut,type:vt};if(P(this,l)===-1){P(this,r).length>0&&(P(this,r).length=0),mt(this,l,0),P(this,r).push(Rt);return}if(Et&&P(this,r)[P(this,l)].type===vt){Tt&&(Rt.undo=P(this,r)[P(this,l)].undo),P(this,r)[P(this,l)]=Rt;return}const Ft=P(this,l)+1;Ft===P(this,s)?P(this,r).splice(0,1):(mt(this,l,Ft),Ft<P(this,r).length&&P(this,r).splice(Ft)),P(this,r).push(Rt)}undo(){P(this,l)!==-1&&(mt(this,t,!0),P(this,r)[P(this,l)].undo(),mt(this,t,!1),mt(this,l,P(this,l)-1))}redo(){P(this,l)<P(this,r).length-1&&(mt(this,l,P(this,l)+1),mt(this,t,!0),P(this,r)[P(this,l)].cmd(),mt(this,t,!1))}hasSomethingToUndo(){return P(this,l)!==-1}hasSomethingToRedo(){return P(this,l)<P(this,r).length-1}destroy(){mt(this,r,null)}}r=new WeakMap,t=new WeakMap,s=new WeakMap,l=new WeakMap,a.CommandManager=L;const o=class{constructor(M){at(this,_);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const ut=o.platform.isMac;for(const[At,vt]of M)for(const Et of At){const Tt=Et.startsWith("mac+");ut&&Tt?(this.callbacks.set(Et.slice(4),vt),this.allKeys.add(Et.split("+").at(-1))):!ut&&!Tt&&(this.callbacks.set(Et,vt),this.allKeys.add(Et.split("+").at(-1)))}}static get platform(){const M=typeof navigator!="undefined"?navigator.platform:"";return(0,u.shadow)(this,"platform",{isWin:M.includes("Win"),isMac:M.includes("Mac")})}exec(M,ut){if(!this.allKeys.has(ut.key))return;const At=this.callbacks.get(ht(this,_,ke).call(this,ut));!At||(At.bind(M)(),ut.stopPropagation(),ut.preventDefault())}};let f=o;_=new WeakSet,ke=function(M){M.altKey&&this.buffer.push("alt"),M.ctrlKey&&this.buffer.push("ctrl"),M.metaKey&&this.buffer.push("meta"),M.shiftKey&&this.buffer.push("shift"),this.buffer.push(M.key);const ut=this.buffer.join("+");return this.buffer.length=0,ut},a.KeyboardManager=f;class E{constructor(){at(this,e,null)}copy(M){!M||(Array.isArray(M)?mt(this,e,M.map(ut=>ut.serialize())):mt(this,e,[M.serialize()]),mt(this,e,P(this,e).filter(ut=>!!ut)),P(this,e).length===0&&mt(this,e,null))}paste(){return P(this,e)}isEmpty(){return P(this,e)===null}destroy(){mt(this,e,null)}}e=new WeakMap;const n=class{get _colors(){const M=new Map([["CanvasText",null],["Canvas",null]]);return(0,p.getColorValues)(M),(0,u.shadow)(this,"_colors",M)}convert(M){const ut=(0,p.getRGB)(M);if(!window.matchMedia("(forced-colors: active)").matches)return ut;for(const[At,vt]of this._colors)if(vt.every((Et,Tt)=>Et===ut[Tt]))return n._colorsMapping.get(At);return ut}getHexCode(M){const ut=this._colors.get(M);return ut?u.Util.makeHexColor(...ut):M}};let k=n;Mt(k,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),a.ColorManager=k;const lt=class{constructor(M,ut){at(this,c);at(this,O);at(this,j);at(this,z);at(this,g);at(this,C);at(this,U);at(this,dt);at(this,ot);at(this,d,null);at(this,T,new Map);at(this,S,new Map);at(this,m,new E);at(this,x,new L);at(this,Q,0);at(this,it,null);at(this,Z,null);at(this,Y,new J);at(this,W,!1);at(this,G,u.AnnotationEditorType.NONE);at(this,V,new Set);at(this,nt,this.keydown.bind(this));at(this,ct,this.onEditingAction.bind(this));at(this,bt,this.onPageChanging.bind(this));at(this,N,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});at(this,h,null);mt(this,h,M),mt(this,Z,ut),P(this,Z)._on("editingaction",P(this,ct)),P(this,Z)._on("pagechanging",P(this,bt))}destroy(){ht(this,O,de).call(this),P(this,Z)._off("editingaction",P(this,ct)),P(this,Z)._off("pagechanging",P(this,bt));for(const M of P(this,S).values())M.destroy();P(this,S).clear(),P(this,T).clear(),mt(this,d,null),P(this,V).clear(),P(this,m).destroy(),P(this,x).destroy()}onPageChanging({pageNumber:M}){mt(this,Q,M-1)}focusMainContainer(){P(this,h).focus()}keydown(M){var ut;(ut=this.getActive())!=null&&ut.shouldGetKeyboardEvents()||lt._keyboardManager.exec(this,M)}onEditingAction(M){["undo","redo","cut","copy","paste","delete","selectAll"].includes(M.name)&&this[M.name]()}setEditingState(M){M?(ht(this,c,Fe).call(this),ht(this,j,Bt).call(this,{isEditing:P(this,G)!==u.AnnotationEditorType.NONE,isEmpty:ht(this,dt,Qt).call(this),hasSomethingToUndo:P(this,x).hasSomethingToUndo(),hasSomethingToRedo:P(this,x).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:P(this,m).isEmpty()})):(ht(this,O,de).call(this),ht(this,j,Bt).call(this,{isEditing:!1}))}registerEditorTypes(M){mt(this,it,M);for(const ut of P(this,it))ht(this,z,Jt).call(this,ut.defaultPropertiesToUpdate)}getId(){return P(this,Y).getId()}addLayer(M){P(this,S).set(M.pageIndex,M),P(this,W)?M.enable():M.disable()}removeLayer(M){P(this,S).delete(M.pageIndex)}updateMode(M){if(mt(this,G,M),M===u.AnnotationEditorType.NONE)this.setEditingState(!1),ht(this,C,Me).call(this);else{this.setEditingState(!0),ht(this,g,Re).call(this);for(const ut of P(this,S).values())ut.updateMode(M)}}updateToolbar(M){M!==P(this,G)&&P(this,Z).dispatch("switchannotationeditormode",{source:this,mode:M})}updateParams(M,ut){for(const At of P(this,V))At.updateParams(M,ut);for(const At of P(this,it))At.updateDefaultParams(M,ut)}getEditors(M){const ut=[];for(const At of P(this,T).values())At.pageIndex===M&&ut.push(At);return ut}getEditor(M){return P(this,T).get(M)}addEditor(M){P(this,T).set(M.id,M)}removeEditor(M){P(this,T).delete(M.id),this.unselect(M)}setActiveEditor(M){P(this,d)!==M&&(mt(this,d,M),M&&ht(this,z,Jt).call(this,M.propertiesToUpdate))}toggleSelected(M){if(P(this,V).has(M)){P(this,V).delete(M),M.unselect(),ht(this,j,Bt).call(this,{hasSelectedEditor:this.hasSelection});return}P(this,V).add(M),M.select(),ht(this,z,Jt).call(this,M.propertiesToUpdate),ht(this,j,Bt).call(this,{hasSelectedEditor:!0})}setSelected(M){for(const ut of P(this,V))ut!==M&&ut.unselect();P(this,V).clear(),P(this,V).add(M),M.select(),ht(this,z,Jt).call(this,M.propertiesToUpdate),ht(this,j,Bt).call(this,{hasSelectedEditor:!0})}isSelected(M){return P(this,V).has(M)}unselect(M){M.unselect(),P(this,V).delete(M),ht(this,j,Bt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return P(this,V).size!==0}undo(){P(this,x).undo(),ht(this,j,Bt).call(this,{hasSomethingToUndo:P(this,x).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ht(this,dt,Qt).call(this)})}redo(){P(this,x).redo(),ht(this,j,Bt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:P(this,x).hasSomethingToRedo(),isEmpty:ht(this,dt,Qt).call(this)})}addCommands(M){P(this,x).add(M),ht(this,j,Bt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ht(this,dt,Qt).call(this)})}delete(){if(P(this,d)&&P(this,d).commitOrRemove(),!this.hasSelection)return;const M=[...P(this,V)],ut=()=>{for(const vt of M)vt.remove()},At=()=>{for(const vt of M)ht(this,U,ue).call(this,vt)};this.addCommands({cmd:ut,undo:At,mustExec:!0})}copy(){if(P(this,d)&&P(this,d).commitOrRemove(),this.hasSelection){const M=[];for(const ut of P(this,V))ut.isEmpty()||M.push(ut);if(M.length===0)return;P(this,m).copy(M),ht(this,j,Bt).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(P(this,m).isEmpty())return;this.unselectAll();const M=P(this,S).get(P(this,Q)),ut=P(this,m).paste().map(Et=>M.deserialize(Et)),At=()=>{for(const Et of ut)ht(this,U,ue).call(this,Et);ht(this,ot,ee).call(this,ut)},vt=()=>{for(const Et of ut)Et.remove()};this.addCommands({cmd:At,undo:vt,mustExec:!0})}selectAll(){for(const M of P(this,V))M.commit();ht(this,ot,ee).call(this,P(this,T).values())}unselectAll(){if(P(this,d)){P(this,d).commitOrRemove();return}if(ht(this,ot,ee).size!==0){for(const M of P(this,V))M.unselect();P(this,V).clear(),ht(this,j,Bt).call(this,{hasSelectedEditor:!1})}}isActive(M){return P(this,d)===M}getActive(){return P(this,d)}getMode(){return P(this,G)}};let y=lt;d=new WeakMap,T=new WeakMap,S=new WeakMap,m=new WeakMap,x=new WeakMap,Q=new WeakMap,it=new WeakMap,Z=new WeakMap,Y=new WeakMap,W=new WeakMap,G=new WeakMap,V=new WeakMap,nt=new WeakMap,ct=new WeakMap,bt=new WeakMap,N=new WeakMap,h=new WeakMap,c=new WeakSet,Fe=function(){P(this,h).addEventListener("keydown",P(this,nt))},O=new WeakSet,de=function(){P(this,h).removeEventListener("keydown",P(this,nt))},j=new WeakSet,Bt=function(M){Object.entries(M).some(([At,vt])=>P(this,N)[At]!==vt)&&P(this,Z).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(P(this,N),M)})},z=new WeakSet,Jt=function(M){P(this,Z).dispatch("annotationeditorparamschanged",{source:this,details:M})},g=new WeakSet,Re=function(){if(!P(this,W)){mt(this,W,!0);for(const M of P(this,S).values())M.enable()}},C=new WeakSet,Me=function(){if(this.unselectAll(),P(this,W)){mt(this,W,!1);for(const M of P(this,S).values())M.disable()}},U=new WeakSet,ue=function(M){const ut=P(this,S).get(M.pageIndex);ut?ut.addOrRebuild(M):this.addEditor(M)},dt=new WeakSet,Qt=function(){if(P(this,T).size===0)return!0;if(P(this,T).size===1)for(const M of P(this,T).values())return M.isEmpty();return!1},ot=new WeakSet,ee=function(M){P(this,V).clear();for(const ut of M)ut.isEmpty()||(P(this,V).add(ut),ut.select());ht(this,j,Bt).call(this,{hasSelectedEditor:!0})},Mt(y,"_keyboardManager",new f([[["ctrl+a","mac+meta+a"],lt.prototype.selectAll],[["ctrl+c","mac+meta+c"],lt.prototype.copy],[["ctrl+v","mac+meta+v"],lt.prototype.paste],[["ctrl+x","mac+meta+x"],lt.prototype.cut],[["ctrl+z","mac+meta+z"],lt.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],lt.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],lt.prototype.delete],[["Escape","mac+Escape"],lt.prototype.unselectAll]])),a.AnnotationEditorUIManager=y},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.StatTimer=a.RenderingCancelledException=a.PixelsPerInch=a.PageViewport=a.PDFDateString=a.DOMStandardFontDataFactory=a.DOMSVGFactory=a.DOMCanvasFactory=a.DOMCMapReaderFactory=a.AnnotationPrefix=void 0,a.deprecated=n,a.getColorValues=x,a.getCurrentTransform=Q,a.getCurrentTransformInverse=it,a.getFilenameFromUrl=l,a.getPdfFilenameFromUrl=_,a.getRGB=m,a.getXfaPageViewport=S,a.isDataScheme=t,a.isPdfFile=s,a.isValidFetchUrl=o,a.loadScript=e;var u=R(9),p=R(1);const B="http://www.w3.org/2000/svg",D="pdfjs_internal_id_";a.AnnotationPrefix=D;const Z=class{};let J=Z;Mt(J,"CSS",96),Mt(J,"PDF",72),Mt(J,"PDF_TO_CSS_UNITS",Z.CSS/Z.PDF),a.PixelsPerInch=J;class L extends u.BaseCanvasFactory{constructor({ownerDocument:W=globalThis.document}={}){super(),this._document=W}_createCanvas(W,G){const V=this._document.createElement("canvas");return V.width=W,V.height=G,V}}a.DOMCanvasFactory=L;async function f(Y,W=!1){if(o(Y,document.baseURI)){const G=await fetch(Y);if(!G.ok)throw new Error(G.statusText);return W?new Uint8Array(await G.arrayBuffer()):(0,p.stringToBytes)(await G.text())}return new Promise((G,V)=>{const nt=new XMLHttpRequest;nt.open("GET",Y,!0),W&&(nt.responseType="arraybuffer"),nt.onreadystatechange=()=>{if(nt.readyState===XMLHttpRequest.DONE){if(nt.status===200||nt.status===0){let ct;if(W&&nt.response?ct=new Uint8Array(nt.response):!W&&nt.responseText&&(ct=(0,p.stringToBytes)(nt.responseText)),ct){G(ct);return}}V(new Error(nt.statusText))}},nt.send(null)})}class E extends u.BaseCMapReaderFactory{_fetchData(W,G){return f(W,this.isCompressed).then(V=>({cMapData:V,compressionType:G}))}}a.DOMCMapReaderFactory=E;class k extends u.BaseStandardFontDataFactory{_fetchData(W){return f(W,!0)}}a.DOMStandardFontDataFactory=k;class y extends u.BaseSVGFactory{_createSVG(W){return document.createElementNS(B,W)}}a.DOMSVGFactory=y;class v{constructor({viewBox:W,scale:G,rotation:V,offsetX:nt=0,offsetY:ct=0,dontFlip:bt=!1}){this.viewBox=W,this.scale=G,this.rotation=V,this.offsetX=nt,this.offsetY=ct;const N=(W[2]+W[0])/2,h=(W[3]+W[1])/2;let c,w,O,I;switch(V%=360,V<0&&(V+=360),V){case 180:c=-1,w=0,O=0,I=1;break;case 90:c=0,w=1,O=1,I=0;break;case 270:c=0,w=-1,O=-1,I=0;break;case 0:c=1,w=0,O=0,I=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}bt&&(O=-O,I=-I);let j,$,z,i;c===0?(j=Math.abs(h-W[1])*G+nt,$=Math.abs(N-W[0])*G+ct,z=Math.abs(W[3]-W[1])*G,i=Math.abs(W[2]-W[0])*G):(j=Math.abs(N-W[0])*G+nt,$=Math.abs(h-W[1])*G+ct,z=Math.abs(W[2]-W[0])*G,i=Math.abs(W[3]-W[1])*G),this.transform=[c*G,w*G,O*G,I*G,j-c*G*N-O*G*h,$-w*G*N-I*G*h],this.width=z,this.height=i}clone({scale:W=this.scale,rotation:G=this.rotation,offsetX:V=this.offsetX,offsetY:nt=this.offsetY,dontFlip:ct=!1}={}){return new v({viewBox:this.viewBox.slice(),scale:W,rotation:G,offsetX:V,offsetY:nt,dontFlip:ct})}convertToViewportPoint(W,G){return p.Util.applyTransform([W,G],this.transform)}convertToViewportRectangle(W){const G=p.Util.applyTransform([W[0],W[1]],this.transform),V=p.Util.applyTransform([W[2],W[3]],this.transform);return[G[0],G[1],V[0],V[1]]}convertToPdfPoint(W,G){return p.Util.applyInverseTransform([W,G],this.transform)}}a.PageViewport=v;class r extends p.BaseException{constructor(W,G){super(W,"RenderingCancelledException"),this.type=G}}a.RenderingCancelledException=r;function t(Y){const W=Y.length;let G=0;for(;G<W&&Y[G].trim()==="";)G++;return Y.substring(G,G+5).toLowerCase()==="data:"}function s(Y){return typeof Y=="string"&&/\.pdf$/i.test(Y)}function l(Y){const W=Y.indexOf("#"),G=Y.indexOf("?"),V=Math.min(W>0?W:Y.length,G>0?G:Y.length);return Y.substring(Y.lastIndexOf("/",V)+1,V)}function _(Y,W="document.pdf"){if(typeof Y!="string")return W;if(t(Y))return(0,p.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),W;const G=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,V=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,nt=G.exec(Y);let ct=V.exec(nt[1])||V.exec(nt[2])||V.exec(nt[3]);if(ct&&(ct=ct[0],ct.includes("%")))try{ct=V.exec(decodeURIComponent(ct))[0]}catch{}return ct||W}class b{constructor(){this.started=Object.create(null),this.times=[]}time(W){W in this.started&&(0,p.warn)(`Timer is already running for ${W}`),this.started[W]=Date.now()}timeEnd(W){W in this.started||(0,p.warn)(`Timer has not been started for ${W}`),this.times.push({name:W,start:this.started[W],end:Date.now()}),delete this.started[W]}toString(){const W=[];let G=0;for(const V of this.times){const nt=V.name;nt.length>G&&(G=nt.length)}for(const V of this.times){const nt=V.end-V.start;W.push(`${V.name.padEnd(G)} ${nt}ms
`)}return W.join("")}}a.StatTimer=b;function o(Y,W){try{const{protocol:G}=W?new URL(Y,W):new URL(Y);return G==="http:"||G==="https:"}catch{return!1}}function e(Y,W=!1){return new Promise((G,V)=>{const nt=document.createElement("script");nt.src=Y,nt.onload=function(ct){W&&nt.remove(),G(ct)},nt.onerror=function(){V(new Error(`Cannot load script at: ${nt.src}`))},(document.head||document.documentElement).append(nt)})}function n(Y){console.log("Deprecated API usage: "+Y)}let d;class T{static toDateObject(W){if(!W||typeof W!="string")return null;d||(d=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const G=d.exec(W);if(!G)return null;const V=parseInt(G[1],10);let nt=parseInt(G[2],10);nt=nt>=1&&nt<=12?nt-1:0;let ct=parseInt(G[3],10);ct=ct>=1&&ct<=31?ct:1;let bt=parseInt(G[4],10);bt=bt>=0&&bt<=23?bt:0;let N=parseInt(G[5],10);N=N>=0&&N<=59?N:0;let h=parseInt(G[6],10);h=h>=0&&h<=59?h:0;const c=G[7]||"Z";let w=parseInt(G[8],10);w=w>=0&&w<=23?w:0;let O=parseInt(G[9],10)||0;return O=O>=0&&O<=59?O:0,c==="-"?(bt+=w,N+=O):c==="+"&&(bt-=w,N-=O),new Date(Date.UTC(V,nt,ct,bt,N,h))}}a.PDFDateString=T;function S(Y,{scale:W=1,rotation:G=0}){const{width:V,height:nt}=Y.attributes.style,ct=[0,0,parseInt(V),parseInt(nt)];return new v({viewBox:ct,scale:W,rotation:G})}function m(Y){if(Y.startsWith("#")){const W=parseInt(Y.slice(1),16);return[(W&16711680)>>16,(W&65280)>>8,W&255]}return Y.startsWith("rgb(")?Y.slice(4,-1).split(",").map(W=>parseInt(W)):Y.startsWith("rgba(")?Y.slice(5,-1).split(",").map(W=>parseInt(W)).slice(0,3):((0,p.warn)(`Not a valid color format: "${Y}"`),[0,0,0])}function x(Y){const W=document.createElement("span");W.style.visibility="hidden",document.body.append(W);for(const G of Y.keys()){W.style.color=G;const V=window.getComputedStyle(W).color;Y.set(G,m(V))}W.remove()}function Q(Y){const{a:W,b:G,c:V,d:nt,e:ct,f:bt}=Y.getTransform();return[W,G,V,nt,ct,bt]}function it(Y){const{a:W,b:G,c:V,d:nt,e:ct,f:bt}=Y.getTransform().invertSelf();return[W,G,V,nt,ct,bt]}},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BaseStandardFontDataFactory=a.BaseSVGFactory=a.BaseCanvasFactory=a.BaseCMapReaderFactory=void 0;var u=R(1);class p{constructor(){this.constructor===p&&(0,u.unreachable)("Cannot initialize BaseCanvasFactory.")}create(f,E){if(f<=0||E<=0)throw new Error("Invalid canvas size");const k=this._createCanvas(f,E);return{canvas:k,context:k.getContext("2d")}}reset(f,E,k){if(!f.canvas)throw new Error("Canvas is not specified");if(E<=0||k<=0)throw new Error("Invalid canvas size");f.canvas.width=E,f.canvas.height=k}destroy(f){if(!f.canvas)throw new Error("Canvas is not specified");f.canvas.width=0,f.canvas.height=0,f.canvas=null,f.context=null}_createCanvas(f,E){(0,u.unreachable)("Abstract method `_createCanvas` called.")}}a.BaseCanvasFactory=p;class B{constructor({baseUrl:f=null,isCompressed:E=!1}){this.constructor===B&&(0,u.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=E}async fetch({name:f}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const E=this.baseUrl+f+(this.isCompressed?".bcmap":""),k=this.isCompressed?u.CMapCompressionType.BINARY:u.CMapCompressionType.NONE;return this._fetchData(E,k).catch(y=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${E}`)})}_fetchData(f,E){(0,u.unreachable)("Abstract method `_fetchData` called.")}}a.BaseCMapReaderFactory=B;class D{constructor({baseUrl:f=null}){this.constructor===D&&(0,u.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}async fetch({filename:f}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const E=`${this.baseUrl}${f}`;return this._fetchData(E).catch(k=>{throw new Error(`Unable to load font data at: ${E}`)})}_fetchData(f){(0,u.unreachable)("Abstract method `_fetchData` called.")}}a.BaseStandardFontDataFactory=D;class J{constructor(){this.constructor===J&&(0,u.unreachable)("Cannot initialize BaseSVGFactory.")}create(f,E,k=!1){if(f<=0||E<=0)throw new Error("Invalid SVG dimensions");const y=this._createSVG("svg:svg");return y.setAttribute("version","1.1"),k||(y.setAttribute("width",`${f}px`),y.setAttribute("height",`${E}px`)),y.setAttribute("preserveAspectRatio","none"),y.setAttribute("viewBox",`0 0 ${f} ${E}`),y}createElement(f){if(typeof f!="string")throw new Error("Invalid SVG element type");return this._createSVG(f)}_createSVG(f){(0,u.unreachable)("Abstract method `_createSVG` called.")}}a.BaseSVGFactory=J},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.MurmurHash3_64=void 0;var u=R(1);const p=3285377520,B=4294901760,D=65535;class J{constructor(f){this.h1=f?f&4294967295:p,this.h2=f?f&4294967295:p}update(f){let E,k;if(typeof f=="string"){E=new Uint8Array(f.length*2),k=0;for(let d=0,T=f.length;d<T;d++){const S=f.charCodeAt(d);S<=255?E[k++]=S:(E[k++]=S>>>8,E[k++]=S&255)}}else if((0,u.isArrayBuffer)(f))E=f.slice(),k=E.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const y=k>>2,v=k-y*4,r=new Uint32Array(E.buffer,0,y);let t=0,s=0,l=this.h1,_=this.h2;const b=3432918353,o=461845907,e=b&D,n=o&D;for(let d=0;d<y;d++)d&1?(t=r[d],t=t*b&B|t*e&D,t=t<<15|t>>>17,t=t*o&B|t*n&D,l^=t,l=l<<13|l>>>19,l=l*5+3864292196):(s=r[d],s=s*b&B|s*e&D,s=s<<15|s>>>17,s=s*o&B|s*n&D,_^=s,_=_<<13|_>>>19,_=_*5+3864292196);switch(t=0,v){case 3:t^=E[y*4+2]<<16;case 2:t^=E[y*4+1]<<8;case 1:t^=E[y*4],t=t*b&B|t*e&D,t=t<<15|t>>>17,t=t*o&B|t*n&D,y&1?l^=t:_^=t}this.h1=l,this.h2=_}hexdigest(){let f=this.h1,E=this.h2;f^=E>>>1,f=f*3981806797&B|f*36045&D,E=E*4283543511&B|((E<<16|f>>>16)*2950163797&B)>>>16,f^=E>>>1,f=f*444984403&B|f*60499&D,E=E*3301882366&B|((E<<16|f>>>16)*3120437893&B)>>>16,f^=E>>>1;const k=(f>>>0).toString(16),y=(E>>>0).toString(16);return k.padStart(8,"0")+y.padStart(8,"0")}}a.MurmurHash3_64=J},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.FontLoader=a.FontFaceObject=void 0;var u=R(1);class p{constructor({docId:L,onUnsupportedFeature:f,ownerDocument:E=globalThis.document,styleElement:k=null}){this.constructor===p&&(0,u.unreachable)("Cannot initialize BaseFontLoader."),this.docId=L,this._onUnsupportedFeature=f,this._document=E,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(L){this.nativeFontFaces.push(L),this._document.fonts.add(L)}insertRule(L){let f=this.styleElement;f||(f=this.styleElement=this._document.createElement("style"),f.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(f));const E=f.sheet;E.insertRule(L,E.cssRules.length)}clear(){for(const L of this.nativeFontFaces)this._document.fonts.delete(L);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(L){if(L.attached||L.missingFile)return;if(L.attached=!0,this.isFontLoadingAPISupported){const E=L.createNativeFontFace();if(E){this.addNativeFontFace(E);try{await E.loaded}catch(k){throw this._onUnsupportedFeature({featureId:u.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,u.warn)(`Failed to load font '${E.family}': '${k}'.`),L.disableFontFace=!0,k}}return}const f=L.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(E=>{const k=this._queueLoadingCallback(E);this._prepareFontLoadEvent([f],[L],k)})}}_queueLoadingCallback(L){(0,u.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var f;const L=!!((f=this._document)!=null&&f.fonts);return(0,u.shadow)(this,"isFontLoadingAPISupported",L)}get isSyncFontLoadingSupported(){(0,u.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,u.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(L,f,E){(0,u.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let B;a.FontLoader=B,a.FontLoader=B=class extends p{constructor(L){super(L),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let L=!1;if(typeof navigator=="undefined")L=!0;else{const f=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(f==null?void 0:f[1])>=14&&(L=!0)}return(0,u.shadow)(this,"isSyncFontLoadingSupported",L)}_queueLoadingCallback(L){function f(){for((0,u.assert)(!k.done,"completeRequest() cannot be called twice."),k.done=!0;E.requests.length>0&&E.requests[0].done;){const y=E.requests.shift();setTimeout(y.callback,0)}}const E=this.loadingContext,k={id:`pdfjs-font-loading-${E.nextRequestId++}`,done:!1,complete:f,callback:L};return E.requests.push(k),k}get _loadTestFont(){const L=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,u.shadow)(this,"_loadTestFont",L())}_prepareFontLoadEvent(L,f,E){function k(it,Z){return it.charCodeAt(Z)<<24|it.charCodeAt(Z+1)<<16|it.charCodeAt(Z+2)<<8|it.charCodeAt(Z+3)&255}function y(it,Z,Y,W){const G=it.substring(0,Z),V=it.substring(Z+Y);return G+W+V}let v,r;const t=this._document.createElement("canvas");t.width=1,t.height=1;const s=t.getContext("2d");let l=0;function _(it,Z){if(l++,l>30){(0,u.warn)("Load test font never loaded."),Z();return}if(s.font="30px "+it,s.fillText(".",0,20),s.getImageData(0,0,1,1).data[3]>0){Z();return}setTimeout(_.bind(null,it,Z))}const b=`lt${Date.now()}${this.loadTestFontId++}`;let o=this._loadTestFont;o=y(o,976,b.length,b);const n=16,d=1482184792;let T=k(o,n);for(v=0,r=b.length-3;v<r;v+=4)T=T-d+k(b,v)|0;v<b.length&&(T=T-d+k(b+"XXX",v)|0),o=y(o,n,4,(0,u.string32)(T));const S=`url(data:font/opentype;base64,${btoa(o)});`,m=`@font-face {font-family:"${b}";src:${S}}`;this.insertRule(m);const x=[];for(const it of f)x.push(it.loadedName);x.push(b);const Q=this._document.createElement("div");Q.style.visibility="hidden",Q.style.width=Q.style.height="10px",Q.style.position="absolute",Q.style.top=Q.style.left="0px";for(const it of x){const Z=this._document.createElement("span");Z.textContent="Hi",Z.style.fontFamily=it,Q.append(Z)}this._document.body.append(Q),_(b,()=>{Q.remove(),E.complete()})}};class D{constructor(L,{isEvalSupported:f=!0,disableFontFace:E=!1,ignoreErrors:k=!1,onUnsupportedFeature:y,fontRegistry:v=null}){this.compiledGlyphs=Object.create(null);for(const r in L)this[r]=L[r];this.isEvalSupported=f!==!1,this.disableFontFace=E===!0,this.ignoreErrors=k===!0,this._onUnsupportedFeature=y,this.fontRegistry=v}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let L;if(!this.cssFontInfo)L=new FontFace(this.loadedName,this.data,{});else{const f={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(f.style=`oblique ${this.cssFontInfo.italicAngle}deg`),L=new FontFace(this.cssFontInfo.fontFamily,this.data,f)}return this.fontRegistry&&this.fontRegistry.registerFont(this),L}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const L=(0,u.bytesToString)(this.data),f=`url(data:${this.mimetype};base64,${btoa(L)});`;let E;if(!this.cssFontInfo)E=`@font-face {font-family:"${this.loadedName}";src:${f}}`;else{let k=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(k+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),E=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${k}src:${f}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,f),E}getPathGenerator(L,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let E;try{E=L.get(this.loadedName+"_path_"+f)}catch(k){if(!this.ignoreErrors)throw k;return this._onUnsupportedFeature({featureId:u.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,u.warn)(`getPathGenerator - ignoring character: "${k}".`),this.compiledGlyphs[f]=function(y,v){}}if(this.isEvalSupported&&u.FeatureTest.isEvalSupported){const k=[];for(const y of E){const v=y.args!==void 0?y.args.join(","):"";k.push("c.",y.cmd,"(",v,`);
`)}return this.compiledGlyphs[f]=new Function("c","size",k.join(""))}return this.compiledGlyphs[f]=function(k,y){for(const v of E)v.cmd==="scale"&&(v.args=[y,-y]),k[v.cmd].apply(k,v.args)}}}a.FontFaceObject=D},(X,a,R)=>{var nt,fe;Object.defineProperty(a,"__esModule",{value:!0}),a.CanvasGraphics=void 0;var u=R(8),p=R(1),B=R(13),D=R(14),J=R(3);const L=16,f=100,E=4096,k=15,y=10,v=J.isNodeJS&&typeof Path2D=="undefined"?-1:1e3,r=16;function t(N,h){if(N._removeMirroring)throw new Error("Context is already forwarding operations.");N.__originalSave=N.save,N.__originalRestore=N.restore,N.__originalRotate=N.rotate,N.__originalScale=N.scale,N.__originalTranslate=N.translate,N.__originalTransform=N.transform,N.__originalSetTransform=N.setTransform,N.__originalResetTransform=N.resetTransform,N.__originalClip=N.clip,N.__originalMoveTo=N.moveTo,N.__originalLineTo=N.lineTo,N.__originalBezierCurveTo=N.bezierCurveTo,N.__originalRect=N.rect,N.__originalClosePath=N.closePath,N.__originalBeginPath=N.beginPath,N._removeMirroring=()=>{N.save=N.__originalSave,N.restore=N.__originalRestore,N.rotate=N.__originalRotate,N.scale=N.__originalScale,N.translate=N.__originalTranslate,N.transform=N.__originalTransform,N.setTransform=N.__originalSetTransform,N.resetTransform=N.__originalResetTransform,N.clip=N.__originalClip,N.moveTo=N.__originalMoveTo,N.lineTo=N.__originalLineTo,N.bezierCurveTo=N.__originalBezierCurveTo,N.rect=N.__originalRect,N.closePath=N.__originalClosePath,N.beginPath=N.__originalBeginPath,delete N._removeMirroring},N.save=function(){h.save(),this.__originalSave()},N.restore=function(){h.restore(),this.__originalRestore()},N.translate=function(w,O){h.translate(w,O),this.__originalTranslate(w,O)},N.scale=function(w,O){h.scale(w,O),this.__originalScale(w,O)},N.transform=function(w,O,I,j,$,z){h.transform(w,O,I,j,$,z),this.__originalTransform(w,O,I,j,$,z)},N.setTransform=function(w,O,I,j,$,z){h.setTransform(w,O,I,j,$,z),this.__originalSetTransform(w,O,I,j,$,z)},N.resetTransform=function(){h.resetTransform(),this.__originalResetTransform()},N.rotate=function(w){h.rotate(w),this.__originalRotate(w)},N.clip=function(w){h.clip(w),this.__originalClip(w)},N.moveTo=function(c,w){h.moveTo(c,w),this.__originalMoveTo(c,w)},N.lineTo=function(c,w){h.lineTo(c,w),this.__originalLineTo(c,w)},N.bezierCurveTo=function(c,w,O,I,j,$){h.bezierCurveTo(c,w,O,I,j,$),this.__originalBezierCurveTo(c,w,O,I,j,$)},N.rect=function(c,w,O,I){h.rect(c,w,O,I),this.__originalRect(c,w,O,I)},N.closePath=function(){h.closePath(),this.__originalClosePath()},N.beginPath=function(){h.beginPath(),this.__originalBeginPath()}}class s{constructor(h){this.canvasFactory=h,this.cache=Object.create(null)}getCanvas(h,c,w){let O;return this.cache[h]!==void 0?(O=this.cache[h],this.canvasFactory.reset(O,c,w)):(O=this.canvasFactory.create(c,w),this.cache[h]=O),O}delete(h){delete this.cache[h]}clear(){for(const h in this.cache){const c=this.cache[h];this.canvasFactory.destroy(c),delete this.cache[h]}}}function l(N,h,c,w,O,I,j,$,z,i){const[g,A,C,F,U,st]=(0,u.getCurrentTransform)(N);if(A===0&&C===0){const ot=j*g+U,et=Math.round(ot),lt=$*F+st,ft=Math.round(lt),M=(j+z)*g+U,ut=Math.abs(Math.round(M)-et)||1,At=($+i)*F+st,vt=Math.abs(Math.round(At)-ft)||1;return N.setTransform(Math.sign(g),0,0,Math.sign(F),et,ft),N.drawImage(h,c,w,O,I,0,0,ut,vt),N.setTransform(g,A,C,F,U,st),[ut,vt]}if(g===0&&F===0){const ot=$*C+U,et=Math.round(ot),lt=j*A+st,ft=Math.round(lt),M=($+i)*C+U,ut=Math.abs(Math.round(M)-et)||1,At=(j+z)*A+st,vt=Math.abs(Math.round(At)-ft)||1;return N.setTransform(0,Math.sign(A),Math.sign(C),0,et,ft),N.drawImage(h,c,w,O,I,0,0,vt,ut),N.setTransform(g,A,C,F,U,st),[vt,ut]}N.drawImage(h,c,w,O,I,j,$,z,i);const dt=Math.hypot(g,A),tt=Math.hypot(C,F);return[dt*z,tt*i]}function _(N){const{width:h,height:c}=N;if(h>v||c>v)return null;const w=1e3,O=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),I=h+1;let j=new Uint8Array(I*(c+1)),$,z,i;const g=h+7&-8;let A=new Uint8Array(g*c),C=0;for(const tt of N.data){let ot=128;for(;ot>0;)A[C++]=tt&ot?0:255,ot>>=1}let F=0;for(C=0,A[C]!==0&&(j[0]=1,++F),z=1;z<h;z++)A[C]!==A[C+1]&&(j[z]=A[C]?2:1,++F),C++;for(A[C]!==0&&(j[z]=2,++F),$=1;$<c;$++){C=$*g,i=$*I,A[C-g]!==A[C]&&(j[i]=A[C]?1:8,++F);let tt=(A[C]?4:0)+(A[C-g]?8:0);for(z=1;z<h;z++)tt=(tt>>2)+(A[C+1]?4:0)+(A[C-g+1]?8:0),O[tt]&&(j[i+z]=O[tt],++F),C++;if(A[C-g]!==A[C]&&(j[i+z]=A[C]?2:4,++F),F>w)return null}for(C=g*(c-1),i=$*I,A[C]!==0&&(j[i]=8,++F),z=1;z<h;z++)A[C]!==A[C+1]&&(j[i+z]=A[C]?4:8,++F),C++;if(A[C]!==0&&(j[i+z]=4,++F),F>w)return null;const U=new Int32Array([0,I,-1,0,-I,0,0,0,1]),st=new Path2D;for($=0;F&&$<=c;$++){let tt=$*I;const ot=tt+h;for(;tt<ot&&!j[tt];)tt++;if(tt===ot)continue;st.moveTo(tt%I,$);const et=tt;let lt=j[tt];do{const ft=U[lt];do tt+=ft;while(!j[tt]);const M=j[tt];M!==5&&M!==10?(lt=M,j[tt]=0):(lt=M&51*lt>>4,j[tt]&=lt>>2|lt<<2),st.lineTo(tt%I,tt/I|0),j[tt]||--F}while(et!==tt);--$}return A=null,j=null,function(tt){tt.save(),tt.scale(1/h,-1/c),tt.translate(0,-c),tt.fill(st),tt.beginPath(),tt.restore()}}class b{constructor(h,c){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=p.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=p.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=p.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,h,c])}clone(){const h=Object.create(this);return h.clipBox=this.clipBox.slice(),h}setCurrentPoint(h,c){this.x=h,this.y=c}updatePathMinMax(h,c,w){[c,w]=p.Util.applyTransform([c,w],h),this.minX=Math.min(this.minX,c),this.minY=Math.min(this.minY,w),this.maxX=Math.max(this.maxX,c),this.maxY=Math.max(this.maxY,w)}updateRectMinMax(h,c){const w=p.Util.applyTransform(c,h),O=p.Util.applyTransform(c.slice(2),h);this.minX=Math.min(this.minX,w[0],O[0]),this.minY=Math.min(this.minY,w[1],O[1]),this.maxX=Math.max(this.maxX,w[0],O[0]),this.maxY=Math.max(this.maxY,w[1],O[1])}updateScalingPathMinMax(h,c){p.Util.scaleMinMax(h,c),this.minX=Math.min(this.minX,c[0]),this.maxX=Math.max(this.maxX,c[1]),this.minY=Math.min(this.minY,c[2]),this.maxY=Math.max(this.maxY,c[3])}updateCurvePathMinMax(h,c,w,O,I,j,$,z,i,g){const A=p.Util.bezierBoundingBox(c,w,O,I,j,$,z,i);if(g){g[0]=Math.min(g[0],A[0],A[2]),g[1]=Math.max(g[1],A[0],A[2]),g[2]=Math.min(g[2],A[1],A[3]),g[3]=Math.max(g[3],A[1],A[3]);return}this.updateRectMinMax(h,A)}getPathBoundingBox(h=B.PathType.FILL,c=null){const w=[this.minX,this.minY,this.maxX,this.maxY];if(h===B.PathType.STROKE){c||(0,p.unreachable)("Stroke bounding box must include transform.");const O=p.Util.singularValueDecompose2dScale(c),I=O[0]*this.lineWidth/2,j=O[1]*this.lineWidth/2;w[0]-=I,w[1]-=j,w[2]+=I,w[3]+=j}return w}updateClipFromPath(){const h=p.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(h||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(h){this.clipBox=h,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(h=B.PathType.FILL,c=null){return p.Util.intersect(this.clipBox,this.getPathBoundingBox(h,c))}}function o(N,h,c=null){if(typeof ImageData!="undefined"&&h instanceof ImageData){N.putImageData(h,0,0);return}const w=h.height,O=h.width,I=w%r,j=(w-I)/r,$=I===0?j:j+1,z=N.createImageData(O,r);let i=0,g;const A=h.data,C=z.data;let F,U,st,dt,tt,ot,et,lt;if(c)switch(c.length){case 1:tt=c[0],ot=c[0],et=c[0],lt=c[0];break;case 4:tt=c[0],ot=c[1],et=c[2],lt=c[3];break}if(h.kind===p.ImageKind.GRAYSCALE_1BPP){const ft=A.byteLength,M=new Uint32Array(C.buffer,0,C.byteLength>>2),ut=M.length,At=O+7>>3;let vt=4294967295,Et=p.FeatureTest.isLittleEndian?4278190080:255;for(lt&&lt[0]===255&&lt[255]===0&&([vt,Et]=[Et,vt]),F=0;F<$;F++){for(st=F<j?r:I,g=0,U=0;U<st;U++){const Tt=ft-i;let Rt=0;const Ft=Tt>At?O:Tt*8-7,Xt=Ft&-8;let wt=0,Ot=0;for(;Rt<Xt;Rt+=8)Ot=A[i++],M[g++]=Ot&128?vt:Et,M[g++]=Ot&64?vt:Et,M[g++]=Ot&32?vt:Et,M[g++]=Ot&16?vt:Et,M[g++]=Ot&8?vt:Et,M[g++]=Ot&4?vt:Et,M[g++]=Ot&2?vt:Et,M[g++]=Ot&1?vt:Et;for(;Rt<Ft;Rt++)wt===0&&(Ot=A[i++],wt=128),M[g++]=Ot&wt?vt:Et,wt>>=1}for(;g<ut;)M[g++]=0;N.putImageData(z,0,F*r)}}else if(h.kind===p.ImageKind.RGBA_32BPP){const ft=!!(tt||ot||et);for(U=0,dt=O*r*4,F=0;F<j;F++){if(C.set(A.subarray(i,i+dt)),i+=dt,ft)for(let M=0;M<dt;M+=4)tt&&(C[M+0]=tt[C[M+0]]),ot&&(C[M+1]=ot[C[M+1]]),et&&(C[M+2]=et[C[M+2]]);N.putImageData(z,0,U),U+=r}if(F<$){if(dt=O*I*4,C.set(A.subarray(i,i+dt)),ft)for(let M=0;M<dt;M+=4)tt&&(C[M+0]=tt[C[M+0]]),ot&&(C[M+1]=ot[C[M+1]]),et&&(C[M+2]=et[C[M+2]]);N.putImageData(z,0,U)}}else if(h.kind===p.ImageKind.RGB_24BPP){const ft=!!(tt||ot||et);for(st=r,dt=O*st,F=0;F<$;F++){for(F>=j&&(st=I,dt=O*st),g=0,U=dt;U--;)C[g++]=A[i++],C[g++]=A[i++],C[g++]=A[i++],C[g++]=255;if(ft)for(let M=0;M<g;M+=4)tt&&(C[M+0]=tt[C[M+0]]),ot&&(C[M+1]=ot[C[M+1]]),et&&(C[M+2]=et[C[M+2]]);N.putImageData(z,0,F*r)}}else throw new Error(`bad image kind: ${h.kind}`)}function e(N,h){if(h.bitmap){N.drawImage(h.bitmap,0,0);return}const c=h.height,w=h.width,O=c%r,I=(c-O)/r,j=O===0?I:I+1,$=N.createImageData(w,r);let z=0;const i=h.data,g=$.data;for(let A=0;A<j;A++){const C=A<I?r:O;({srcPos:z}=(0,D.applyMaskImageData)({src:i,srcPos:z,dest:g,width:w,height:C})),N.putImageData($,0,A*r)}}function n(N,h){const c=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let w=0,O=c.length;w<O;w++){const I=c[w];N[I]!==void 0&&(h[I]=N[I])}N.setLineDash!==void 0&&(h.setLineDash(N.getLineDash()),h.lineDashOffset=N.lineDashOffset)}function d(N,h){N.strokeStyle=N.fillStyle=h||"#000000",N.fillRule="nonzero",N.globalAlpha=1,N.lineWidth=1,N.lineCap="butt",N.lineJoin="miter",N.miterLimit=10,N.globalCompositeOperation="source-over",N.font="10px sans-serif",N.setLineDash!==void 0&&(N.setLineDash([]),N.lineDashOffset=0)}function T(N,h,c,w){const O=N.length;for(let I=3;I<O;I+=4){const j=N[I];if(j===0)N[I-3]=h,N[I-2]=c,N[I-1]=w;else if(j<255){const $=255-j;N[I-3]=N[I-3]*j+h*$>>8,N[I-2]=N[I-2]*j+c*$>>8,N[I-1]=N[I-1]*j+w*$>>8}}}function S(N,h,c){const w=N.length,O=1/255;for(let I=3;I<w;I+=4){const j=c?c[N[I]]:N[I];h[I]=h[I]*j*O|0}}function m(N,h,c){const w=N.length;for(let O=3;O<w;O+=4){const I=N[O-3]*77+N[O-2]*152+N[O-1]*28;h[O]=c?h[O]*c[I>>8]>>8:h[O]*I>>16}}function x(N,h,c,w,O,I,j,$,z,i,g){const A=!!I,C=A?I[0]:0,F=A?I[1]:0,U=A?I[2]:0;let st;O==="Luminosity"?st=m:st=S;const tt=Math.min(w,Math.ceil(1048576/c));for(let ot=0;ot<w;ot+=tt){const et=Math.min(tt,w-ot),lt=N.getImageData($-i,ot+(z-g),c,et),ft=h.getImageData($,ot+z,c,et);A&&T(lt.data,C,F,U),st(lt.data,ft.data,j),h.putImageData(ft,$,ot+z)}}function Q(N,h,c,w){const O=w[0],I=w[1],j=w[2]-O,$=w[3]-I;j===0||$===0||(x(h.context,c,j,$,h.subtype,h.backdrop,h.transferMap,O,I,h.offsetX,h.offsetY),N.save(),N.globalAlpha=1,N.globalCompositeOperation="source-over",N.setTransform(1,0,0,1,0,0),N.drawImage(c.canvas,0,0),N.restore())}function it(N,h){const c=p.Util.singularValueDecompose2dScale(N);c[0]=Math.fround(c[0]),c[1]=Math.fround(c[1]);const w=Math.fround((globalThis.devicePixelRatio||1)*u.PixelsPerInch.PDF_TO_CSS_UNITS);return h!==void 0?h:c[0]<=w||c[1]<=w}const Z=["butt","round","square"],Y=["miter","round","bevel"],W={},G={},bt=class{constructor(h,c,w,O,I,j,$,z){at(this,nt);this.ctx=h,this.current=new b(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=c,this.objs=w,this.canvasFactory=O,this.imageLayer=I,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=j,this.cachedCanvases=new s(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=$,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(z==null?void 0:z.background)||null,this.foregroundColor=(z==null?void 0:z.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(h,c=null){return typeof h=="string"?h.startsWith("g_")?this.commonObjs.get(h):this.objs.get(h):c}beginDrawing({transform:h,viewport:c,transparency:w=!1,background:O=null}){const I=this.ctx.canvas.width,j=this.ctx.canvas.height,$=O||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const z=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const i=this.backgroundColor=this.ctx.fillStyle;let g=!0,A=$;if(this.ctx.fillStyle=$,A=this.ctx.fillStyle,g=typeof A=="string"&&/^#[0-9A-Fa-f]{6}$/.test(A),z==="#000000"&&i==="#ffffff"||z===i||!g)this.foregroundColor=this.backgroundColor=null;else{const[C,F,U]=(0,u.getRGB)(A),st=tt=>(tt/=255,tt<=.03928?tt/12.92:((tt+.055)/1.055)**2.4),dt=Math.round(.2126*st(C)+.7152*st(F)+.0722*st(U));this.selectColor=(tt,ot,et)=>{const lt=.2126*st(tt)+.7152*st(ot)+.0722*st(et);return Math.round(lt)===dt?i:z}}}if(this.ctx.fillStyle=this.backgroundColor||$,this.ctx.fillRect(0,0,I,j),this.ctx.restore(),w){const z=this.cachedCanvases.getCanvas("transparent",I,j);this.compositeCtx=this.ctx,this.transparentCanvas=z.canvas,this.ctx=z.context,this.ctx.save(),this.ctx.transform(...(0,u.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),d(this.ctx,this.foregroundColor),h&&(this.ctx.transform(...h),this.outputScaleX=h[0],this.outputScaleY=h[0]),this.ctx.transform(...c.transform),this.viewportScale=c.scale,this.baseTransform=(0,u.getCurrentTransform)(this.ctx),this.imageLayer&&((0,u.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(h,c,w,O){const I=h.argsArray,j=h.fnArray;let $=c||0;const z=I.length;if(z===$)return $;const i=z-$>y&&typeof w=="function",g=i?Date.now()+k:0;let A=0;const C=this.commonObjs,F=this.objs;let U;for(;;){if(O!==void 0&&$===O.nextBreakPoint)return O.breakIt($,w),$;if(U=j[$],U!==p.OPS.dependency)this[U].apply(this,I[$]);else for(const st of I[$]){const dt=st.startsWith("g_")?C:F;if(!dt.has(st))return dt.get(st,w),$}if($++,$===z)return $;if(i&&++A>y){if(Date.now()>g)return w(),$;A=0}}}endDrawing(){ht(this,nt,fe).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const h of this._cachedBitmapsMap.values()){for(const c of h.values())typeof HTMLCanvasElement!="undefined"&&c instanceof HTMLCanvasElement&&(c.width=c.height=0);h.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(h,c){const w=h.width,O=h.height;let I=Math.max(Math.hypot(c[0],c[1]),1),j=Math.max(Math.hypot(c[2],c[3]),1),$=w,z=O,i="prescale1",g,A;for(;I>2&&$>1||j>2&&z>1;){let C=$,F=z;I>2&&$>1&&(C=Math.ceil($/2),I/=$/C),j>2&&z>1&&(F=Math.ceil(z/2),j/=z/F),g=this.cachedCanvases.getCanvas(i,C,F),A=g.context,A.clearRect(0,0,C,F),A.drawImage(h,0,0,$,z,0,0,C,F),h=g.canvas,$=C,z=F,i=i==="prescale1"?"prescale2":"prescale1"}return{img:h,paintWidth:$,paintHeight:z}}_createMaskCanvas(h){const c=this.ctx,{width:w,height:O}=h,I=this.current.fillColor,j=this.current.patternFill,$=(0,u.getCurrentTransform)(c);let z,i,g,A;if((h.bitmap||h.data)&&h.count>1){const ut=h.bitmap||h.data.buffer,At=$.slice(0,4);i=JSON.stringify(j?At:[At,I]),z=this._cachedBitmapsMap.get(ut),z||(z=new Map,this._cachedBitmapsMap.set(ut,z));const vt=z.get(i);if(vt&&!j){const Et=Math.round(Math.min($[0],$[2])+$[4]),Tt=Math.round(Math.min($[1],$[3])+$[5]);return{canvas:vt,offsetX:Et,offsetY:Tt}}g=vt}g||(A=this.cachedCanvases.getCanvas("maskCanvas",w,O),e(A.context,h));let C=p.Util.transform($,[1/w,0,0,-1/O,0,0]);C=p.Util.transform(C,[1,0,0,1,0,-O]);const F=p.Util.applyTransform([0,0],C),U=p.Util.applyTransform([w,O],C),st=p.Util.normalizeRect([F[0],F[1],U[0],U[1]]),dt=Math.round(st[2]-st[0])||1,tt=Math.round(st[3]-st[1])||1,ot=this.cachedCanvases.getCanvas("fillCanvas",dt,tt),et=ot.context,lt=Math.min(F[0],U[0]),ft=Math.min(F[1],U[1]);et.translate(-lt,-ft),et.transform(...C),g||(g=this._scaleImage(A.canvas,(0,u.getCurrentTransformInverse)(et)),g=g.img,z&&j&&z.set(i,g)),et.imageSmoothingEnabled=it((0,u.getCurrentTransform)(et),h.interpolate),l(et,g,0,0,g.width,g.height,0,0,w,O),et.globalCompositeOperation="source-in";const M=p.Util.transform((0,u.getCurrentTransformInverse)(et),[1,0,0,1,-lt,-ft]);return et.fillStyle=j?I.getPattern(c,this,M,B.PathType.FILL):I,et.fillRect(0,0,w,O),z&&!j&&(this.cachedCanvases.delete("fillCanvas"),z.set(i,ot.canvas)),{canvas:ot.canvas,offsetX:Math.round(lt),offsetY:Math.round(ft)}}setLineWidth(h){h!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=h,this.ctx.lineWidth=h}setLineCap(h){this.ctx.lineCap=Z[h]}setLineJoin(h){this.ctx.lineJoin=Y[h]}setMiterLimit(h){this.ctx.miterLimit=h}setDash(h,c){const w=this.ctx;w.setLineDash!==void 0&&(w.setLineDash(h),w.lineDashOffset=c)}setRenderingIntent(h){}setFlatness(h){}setGState(h){for(let c=0,w=h.length;c<w;c++){const O=h[c],I=O[0],j=O[1];switch(I){case"LW":this.setLineWidth(j);break;case"LC":this.setLineCap(j);break;case"LJ":this.setLineJoin(j);break;case"ML":this.setMiterLimit(j);break;case"D":this.setDash(j[0],j[1]);break;case"RI":this.setRenderingIntent(j);break;case"FL":this.setFlatness(j);break;case"Font":this.setFont(j[0],j[1]);break;case"CA":this.current.strokeAlpha=O[1];break;case"ca":this.current.fillAlpha=O[1],this.ctx.globalAlpha=O[1];break;case"BM":this.ctx.globalCompositeOperation=j;break;case"SMask":this.current.activeSMask=j?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=j}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const h=this.inSMaskMode;this.current.activeSMask&&!h?this.beginSMaskMode():!this.current.activeSMask&&h&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const h=this.ctx.canvas.width,c=this.ctx.canvas.height,w="smaskGroupAt"+this.groupLevel,O=this.cachedCanvases.getCanvas(w,h,c);this.suspendedCtx=this.ctx,this.ctx=O.context;const I=this.ctx;I.setTransform(...(0,u.getCurrentTransform)(this.suspendedCtx)),n(this.suspendedCtx,I),t(I,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),n(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(h){if(!this.current.activeSMask)return;h?(h[0]=Math.floor(h[0]),h[1]=Math.floor(h[1]),h[2]=Math.ceil(h[2]),h[3]=Math.ceil(h[3])):h=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const c=this.current.activeSMask,w=this.suspendedCtx;Q(w,c,this.ctx,h),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(n(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const h=this.current;this.stateStack.push(h),this.current=h.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),n(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(h,c,w,O,I,j){this.ctx.transform(h,c,w,O,I,j),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(h,c,w){const O=this.ctx,I=this.current;let j=I.x,$=I.y,z,i;const g=(0,u.getCurrentTransform)(O),A=g[0]===0&&g[3]===0||g[1]===0&&g[2]===0,C=A?w.slice(0):null;for(let F=0,U=0,st=h.length;F<st;F++)switch(h[F]|0){case p.OPS.rectangle:j=c[U++],$=c[U++];const dt=c[U++],tt=c[U++],ot=j+dt,et=$+tt;O.moveTo(j,$),dt===0||tt===0?O.lineTo(ot,et):(O.lineTo(ot,$),O.lineTo(ot,et),O.lineTo(j,et)),A||I.updateRectMinMax(g,[j,$,ot,et]),O.closePath();break;case p.OPS.moveTo:j=c[U++],$=c[U++],O.moveTo(j,$),A||I.updatePathMinMax(g,j,$);break;case p.OPS.lineTo:j=c[U++],$=c[U++],O.lineTo(j,$),A||I.updatePathMinMax(g,j,$);break;case p.OPS.curveTo:z=j,i=$,j=c[U+4],$=c[U+5],O.bezierCurveTo(c[U],c[U+1],c[U+2],c[U+3],j,$),I.updateCurvePathMinMax(g,z,i,c[U],c[U+1],c[U+2],c[U+3],j,$,C),U+=6;break;case p.OPS.curveTo2:z=j,i=$,O.bezierCurveTo(j,$,c[U],c[U+1],c[U+2],c[U+3]),I.updateCurvePathMinMax(g,z,i,j,$,c[U],c[U+1],c[U+2],c[U+3],C),j=c[U+2],$=c[U+3],U+=4;break;case p.OPS.curveTo3:z=j,i=$,j=c[U+2],$=c[U+3],O.bezierCurveTo(c[U],c[U+1],j,$,j,$),I.updateCurvePathMinMax(g,z,i,c[U],c[U+1],j,$,j,$,C),U+=4;break;case p.OPS.closePath:O.closePath();break}A&&I.updateScalingPathMinMax(g,C),I.setCurrentPoint(j,$)}closePath(){this.ctx.closePath()}stroke(h){h=typeof h!="undefined"?h:!0;const c=this.ctx,w=this.current.strokeColor;c.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof w=="object"&&(w==null?void 0:w.getPattern)?(c.save(),c.strokeStyle=w.getPattern(c,this,(0,u.getCurrentTransformInverse)(c),B.PathType.STROKE),this.rescaleAndStroke(!1),c.restore()):this.rescaleAndStroke(!0)),h&&this.consumePath(this.current.getClippedPathBoundingBox()),c.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(h){h=typeof h!="undefined"?h:!0;const c=this.ctx,w=this.current.fillColor,O=this.current.patternFill;let I=!1;O&&(c.save(),c.fillStyle=w.getPattern(c,this,(0,u.getCurrentTransformInverse)(c),B.PathType.FILL),I=!0);const j=this.current.getClippedPathBoundingBox();this.contentVisible&&j!==null&&(this.pendingEOFill?(c.fill("evenodd"),this.pendingEOFill=!1):c.fill()),I&&c.restore(),h&&this.consumePath(j)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=W}eoClip(){this.pendingClip=G}beginText(){this.current.textMatrix=p.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const h=this.pendingTextPaths,c=this.ctx;if(h===void 0){c.beginPath();return}c.save(),c.beginPath();for(const w of h)c.setTransform(...w.transform),c.translate(w.x,w.y),w.addToPath(c,w.fontSize);c.restore(),c.clip(),c.beginPath(),delete this.pendingTextPaths}setCharSpacing(h){this.current.charSpacing=h}setWordSpacing(h){this.current.wordSpacing=h}setHScale(h){this.current.textHScale=h/100}setLeading(h){this.current.leading=-h}setFont(h,c){const w=this.commonObjs.get(h),O=this.current;if(!w)throw new Error(`Can't find font for ${h}`);if(O.fontMatrix=w.fontMatrix||p.FONT_IDENTITY_MATRIX,(O.fontMatrix[0]===0||O.fontMatrix[3]===0)&&(0,p.warn)("Invalid font matrix for font "+h),c<0?(c=-c,O.fontDirection=-1):O.fontDirection=1,this.current.font=w,this.current.fontSize=c,w.isType3Font)return;const I=w.loadedName||"sans-serif";let j="normal";w.black?j="900":w.bold&&(j="bold");const $=w.italic?"italic":"normal",z=`"${I}", ${w.fallbackName}`;let i=c;c<L?i=L:c>f&&(i=f),this.current.fontSizeScale=c/i,this.ctx.font=`${$} ${j} ${i}px ${z}`}setTextRenderingMode(h){this.current.textRenderingMode=h}setTextRise(h){this.current.textRise=h}moveText(h,c){this.current.x=this.current.lineX+=h,this.current.y=this.current.lineY+=c}setLeadingMoveText(h,c){this.setLeading(-c),this.moveText(h,c)}setTextMatrix(h,c,w,O,I,j){this.current.textMatrix=[h,c,w,O,I,j],this.current.textMatrixScale=Math.hypot(h,c),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(h,c,w,O){const I=this.ctx,j=this.current,$=j.font,z=j.textRenderingMode,i=j.fontSize/j.fontSizeScale,g=z&p.TextRenderingMode.FILL_STROKE_MASK,A=!!(z&p.TextRenderingMode.ADD_TO_PATH_FLAG),C=j.patternFill&&!$.missingFile;let F;($.disableFontFace||A||C)&&(F=$.getPathGenerator(this.commonObjs,h)),$.disableFontFace||C?(I.save(),I.translate(c,w),I.beginPath(),F(I,i),O&&I.setTransform(...O),(g===p.TextRenderingMode.FILL||g===p.TextRenderingMode.FILL_STROKE)&&I.fill(),(g===p.TextRenderingMode.STROKE||g===p.TextRenderingMode.FILL_STROKE)&&I.stroke(),I.restore()):((g===p.TextRenderingMode.FILL||g===p.TextRenderingMode.FILL_STROKE)&&I.fillText(h,c,w),(g===p.TextRenderingMode.STROKE||g===p.TextRenderingMode.FILL_STROKE)&&I.strokeText(h,c,w)),A&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,u.getCurrentTransform)(I),x:c,y:w,fontSize:i,addToPath:F})}get isFontSubpixelAAEnabled(){const{context:h}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);h.scale(1.5,1),h.fillText("I",0,10);const c=h.getImageData(0,0,10,10).data;let w=!1;for(let O=3;O<c.length;O+=4)if(c[O]>0&&c[O]<255){w=!0;break}return(0,p.shadow)(this,"isFontSubpixelAAEnabled",w)}showText(h){const c=this.current,w=c.font;if(w.isType3Font)return this.showType3Text(h);const O=c.fontSize;if(O===0)return;const I=this.ctx,j=c.fontSizeScale,$=c.charSpacing,z=c.wordSpacing,i=c.fontDirection,g=c.textHScale*i,A=h.length,C=w.vertical,F=C?1:-1,U=w.defaultVMetrics,st=O*c.fontMatrix[0],dt=c.textRenderingMode===p.TextRenderingMode.FILL&&!w.disableFontFace&&!c.patternFill;I.save(),I.transform(...c.textMatrix),I.translate(c.x,c.y+c.textRise),i>0?I.scale(g,-1):I.scale(g,1);let tt;if(c.patternFill){I.save();const M=c.fillColor.getPattern(I,this,(0,u.getCurrentTransformInverse)(I),B.PathType.FILL);tt=(0,u.getCurrentTransform)(I),I.restore(),I.fillStyle=M}let ot=c.lineWidth;const et=c.textMatrixScale;if(et===0||ot===0){const M=c.textRenderingMode&p.TextRenderingMode.FILL_STROKE_MASK;(M===p.TextRenderingMode.STROKE||M===p.TextRenderingMode.FILL_STROKE)&&(ot=this.getSinglePixelWidth())}else ot/=et;j!==1&&(I.scale(j,j),ot/=j),I.lineWidth=ot;let lt=0,ft;for(ft=0;ft<A;++ft){const M=h[ft];if(typeof M=="number"){lt+=F*M*O/1e3;continue}let ut=!1;const At=(M.isSpace?z:0)+$,vt=M.fontChar,Et=M.accent;let Tt,Rt,Ft=M.width;if(C){const wt=M.vmetric||U,Ot=-(M.vmetric?wt[1]:Ft*.5)*st,Zt=wt[2]*st;Ft=wt?-wt[0]:Ft,Tt=Ot/j,Rt=(lt+Zt)/j}else Tt=lt/j,Rt=0;if(w.remeasure&&Ft>0){const wt=I.measureText(vt).width*1e3/O*j;if(Ft<wt&&this.isFontSubpixelAAEnabled){const Ot=Ft/wt;ut=!0,I.save(),I.scale(Ot,1),Tt/=Ot}else Ft!==wt&&(Tt+=(Ft-wt)/2e3*O/j)}if(this.contentVisible&&(M.isInFont||w.missingFile)){if(dt&&!Et)I.fillText(vt,Tt,Rt);else if(this.paintChar(vt,Tt,Rt,tt),Et){const wt=Tt+O*Et.offset.x/j,Ot=Rt-O*Et.offset.y/j;this.paintChar(Et.fontChar,wt,Ot,tt)}}let Xt;C?Xt=Ft*st-At*i:Xt=Ft*st+At*i,lt+=Xt,ut&&I.restore()}C?c.y-=lt:c.x+=lt*g,I.restore(),this.compose()}showType3Text(h){const c=this.ctx,w=this.current,O=w.font,I=w.fontSize,j=w.fontDirection,$=O.vertical?1:-1,z=w.charSpacing,i=w.wordSpacing,g=w.textHScale*j,A=w.fontMatrix||p.FONT_IDENTITY_MATRIX,C=h.length,F=w.textRenderingMode===p.TextRenderingMode.INVISIBLE;let U,st,dt,tt;if(!(F||I===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,c.save(),c.transform(...w.textMatrix),c.translate(w.x,w.y),c.scale(g,j),U=0;U<C;++U){if(st=h[U],typeof st=="number"){tt=$*st*I/1e3,this.ctx.translate(tt,0),w.x+=tt*g;continue}const ot=(st.isSpace?i:0)+z,et=O.charProcOperatorList[st.operatorListId];if(!et){(0,p.warn)(`Type3 character "${st.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=st,this.save(),c.scale(I,I),c.transform(...A),this.executeOperatorList(et),this.restore()),dt=p.Util.applyTransform([st.width,0],A)[0]*I+ot,c.translate(dt,0),w.x+=dt*g}c.restore(),this.processingType3=null}}setCharWidth(h,c){}setCharWidthAndBounds(h,c,w,O,I,j){this.ctx.rect(w,O,I-w,j-O),this.ctx.clip(),this.endPath()}getColorN_Pattern(h){let c;if(h[0]==="TilingPattern"){const w=h[1],O=this.baseTransform||(0,u.getCurrentTransform)(this.ctx),I={createCanvasGraphics:j=>new bt(j,this.commonObjs,this.objs,this.canvasFactory)};c=new B.TilingPattern(h,w,this.ctx,I,O)}else c=this._getPattern(h[1],h[2]);return c}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(h,c,w){var I;const O=((I=this.selectColor)==null?void 0:I.call(this,h,c,w))||p.Util.makeHexColor(h,c,w);this.ctx.strokeStyle=O,this.current.strokeColor=O}setFillRGBColor(h,c,w){var I;const O=((I=this.selectColor)==null?void 0:I.call(this,h,c,w))||p.Util.makeHexColor(h,c,w);this.ctx.fillStyle=O,this.current.fillColor=O,this.current.patternFill=!1}_getPattern(h,c=null){let w;return this.cachedPatterns.has(h)?w=this.cachedPatterns.get(h):(w=(0,B.getShadingPattern)(this.objs.get(h)),this.cachedPatterns.set(h,w)),c&&(w.matrix=c),w}shadingFill(h){if(!this.contentVisible)return;const c=this.ctx;this.save();const w=this._getPattern(h);c.fillStyle=w.getPattern(c,this,(0,u.getCurrentTransformInverse)(c),B.PathType.SHADING);const O=(0,u.getCurrentTransformInverse)(c);if(O){const I=c.canvas,j=I.width,$=I.height,z=p.Util.applyTransform([0,0],O),i=p.Util.applyTransform([0,$],O),g=p.Util.applyTransform([j,0],O),A=p.Util.applyTransform([j,$],O),C=Math.min(z[0],i[0],g[0],A[0]),F=Math.min(z[1],i[1],g[1],A[1]),U=Math.max(z[0],i[0],g[0],A[0]),st=Math.max(z[1],i[1],g[1],A[1]);this.ctx.fillRect(C,F,U-C,st-F)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,p.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,p.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(h,c){if(!!this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(h)&&h.length===6&&this.transform(...h),this.baseTransform=(0,u.getCurrentTransform)(this.ctx),c)){const w=c[2]-c[0],O=c[3]-c[1];this.ctx.rect(c[0],c[1],w,O),this.current.updateRectMinMax((0,u.getCurrentTransform)(this.ctx),c),this.clip(),this.endPath()}}paintFormXObjectEnd(){!this.contentVisible||(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(h){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const c=this.ctx;h.isolated||(0,p.info)("TODO: Support non-isolated groups."),h.knockout&&(0,p.warn)("Knockout groups not supported.");const w=(0,u.getCurrentTransform)(c);if(h.matrix&&c.transform(...h.matrix),!h.bbox)throw new Error("Bounding box is required.");let O=p.Util.getAxialAlignedBoundingBox(h.bbox,(0,u.getCurrentTransform)(c));const I=[0,0,c.canvas.width,c.canvas.height];O=p.Util.intersect(O,I)||[0,0,0,0];const j=Math.floor(O[0]),$=Math.floor(O[1]);let z=Math.max(Math.ceil(O[2])-j,1),i=Math.max(Math.ceil(O[3])-$,1),g=1,A=1;z>E&&(g=z/E,z=E),i>E&&(A=i/E,i=E),this.current.startNewPathAndClipBox([0,0,z,i]);let C="groupAt"+this.groupLevel;h.smask&&(C+="_smask_"+this.smaskCounter++%2);const F=this.cachedCanvases.getCanvas(C,z,i),U=F.context;U.scale(1/g,1/A),U.translate(-j,-$),U.transform(...w),h.smask?this.smaskStack.push({canvas:F.canvas,context:U,offsetX:j,offsetY:$,scaleX:g,scaleY:A,subtype:h.smask.subtype,backdrop:h.smask.backdrop,transferMap:h.smask.transferMap||null,startTransformInverse:null}):(c.setTransform(1,0,0,1,0,0),c.translate(j,$),c.scale(g,A),c.save()),n(c,U),this.ctx=U,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(c),this.groupLevel++}endGroup(h){if(!this.contentVisible)return;this.groupLevel--;const c=this.ctx,w=this.groupStack.pop();if(this.ctx=w,this.ctx.imageSmoothingEnabled=!1,h.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const O=(0,u.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...O);const I=p.Util.getAxialAlignedBoundingBox([0,0,c.canvas.width,c.canvas.height],O);this.ctx.drawImage(c.canvas,0,0),this.ctx.restore(),this.compose(I)}}beginAnnotation(h,c,w,O,I){if(ht(this,nt,fe).call(this),d(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(c)&&c.length===4){const j=c[2]-c[0],$=c[3]-c[1];if(I&&this.annotationCanvasMap){w=w.slice(),w[4]-=c[0],w[5]-=c[1],c=c.slice(),c[0]=c[1]=0,c[2]=j,c[3]=$;const[z,i]=p.Util.singularValueDecompose2dScale((0,u.getCurrentTransform)(this.ctx)),{viewportScale:g}=this,A=Math.ceil(j*this.outputScaleX*g),C=Math.ceil($*this.outputScaleY*g);this.annotationCanvas=this.canvasFactory.create(A,C);const{canvas:F,context:U}=this.annotationCanvas;this.annotationCanvasMap.set(h,F),this.annotationCanvas.savedCtx=this.ctx,this.ctx=U,this.ctx.setTransform(z,0,0,-i,0,$*i),d(this.ctx,this.foregroundColor)}else d(this.ctx,this.foregroundColor),this.ctx.rect(c[0],c[1],j,$),this.ctx.clip(),this.endPath()}this.current=new b(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...w),this.transform(...O)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(h){if(!this.contentVisible)return;const c=h.count;h=this.getObject(h.data,h),h.count=c;const w=this.ctx,O=this.processingType3;if(O&&(O.compiled===void 0&&(O.compiled=_(h)),O.compiled)){O.compiled(w);return}const I=this._createMaskCanvas(h),j=I.canvas;w.save(),w.setTransform(1,0,0,1,0,0),w.drawImage(j,I.offsetX,I.offsetY),w.restore(),this.compose()}paintImageMaskXObjectRepeat(h,c,w=0,O=0,I,j){if(!this.contentVisible)return;h=this.getObject(h.data,h);const $=this.ctx;$.save();const z=(0,u.getCurrentTransform)($);$.transform(c,w,O,I,0,0);const i=this._createMaskCanvas(h);$.setTransform(1,0,0,1,0,0);for(let g=0,A=j.length;g<A;g+=2){const C=p.Util.transform(z,[c,w,O,I,j[g],j[g+1]]),[F,U]=p.Util.applyTransform([0,0],C);$.drawImage(i.canvas,F,U)}$.restore(),this.compose()}paintImageMaskXObjectGroup(h){if(!this.contentVisible)return;const c=this.ctx,w=this.current.fillColor,O=this.current.patternFill;for(const I of h){const{data:j,width:$,height:z,transform:i}=I,g=this.cachedCanvases.getCanvas("maskCanvas",$,z),A=g.context;A.save();const C=this.getObject(j,I);e(A,C),A.globalCompositeOperation="source-in",A.fillStyle=O?w.getPattern(A,this,(0,u.getCurrentTransformInverse)(c),B.PathType.FILL):w,A.fillRect(0,0,$,z),A.restore(),c.save(),c.transform(...i),c.scale(1,-1),l(c,g.canvas,0,0,$,z,0,-1,1,1),c.restore()}this.compose()}paintImageXObject(h){if(!this.contentVisible)return;const c=this.getObject(h);if(!c){(0,p.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(c)}paintImageXObjectRepeat(h,c,w,O){if(!this.contentVisible)return;const I=this.getObject(h);if(!I){(0,p.warn)("Dependent image isn't ready yet");return}const j=I.width,$=I.height,z=[];for(let i=0,g=O.length;i<g;i+=2)z.push({transform:[c,0,0,w,O[i],O[i+1]],x:0,y:0,w:j,h:$});this.paintInlineImageXObjectGroup(I,z)}paintInlineImageXObject(h){if(!this.contentVisible)return;const c=h.width,w=h.height,O=this.ctx;this.save(),O.scale(1/c,-1/w);let I;if(typeof HTMLElement=="function"&&h instanceof HTMLElement||!h.data)I=h;else{const i=this.cachedCanvases.getCanvas("inlineImage",c,w),g=i.context;o(g,h,this.current.transferMaps),I=i.canvas}const j=this._scaleImage(I,(0,u.getCurrentTransformInverse)(O));O.imageSmoothingEnabled=it((0,u.getCurrentTransform)(O),h.interpolate);const[$,z]=l(O,j.img,0,0,j.paintWidth,j.paintHeight,0,-w,c,w);if(this.imageLayer){const[i,g]=p.Util.applyTransform([0,-w],(0,u.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:h,left:i,top:g,width:$,height:z})}this.compose(),this.restore()}paintInlineImageXObjectGroup(h,c){if(!this.contentVisible)return;const w=this.ctx,O=h.width,I=h.height,j=this.cachedCanvases.getCanvas("inlineImage",O,I),$=j.context;o($,h,this.current.transferMaps);for(const z of c){if(w.save(),w.transform(...z.transform),w.scale(1,-1),l(w,j.canvas,z.x,z.y,z.w,z.h,0,-1,1,1),this.imageLayer){const[i,g]=p.Util.applyTransform([z.x,z.y],(0,u.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:h,left:i,top:g,width:O,height:I})}w.restore()}this.compose()}paintSolidColorImageMask(){!this.contentVisible||(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(h){}markPointProps(h,c){}beginMarkedContent(h){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(h,c){h==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(c)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(h){const c=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(h);const w=this.ctx;this.pendingClip&&(c||(this.pendingClip===G?w.clip("evenodd"):w.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),w.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const h=(0,u.getCurrentTransform)(this.ctx);if(h[1]===0&&h[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(h[0]),Math.abs(h[3]));else{const c=Math.abs(h[0]*h[3]-h[2]*h[1]),w=Math.hypot(h[0],h[2]),O=Math.hypot(h[1],h[3]);this._cachedGetSinglePixelWidth=Math.max(w,O)/c}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:h}=this.current,c=(0,u.getCurrentTransform)(this.ctx);let w,O;if(c[1]===0&&c[2]===0){const I=Math.abs(c[0]),j=Math.abs(c[3]);if(h===0)w=1/I,O=1/j;else{const $=I*h,z=j*h;w=$<1?1/$:1,O=z<1?1/z:1}}else{const I=Math.abs(c[0]*c[3]-c[2]*c[1]),j=Math.hypot(c[0],c[1]),$=Math.hypot(c[2],c[3]);if(h===0)w=$/I,O=j/I;else{const z=h*I;w=$>z?$/z:1,O=j>z?j/z:1}}this._cachedScaleForStroking=[w,O]}return this._cachedScaleForStroking}rescaleAndStroke(h){const{ctx:c}=this,{lineWidth:w}=this.current,[O,I]=this.getScaleForStroking();if(c.lineWidth=w||1,O===1&&I===1){c.stroke();return}let j,$,z;h&&(j=(0,u.getCurrentTransform)(c),$=c.getLineDash().slice(),z=c.lineDashOffset),c.scale(O,I);const i=Math.max(O,I);c.setLineDash(c.getLineDash().map(g=>g/i)),c.lineDashOffset/=i,c.stroke(),h&&(c.setTransform(...j),c.setLineDash($),c.lineDashOffset=z)}isContentVisible(){for(let h=this.markedContentStack.length-1;h>=0;h--)if(!this.markedContentStack[h].visible)return!1;return!0}};let V=bt;nt=new WeakSet,fe=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},a.CanvasGraphics=V;for(const N in p.OPS)V.prototype[N]!==void 0&&(V.prototype[p.OPS[N]]=V.prototype[N])},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TilingPattern=a.PathType=void 0,a.getShadingPattern=r;var u=R(1),p=R(8),B=R(3);const D={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};a.PathType=D;function J(l,_){if(!_||B.isNodeJS)return;const b=_[2]-_[0],o=_[3]-_[1],e=new Path2D;e.rect(_[0],_[1],b,o),l.clip(e)}class L{constructor(){this.constructor===L&&(0,u.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,u.unreachable)("Abstract method `getPattern` called.")}}class f extends L{constructor(_){super(),this._type=_[1],this._bbox=_[2],this._colorStops=_[3],this._p0=_[4],this._p1=_[5],this._r0=_[6],this._r1=_[7],this.matrix=null}_createGradient(_){let b;this._type==="axial"?b=_.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(b=_.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const o of this._colorStops)b.addColorStop(o[0],o[1]);return b}getPattern(_,b,o,e){let n;if(e===D.STROKE||e===D.FILL){const d=b.current.getClippedPathBoundingBox(e,(0,p.getCurrentTransform)(_))||[0,0,0,0],T=Math.ceil(d[2]-d[0])||1,S=Math.ceil(d[3]-d[1])||1,m=b.cachedCanvases.getCanvas("pattern",T,S,!0),x=m.context;x.clearRect(0,0,x.canvas.width,x.canvas.height),x.beginPath(),x.rect(0,0,x.canvas.width,x.canvas.height),x.translate(-d[0],-d[1]),o=u.Util.transform(o,[1,0,0,1,d[0],d[1]]),x.transform(...b.baseTransform),this.matrix&&x.transform(...this.matrix),J(x,this._bbox),x.fillStyle=this._createGradient(x),x.fill(),n=_.createPattern(m.canvas,"no-repeat");const Q=new DOMMatrix(o);try{n.setTransform(Q)}catch(it){(0,u.warn)(`RadialAxialShadingPattern.getPattern: "${it==null?void 0:it.message}".`)}}else J(_,this._bbox),n=this._createGradient(_);return n}}function E(l,_,b,o,e,n,d,T){const S=_.coords,m=_.colors,x=l.data,Q=l.width*4;let it;S[b+1]>S[o+1]&&(it=b,b=o,o=it,it=n,n=d,d=it),S[o+1]>S[e+1]&&(it=o,o=e,e=it,it=d,d=T,T=it),S[b+1]>S[o+1]&&(it=b,b=o,o=it,it=n,n=d,d=it);const Z=(S[b]+_.offsetX)*_.scaleX,Y=(S[b+1]+_.offsetY)*_.scaleY,W=(S[o]+_.offsetX)*_.scaleX,G=(S[o+1]+_.offsetY)*_.scaleY,V=(S[e]+_.offsetX)*_.scaleX,nt=(S[e+1]+_.offsetY)*_.scaleY;if(Y>=nt)return;const ct=m[n],bt=m[n+1],N=m[n+2],h=m[d],c=m[d+1],w=m[d+2],O=m[T],I=m[T+1],j=m[T+2],$=Math.round(Y),z=Math.round(nt);let i,g,A,C,F,U,st,dt;for(let tt=$;tt<=z;tt++){if(tt<G){let M;tt<Y?M=0:M=(Y-tt)/(Y-G),i=Z-(Z-W)*M,g=ct-(ct-h)*M,A=bt-(bt-c)*M,C=N-(N-w)*M}else{let M;tt>nt?M=1:G===nt?M=0:M=(G-tt)/(G-nt),i=W-(W-V)*M,g=h-(h-O)*M,A=c-(c-I)*M,C=w-(w-j)*M}let ot;tt<Y?ot=0:tt>nt?ot=1:ot=(Y-tt)/(Y-nt),F=Z-(Z-V)*ot,U=ct-(ct-O)*ot,st=bt-(bt-I)*ot,dt=N-(N-j)*ot;const et=Math.round(Math.min(i,F)),lt=Math.round(Math.max(i,F));let ft=Q*tt+et*4;for(let M=et;M<=lt;M++)ot=(i-M)/(i-F),ot<0?ot=0:ot>1&&(ot=1),x[ft++]=g-(g-U)*ot|0,x[ft++]=A-(A-st)*ot|0,x[ft++]=C-(C-dt)*ot|0,x[ft++]=255}}function k(l,_,b){const o=_.coords,e=_.colors;let n,d;switch(_.type){case"lattice":const T=_.verticesPerRow,S=Math.floor(o.length/T)-1,m=T-1;for(n=0;n<S;n++){let x=n*T;for(let Q=0;Q<m;Q++,x++)E(l,b,o[x],o[x+1],o[x+T],e[x],e[x+1],e[x+T]),E(l,b,o[x+T+1],o[x+1],o[x+T],e[x+T+1],e[x+1],e[x+T])}break;case"triangles":for(n=0,d=o.length;n<d;n+=3)E(l,b,o[n],o[n+1],o[n+2],e[n],e[n+1],e[n+2]);break;default:throw new Error("illegal figure")}}class y extends L{constructor(_){super(),this._coords=_[2],this._colors=_[3],this._figures=_[4],this._bounds=_[5],this._bbox=_[7],this._background=_[8],this.matrix=null}_createMeshCanvas(_,b,o){const T=Math.floor(this._bounds[0]),S=Math.floor(this._bounds[1]),m=Math.ceil(this._bounds[2])-T,x=Math.ceil(this._bounds[3])-S,Q=Math.min(Math.ceil(Math.abs(m*_[0]*1.1)),3e3),it=Math.min(Math.ceil(Math.abs(x*_[1]*1.1)),3e3),Z=m/Q,Y=x/it,W={coords:this._coords,colors:this._colors,offsetX:-T,offsetY:-S,scaleX:1/Z,scaleY:1/Y},G=Q+2*2,V=it+2*2,nt=o.getCanvas("mesh",G,V,!1),ct=nt.context,bt=ct.createImageData(Q,it);if(b){const h=bt.data;for(let c=0,w=h.length;c<w;c+=4)h[c]=b[0],h[c+1]=b[1],h[c+2]=b[2],h[c+3]=255}for(const h of this._figures)k(bt,h,W);return ct.putImageData(bt,2,2),{canvas:nt.canvas,offsetX:T-2*Z,offsetY:S-2*Y,scaleX:Z,scaleY:Y}}getPattern(_,b,o,e){J(_,this._bbox);let n;if(e===D.SHADING)n=u.Util.singularValueDecompose2dScale((0,p.getCurrentTransform)(_));else if(n=u.Util.singularValueDecompose2dScale(b.baseTransform),this.matrix){const T=u.Util.singularValueDecompose2dScale(this.matrix);n=[n[0]*T[0],n[1]*T[1]]}const d=this._createMeshCanvas(n,e===D.SHADING?null:this._background,b.cachedCanvases);return e!==D.SHADING&&(_.setTransform(...b.baseTransform),this.matrix&&_.transform(...this.matrix)),_.translate(d.offsetX,d.offsetY),_.scale(d.scaleX,d.scaleY),_.createPattern(d.canvas,"no-repeat")}}class v extends L{getPattern(){return"hotpink"}}function r(l){switch(l[0]){case"RadialAxial":return new f(l);case"Mesh":return new y(l);case"Dummy":return new v}throw new Error(`Unknown IR type: ${l[0]}`)}const t={COLORED:1,UNCOLORED:2};class s{static get MAX_PATTERN_SIZE(){return(0,u.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(_,b,o,e,n){this.operatorList=_[2],this.matrix=_[3]||[1,0,0,1,0,0],this.bbox=_[4],this.xstep=_[5],this.ystep=_[6],this.paintType=_[7],this.tilingType=_[8],this.color=b,this.ctx=o,this.canvasGraphicsFactory=e,this.baseTransform=n}createPatternCanvas(_){const b=this.operatorList,o=this.bbox,e=this.xstep,n=this.ystep,d=this.paintType,T=this.tilingType,S=this.color,m=this.canvasGraphicsFactory;(0,u.info)("TilingType: "+T);const x=o[0],Q=o[1],it=o[2],Z=o[3],Y=u.Util.singularValueDecompose2dScale(this.matrix),W=u.Util.singularValueDecompose2dScale(this.baseTransform),G=[Y[0]*W[0],Y[1]*W[1]],V=this.getSizeAndScale(e,this.ctx.canvas.width,G[0]),nt=this.getSizeAndScale(n,this.ctx.canvas.height,G[1]),ct=_.cachedCanvases.getCanvas("pattern",V.size,nt.size,!0),bt=ct.context,N=m.createCanvasGraphics(bt);N.groupLevel=_.groupLevel,this.setFillAndStrokeStyleToContext(N,d,S);let h=x,c=Q,w=it,O=Z;return x<0&&(h=0,w+=Math.abs(x)),Q<0&&(c=0,O+=Math.abs(Q)),bt.translate(-(V.scale*h),-(nt.scale*c)),N.transform(V.scale,0,0,nt.scale,0,0),bt.save(),this.clipBbox(N,h,c,w,O),N.baseTransform=(0,p.getCurrentTransform)(N.ctx),N.executeOperatorList(b),N.endDrawing(),{canvas:ct.canvas,scaleX:V.scale,scaleY:nt.scale,offsetX:h,offsetY:c}}getSizeAndScale(_,b,o){_=Math.abs(_);const e=Math.max(s.MAX_PATTERN_SIZE,b);let n=Math.ceil(_*o);return n>=e?n=e:o=n/_,{scale:o,size:n}}clipBbox(_,b,o,e,n){const d=e-b,T=n-o;_.ctx.rect(b,o,d,T),_.current.updateRectMinMax((0,p.getCurrentTransform)(_.ctx),[b,o,e,n]),_.clip(),_.endPath()}setFillAndStrokeStyleToContext(_,b,o){const e=_.ctx,n=_.current;switch(b){case t.COLORED:const d=this.ctx;e.fillStyle=d.fillStyle,e.strokeStyle=d.strokeStyle,n.fillColor=d.fillStyle,n.strokeColor=d.strokeStyle;break;case t.UNCOLORED:const T=u.Util.makeHexColor(o[0],o[1],o[2]);e.fillStyle=T,e.strokeStyle=T,n.fillColor=T,n.strokeColor=T;break;default:throw new u.FormatError(`Unsupported paint type: ${b}`)}}getPattern(_,b,o,e){let n=o;e!==D.SHADING&&(n=u.Util.transform(n,b.baseTransform),this.matrix&&(n=u.Util.transform(n,this.matrix)));const d=this.createPatternCanvas(b);let T=new DOMMatrix(n);T=T.translate(d.offsetX,d.offsetY),T=T.scale(1/d.scaleX,1/d.scaleY);const S=_.createPattern(d.canvas,"repeat");try{S.setTransform(T)}catch(m){(0,u.warn)(`TilingPattern.getPattern: "${m==null?void 0:m.message}".`)}return S}}a.TilingPattern=s},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.applyMaskImageData=p;var u=R(1);function p({src:B,srcPos:D=0,dest:J,destPos:L=0,width:f,height:E,inverseDecode:k=!1}){const y=u.FeatureTest.isLittleEndian?4278190080:255,[v,r]=k?[0,y]:[y,0],t=f>>3,s=f&7,l=B.length;J=new Uint32Array(J.buffer);for(let _=0;_<E;_++){for(const o=D+t;D<o;D++){const e=D<l?B[D]:255;J[L++]=e&128?r:v,J[L++]=e&64?r:v,J[L++]=e&32?r:v,J[L++]=e&16?r:v,J[L++]=e&8?r:v,J[L++]=e&4?r:v,J[L++]=e&2?r:v,J[L++]=e&1?r:v}if(s===0)continue;const b=D<l?B[D++]:255;for(let o=0;o<s;o++)J[L++]=b&1<<7-o?r:v}return{srcPos:D,destPos:L}}},(X,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.GlobalWorkerOptions=void 0;const R=Object.create(null);a.GlobalWorkerOptions=R,R.workerPort=R.workerPort===void 0?null:R.workerPort,R.workerSrc=R.workerSrc===void 0?"":R.workerSrc},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.MessageHandler=void 0;var u=R(1);const p={UNKNOWN:0,DATA:1,ERROR:2},B={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function D(L){switch(L instanceof Error||typeof L=="object"&&L!==null||(0,u.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),L.name){case"AbortException":return new u.AbortException(L.message);case"MissingPDFException":return new u.MissingPDFException(L.message);case"PasswordException":return new u.PasswordException(L.message,L.code);case"UnexpectedResponseException":return new u.UnexpectedResponseException(L.message,L.status);case"UnknownErrorException":return new u.UnknownErrorException(L.message,L.details);default:return new u.UnknownErrorException(L.message,L.toString())}}class J{constructor(f,E,k){this.sourceName=f,this.targetName=E,this.comObj=k,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=y=>{const v=y.data;if(v.targetName!==this.sourceName)return;if(v.stream){this._processStreamMessage(v);return}if(v.callback){const t=v.callbackId,s=this.callbackCapabilities[t];if(!s)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],v.callback===p.DATA)s.resolve(v.data);else if(v.callback===p.ERROR)s.reject(D(v.reason));else throw new Error("Unexpected callback case");return}const r=this.actionHandler[v.action];if(!r)throw new Error(`Unknown action from worker: ${v.action}`);if(v.callbackId){const t=this.sourceName,s=v.sourceName;new Promise(function(l){l(r(v.data))}).then(function(l){k.postMessage({sourceName:t,targetName:s,callback:p.DATA,callbackId:v.callbackId,data:l})},function(l){k.postMessage({sourceName:t,targetName:s,callback:p.ERROR,callbackId:v.callbackId,reason:D(l)})});return}if(v.streamId){this._createStreamSink(v);return}r(v.data)},k.addEventListener("message",this._onComObjOnMessage)}on(f,E){const k=this.actionHandler;if(k[f])throw new Error(`There is already an actionName called "${f}"`);k[f]=E}send(f,E,k){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,data:E},k)}sendWithPromise(f,E,k){const y=this.callbackId++,v=(0,u.createPromiseCapability)();this.callbackCapabilities[y]=v;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,callbackId:y,data:E},k)}catch(r){v.reject(r)}return v.promise}sendWithStream(f,E,k,y){const v=this.streamId++,r=this.sourceName,t=this.targetName,s=this.comObj;return new ReadableStream({start:l=>{const _=(0,u.createPromiseCapability)();return this.streamControllers[v]={controller:l,startCall:_,pullCall:null,cancelCall:null,isClosed:!1},s.postMessage({sourceName:r,targetName:t,action:f,streamId:v,data:E,desiredSize:l.desiredSize},y),_.promise},pull:l=>{const _=(0,u.createPromiseCapability)();return this.streamControllers[v].pullCall=_,s.postMessage({sourceName:r,targetName:t,stream:B.PULL,streamId:v,desiredSize:l.desiredSize}),_.promise},cancel:l=>{(0,u.assert)(l instanceof Error,"cancel must have a valid reason");const _=(0,u.createPromiseCapability)();return this.streamControllers[v].cancelCall=_,this.streamControllers[v].isClosed=!0,s.postMessage({sourceName:r,targetName:t,stream:B.CANCEL,streamId:v,reason:D(l)}),_.promise}},k)}_createStreamSink(f){const E=f.streamId,k=this.sourceName,y=f.sourceName,v=this.comObj,r=this,t=this.actionHandler[f.action],s={enqueue(l,_=1,b){if(this.isCancelled)return;const o=this.desiredSize;this.desiredSize-=_,o>0&&this.desiredSize<=0&&(this.sinkCapability=(0,u.createPromiseCapability)(),this.ready=this.sinkCapability.promise),v.postMessage({sourceName:k,targetName:y,stream:B.ENQUEUE,streamId:E,chunk:l},b)},close(){this.isCancelled||(this.isCancelled=!0,v.postMessage({sourceName:k,targetName:y,stream:B.CLOSE,streamId:E}),delete r.streamSinks[E])},error(l){(0,u.assert)(l instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,v.postMessage({sourceName:k,targetName:y,stream:B.ERROR,streamId:E,reason:D(l)}))},sinkCapability:(0,u.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:f.desiredSize,ready:null};s.sinkCapability.resolve(),s.ready=s.sinkCapability.promise,this.streamSinks[E]=s,new Promise(function(l){l(t(f.data,s))}).then(function(){v.postMessage({sourceName:k,targetName:y,stream:B.START_COMPLETE,streamId:E,success:!0})},function(l){v.postMessage({sourceName:k,targetName:y,stream:B.START_COMPLETE,streamId:E,reason:D(l)})})}_processStreamMessage(f){const E=f.streamId,k=this.sourceName,y=f.sourceName,v=this.comObj,r=this.streamControllers[E],t=this.streamSinks[E];switch(f.stream){case B.START_COMPLETE:f.success?r.startCall.resolve():r.startCall.reject(D(f.reason));break;case B.PULL_COMPLETE:f.success?r.pullCall.resolve():r.pullCall.reject(D(f.reason));break;case B.PULL:if(!t){v.postMessage({sourceName:k,targetName:y,stream:B.PULL_COMPLETE,streamId:E,success:!0});break}t.desiredSize<=0&&f.desiredSize>0&&t.sinkCapability.resolve(),t.desiredSize=f.desiredSize,new Promise(function(s){s(t.onPull&&t.onPull())}).then(function(){v.postMessage({sourceName:k,targetName:y,stream:B.PULL_COMPLETE,streamId:E,success:!0})},function(s){v.postMessage({sourceName:k,targetName:y,stream:B.PULL_COMPLETE,streamId:E,reason:D(s)})});break;case B.ENQUEUE:if((0,u.assert)(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(f.chunk);break;case B.CLOSE:if((0,u.assert)(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),this._deleteStreamController(r,E);break;case B.ERROR:(0,u.assert)(r,"error should have stream controller"),r.controller.error(D(f.reason)),this._deleteStreamController(r,E);break;case B.CANCEL_COMPLETE:f.success?r.cancelCall.resolve():r.cancelCall.reject(D(f.reason)),this._deleteStreamController(r,E);break;case B.CANCEL:if(!t)break;new Promise(function(s){s(t.onCancel&&t.onCancel(D(f.reason)))}).then(function(){v.postMessage({sourceName:k,targetName:y,stream:B.CANCEL_COMPLETE,streamId:E,success:!0})},function(s){v.postMessage({sourceName:k,targetName:y,stream:B.CANCEL_COMPLETE,streamId:E,reason:D(s)})}),t.sinkCapability.reject(D(f.reason)),t.isCancelled=!0,delete this.streamSinks[E];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(f,E){await Promise.allSettled([f.startCall&&f.startCall.promise,f.pullCall&&f.pullCall.promise,f.cancelCall&&f.cancelCall.promise]),delete this.streamControllers[E]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}a.MessageHandler=J},(X,a,R)=>{var B,D;Object.defineProperty(a,"__esModule",{value:!0}),a.Metadata=void 0;var u=R(1);class p{constructor({parsedData:L,rawData:f}){at(this,B,void 0);at(this,D,void 0);mt(this,B,L),mt(this,D,f)}getRaw(){return P(this,D)}get(L){var f;return(f=P(this,B).get(L))!=null?f:null}getAll(){return(0,u.objectFromMap)(P(this,B))}has(L){return P(this,B).has(L)}}B=new WeakMap,D=new WeakMap,a.Metadata=p},(X,a,R)=>{var J,L,f,E,k,y,pe;Object.defineProperty(a,"__esModule",{value:!0}),a.OptionalContentConfig=void 0;var u=R(1);const p=Symbol("INTERNAL");class B{constructor(t,s){at(this,J,!0);this.name=t,this.intent=s}get visible(){return P(this,J)}_setVisible(t,s){t!==p&&(0,u.unreachable)("Internal method `_setVisible` called."),mt(this,J,s)}}J=new WeakMap;class D{constructor(t){at(this,y);at(this,L,!0);at(this,f,new Map);at(this,E,null);at(this,k,null);if(this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,mt(this,k,t.order);for(const s of t.groups)P(this,f).set(s.id,new B(s.name,s.intent));if(t.baseState==="OFF")for(const s of P(this,f).values())s._setVisible(p,!1);for(const s of t.on)P(this,f).get(s)._setVisible(p,!0);for(const s of t.off)P(this,f).get(s)._setVisible(p,!1);mt(this,E,new Map);for(const[s,l]of P(this,f))P(this,E).set(s,l.visible)}}isVisible(t){if(P(this,f).size===0)return!0;if(!t)return(0,u.warn)("Optional content group not defined."),!0;if(t.type==="OCG")return P(this,f).has(t.id)?P(this,f).get(t.id).visible:((0,u.warn)(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return ht(this,y,pe).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const s of t.ids){if(!P(this,f).has(s))return(0,u.warn)(`Optional content group not found: ${s}`),!0;if(P(this,f).get(s).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const s of t.ids){if(!P(this,f).has(s))return(0,u.warn)(`Optional content group not found: ${s}`),!0;if(!P(this,f).get(s).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const s of t.ids){if(!P(this,f).has(s))return(0,u.warn)(`Optional content group not found: ${s}`),!0;if(!P(this,f).get(s).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const s of t.ids){if(!P(this,f).has(s))return(0,u.warn)(`Optional content group not found: ${s}`),!0;if(P(this,f).get(s).visible)return!1}return!0}return(0,u.warn)(`Unknown optional content policy ${t.policy}.`),!0}return(0,u.warn)(`Unknown group type ${t.type}.`),!0}setVisibility(t,s=!0){if(!P(this,f).has(t)){(0,u.warn)(`Optional content group not found: ${t}`);return}P(this,f).get(t)._setVisible(p,!!s),mt(this,L,null)}get hasInitialVisibility(){if(P(this,L)!==null)return P(this,L);for(const[t,s]of P(this,f)){const l=P(this,E).get(t);if(s.visible!==l)return mt(this,L,!1)}return mt(this,L,!0)}getOrder(){return P(this,f).size?P(this,k)?P(this,k).slice():[...P(this,f).keys()]:null}getGroups(){return P(this,f).size>0?(0,u.objectFromMap)(P(this,f)):null}getGroup(t){return P(this,f).get(t)||null}}L=new WeakMap,f=new WeakMap,E=new WeakMap,k=new WeakMap,y=new WeakSet,pe=function(t){const s=t.length;if(s<2)return!0;const l=t[0];for(let _=1;_<s;_++){const b=t[_];let o;if(Array.isArray(b))o=ht(this,y,pe).call(this,b);else if(P(this,f).has(b))o=P(this,f).get(b).visible;else return(0,u.warn)(`Optional content group not found: ${b}`),!0;switch(l){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return l==="And"},a.OptionalContentConfig=D},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFDataTransportStream=void 0;var u=R(1),p=R(8);class B{constructor(f,E){(0,u.assert)(E,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=f.progressiveDone||!1,this._contentDispositionFilename=f.contentDispositionFilename||null;const k=f.initialData;if((k==null?void 0:k.length)>0){const y=new Uint8Array(k).buffer;this._queuedChunks.push(y)}this._pdfDataRangeTransport=E,this._isStreamingSupported=!f.disableStream,this._isRangeSupported=!f.disableRange,this._contentLength=f.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((y,v)=>{this._onReceiveData({begin:y,chunk:v})}),this._pdfDataRangeTransport.addProgressListener((y,v)=>{this._onProgress({loaded:y,total:v})}),this._pdfDataRangeTransport.addProgressiveReadListener(y=>{this._onReceiveData({chunk:y})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(f){const E=new Uint8Array(f.chunk).buffer;if(f.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(E):this._queuedChunks.push(E);else{const k=this._rangeReaders.some(function(y){return y._begin!==f.begin?!1:(y._enqueue(E),!0)});(0,u.assert)(k,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var f,E;return(E=(f=this._fullRequestReader)==null?void 0:f._loaded)!=null?E:0}_onProgress(f){if(f.total===void 0){const E=this._rangeReaders[0];E!=null&&E.onProgress&&E.onProgress({loaded:f.loaded})}else{const E=this._fullRequestReader;E!=null&&E.onProgress&&E.onProgress({loaded:f.loaded,total:f.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const E=this._rangeReaders.indexOf(f);E>=0&&this._rangeReaders.splice(E,1)}getFullReader(){(0,u.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new D(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,E){if(E<=this._progressiveDataLength)return null;const k=new J(this,f,E);return this._pdfDataRangeTransport.requestDataRange(f,E),this._rangeReaders.push(k),k}cancelAllRequests(f){this._fullRequestReader&&this._fullRequestReader.cancel(f);for(const E of this._rangeReaders.slice(0))E.cancel(f);this._pdfDataRangeTransport.abort()}}a.PDFDataTransportStream=B;class D{constructor(f,E,k=!1,y=null){this._stream=f,this._done=k||!1,this._filename=(0,p.isPdfFile)(y)?y:null,this._queuedChunks=E||[],this._loaded=0;for(const v of this._queuedChunks)this._loaded+=v.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=(0,u.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class J{constructor(f,E,k){this._stream=f,this._begin=E,this._end=k,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const k of this._requests)k.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const E=this._queuedChunk;return this._queuedChunk=null,{value:E,done:!1}}if(this._done)return{value:void 0,done:!0};const f=(0,u.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(X,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.XfaText=void 0;class R{static textContent(p){const B=[],D={items:B,styles:Object.create(null)};function J(L){var k;if(!L)return;let f=null;const E=L.name;if(E==="#text")f=L.value;else if(R.shouldBuildText(E))(k=L==null?void 0:L.attributes)!=null&&k.textContent?f=L.attributes.textContent:L.value&&(f=L.value);else return;if(f!==null&&B.push({str:f}),!!L.children)for(const y of L.children)J(y)}return J(p),D}static shouldBuildText(p){return!(p==="textarea"||p==="input"||p==="option"||p==="select")}}a.XfaText=R},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.NodeStandardFontDataFactory=a.NodeCanvasFactory=a.NodeCMapReaderFactory=void 0;var u=R(9);const p=function(L){return new Promise((f,E)=>{require$$4.readFile(L,(y,v)=>{if(y||!v){E(new Error(y));return}f(new Uint8Array(v))})})};class B extends u.BaseCanvasFactory{_createCanvas(f,E){return require$$4.createCanvas(f,E)}}a.NodeCanvasFactory=B;class D extends u.BaseCMapReaderFactory{_fetchData(f,E){return p(f).then(k=>({cMapData:k,compressionType:E}))}}a.NodeCMapReaderFactory=D;class J extends u.BaseStandardFontDataFactory{_fetchData(f){return p(f)}}a.NodeStandardFontDataFactory=J},(X,a,R)=>{var L,f,E,k,y,v,r,t,s,ge,_,Oe,o,me,n,De;Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationEditorLayer=void 0;var u=R(7),p=R(1),B=R(23),D=R(24);const T=class{constructor(m){at(this,s);at(this,_);at(this,o);at(this,n);at(this,L,void 0);at(this,f,!1);at(this,E,this.pointerup.bind(this));at(this,k,this.pointerdown.bind(this));at(this,y,new Map);at(this,v,!1);at(this,r,!1);at(this,t,void 0);T._initialized||(T._initialized=!0,B.FreeTextEditor.initialize(m.l10n),D.InkEditor.initialize(m.l10n),m.uiManager.registerEditorTypes([B.FreeTextEditor,D.InkEditor])),mt(this,t,m.uiManager),this.annotationStorage=m.annotationStorage,this.pageIndex=m.pageIndex,this.div=m.div,mt(this,L,m.accessibilityManager),P(this,t).addLayer(this)}updateToolbar(m){P(this,t).updateToolbar(m)}updateMode(m=P(this,t).getMode()){ht(this,n,De).call(this),m===p.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),P(this,t).unselectAll()}addInkEditorIfNeeded(m){if(!m&&P(this,t).getMode()!==p.AnnotationEditorType.INK)return;if(!m){for(const Q of P(this,y).values())if(Q.isEmpty()){Q.setInBackground();return}}ht(this,o,me).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(m){P(this,t).setEditingState(m)}addCommands(m){P(this,t).addCommands(m)}enable(){this.div.style.pointerEvents="auto";for(const m of P(this,y).values())m.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const m of P(this,y).values())m.disableEditing()}setActiveEditor(m){P(this,t).getActive()!==m&&P(this,t).setActiveEditor(m)}enableClick(){this.div.addEventListener("pointerdown",P(this,k)),this.div.addEventListener("pointerup",P(this,E))}disableClick(){this.div.removeEventListener("pointerdown",P(this,k)),this.div.removeEventListener("pointerup",P(this,E))}attach(m){P(this,y).set(m.id,m)}detach(m){var x;P(this,y).delete(m.id),(x=P(this,L))==null||x.removePointerInTextLayer(m.contentDiv)}remove(m){P(this,t).removeEditor(m),this.detach(m),this.annotationStorage.remove(m.id),m.div.style.display="none",setTimeout(()=>{m.div.style.display="",m.div.remove(),m.isAttachedToDOM=!1,document.activeElement===document.body&&P(this,t).focusMainContainer()},0),P(this,r)||this.addInkEditorIfNeeded(!1)}add(m){if(ht(this,s,ge).call(this,m),P(this,t).addEditor(m),this.attach(m),!m.isAttachedToDOM){const x=m.render();this.div.append(x),m.isAttachedToDOM=!0}this.moveEditorInDOM(m),m.onceAdded(),this.addToAnnotationStorage(m)}moveEditorInDOM(m){var x;(x=P(this,L))==null||x.moveElementInDOM(this.div,m.div,m.contentDiv,!0)}addToAnnotationStorage(m){!m.isEmpty()&&!this.annotationStorage.has(m.id)&&this.annotationStorage.setValue(m.id,m)}addOrRebuild(m){m.needsToBeRebuilt()?m.rebuild():this.add(m)}addANewEditor(m){const x=()=>{this.addOrRebuild(m)},Q=()=>{m.remove()};this.addCommands({cmd:x,undo:Q,mustExec:!0})}addUndoableEditor(m){const x=()=>{this.addOrRebuild(m)},Q=()=>{m.remove()};this.addCommands({cmd:x,undo:Q,mustExec:!1})}getNextId(){return P(this,t).getId()}deserialize(m){switch(m.annotationType){case p.AnnotationEditorType.FREETEXT:return B.FreeTextEditor.deserialize(m,this);case p.AnnotationEditorType.INK:return D.InkEditor.deserialize(m,this)}return null}setSelected(m){P(this,t).setSelected(m)}toggleSelected(m){P(this,t).toggleSelected(m)}isSelected(m){return P(this,t).isSelected(m)}unselect(m){P(this,t).unselect(m)}pointerup(m){const x=u.KeyboardManager.platform.isMac;if(!(m.button!==0||m.ctrlKey&&x)&&m.target===this.div&&!!P(this,v)){if(mt(this,v,!1),!P(this,f)){mt(this,f,!0);return}ht(this,o,me).call(this,m)}}pointerdown(m){const x=u.KeyboardManager.platform.isMac;if(m.button!==0||m.ctrlKey&&x||m.target!==this.div)return;mt(this,v,!0);const Q=P(this,t).getActive();mt(this,f,!Q||Q.isEmpty())}drop(m){const x=m.dataTransfer.getData("text/plain"),Q=P(this,t).getEditor(x);if(!Q)return;m.preventDefault(),m.dataTransfer.dropEffect="move",ht(this,s,ge).call(this,Q);const it=this.div.getBoundingClientRect(),Z=m.clientX-it.x,Y=m.clientY-it.y;Q.translate(Z-Q.startX,Y-Q.startY),this.moveEditorInDOM(Q),Q.div.focus()}dragover(m){m.preventDefault()}destroy(){var m,x;((m=P(this,t).getActive())==null?void 0:m.parent)===this&&P(this,t).setActiveEditor(null);for(const Q of P(this,y).values())(x=P(this,L))==null||x.removePointerInTextLayer(Q.contentDiv),Q.isAttachedToDOM=!1,Q.div.remove(),Q.parent=null;this.div=null,P(this,y).clear(),P(this,t).removeLayer(this)}render(m){this.viewport=m.viewport,(0,u.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const x of P(this,t).getEditors(this.pageIndex))this.add(x);this.updateMode()}update(m){this.viewport=m.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[m,x,Q,it]=this.viewport.viewBox,Z=Q-m,Y=it-x;return[Z,Y]}get viewportBaseDimensions(){const{width:m,height:x,rotation:Q}=this.viewport;return Q%180===0?[m,x]:[x,m]}setDimensions(){const{width:m,height:x,rotation:Q}=this.viewport,it=Q%180!==0,Z=Math.floor(m)+"px",Y=Math.floor(x)+"px";this.div.style.width=it?Y:Z,this.div.style.height=it?Z:Y,this.div.setAttribute("data-main-rotation",Q)}};let J=T;L=new WeakMap,f=new WeakMap,E=new WeakMap,k=new WeakMap,y=new WeakMap,v=new WeakMap,r=new WeakMap,t=new WeakMap,s=new WeakSet,ge=function(m){var x;m.parent!==this&&(this.attach(m),m.pageIndex=this.pageIndex,(x=m.parent)==null||x.detach(m),m.parent=this,m.div&&m.isAttachedToDOM&&(m.div.remove(),this.div.append(m.div)))},_=new WeakSet,Oe=function(m){switch(P(this,t).getMode()){case p.AnnotationEditorType.FREETEXT:return new B.FreeTextEditor(m);case p.AnnotationEditorType.INK:return new D.InkEditor(m)}return null},o=new WeakSet,me=function(m){const x=this.getNextId(),Q=ht(this,_,Oe).call(this,{parent:this,id:x,x:m.offsetX,y:m.offsetY});return Q&&this.add(Q),Q},n=new WeakSet,De=function(){mt(this,r,!0);for(const m of P(this,y).values())m.isEmpty()&&m.remove();mt(this,r,!1)},Mt(J,"_initialized",!1),a.AnnotationEditorLayer=J},(X,a,R)=>{var J,L,f,E,k,y,v,r,Ie,s,Le,_,Ne,o,_e;Object.defineProperty(a,"__esModule",{value:!0}),a.FreeTextEditor=void 0;var u=R(1),p=R(7),B=R(6);const n=class extends B.AnnotationEditor{constructor(S){super(oe(te({},S),{name:"freeTextEditor"}));at(this,r);at(this,s);at(this,_);at(this,o);at(this,J,this.editorDivBlur.bind(this));at(this,L,this.editorDivFocus.bind(this));at(this,f,this.editorDivKeydown.bind(this));at(this,E,void 0);at(this,k,"");at(this,y,!1);at(this,v,void 0);mt(this,E,S.color||n._defaultColor||B.AnnotationEditor._defaultLineColor),mt(this,v,S.fontSize||n._defaultFontSize)}static initialize(S){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(x=>[x,S.get(x)]));const m=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(m.getPropertyValue("--freetext-padding"))}static updateDefaultParams(S,m){switch(S){case u.AnnotationEditorParamsType.FREETEXT_SIZE:n._defaultFontSize=m;break;case u.AnnotationEditorParamsType.FREETEXT_COLOR:n._defaultColor=m;break}}updateParams(S,m){switch(S){case u.AnnotationEditorParamsType.FREETEXT_SIZE:ht(this,r,Ie).call(this,m);break;case u.AnnotationEditorParamsType.FREETEXT_COLOR:ht(this,s,Le).call(this,m);break}}static get defaultPropertiesToUpdate(){return[[u.AnnotationEditorParamsType.FREETEXT_SIZE,n._defaultFontSize],[u.AnnotationEditorParamsType.FREETEXT_COLOR,n._defaultColor||B.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[u.AnnotationEditorParamsType.FREETEXT_SIZE,P(this,v)],[u.AnnotationEditorParamsType.FREETEXT_COLOR,P(this,E)]]}getInitialTranslation(){return[-n._internalPadding*this.parent.scaleFactor,-(n._internalPadding+P(this,v))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(u.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",P(this,f)),this.editorDiv.addEventListener("focus",P(this,L)),this.editorDiv.addEventListener("blur",P(this,J)))}disableEditMode(){!this.isInEditMode()||(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",P(this,f)),this.editorDiv.removeEventListener("focus",P(this,L)),this.editorDiv.removeEventListener("blur",P(this,J)),this.div.focus(),this.isEditing=!1)}focusin(S){super.focusin(S),S.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),P(this,y)||(mt(this,y,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),mt(this,k,ht(this,_,Ne).call(this).trimEnd()),ht(this,o,_e).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(S){this.enableEditMode(),this.editorDiv.focus()}keydown(S){S.target===this.div&&S.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(S){n._keyboardManager.exec(this,S)}editorDivFocus(S){this.isEditing=!0}editorDivBlur(S){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let S,m;this.width&&(S=this.x,m=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),n._l10nPromise.get("editor_free_text_aria_label").then(Q=>{var it;return(it=this.editorDiv)==null?void 0:it.setAttribute("aria-label",Q)}),n._l10nPromise.get("free_text_default_content").then(Q=>{var it;return(it=this.editorDiv)==null?void 0:it.setAttribute("default-content",Q)}),this.editorDiv.contentEditable=!0;const{style:x}=this.editorDiv;if(x.fontSize=`calc(${P(this,v)}px * var(--scale-factor))`,x.color=P(this,E),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,p.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Q,it]=this.parent.viewportBaseDimensions;this.setAt(S*Q,m*it,this.width*Q,this.height*it);for(const Z of P(this,k).split(`
`)){const Y=document.createElement("div");Y.append(Z?document.createTextNode(Z):document.createElement("br")),this.editorDiv.append(Y)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(S,m){const x=super.deserialize(S,m);return mt(x,v,S.fontSize),mt(x,E,u.Util.makeHexColor(...S.color)),mt(x,k,S.value),x}serialize(){if(this.isEmpty())return null;const S=n._internalPadding*this.parent.scaleFactor,m=this.getRect(S,S),x=B.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:u.AnnotationEditorType.FREETEXT,color:x,fontSize:P(this,v),value:P(this,k),pageIndex:this.parent.pageIndex,rect:m,rotation:this.rotation}}};let D=n;J=new WeakMap,L=new WeakMap,f=new WeakMap,E=new WeakMap,k=new WeakMap,y=new WeakMap,v=new WeakMap,r=new WeakSet,Ie=function(S){const m=Q=>{this.editorDiv.style.fontSize=`calc(${Q}px * var(--scale-factor))`,this.translate(0,-(Q-P(this,v))*this.parent.scaleFactor),mt(this,v,Q),ht(this,o,_e).call(this)},x=P(this,v);this.parent.addCommands({cmd:()=>{m(S)},undo:()=>{m(x)},mustExec:!0,type:u.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},s=new WeakSet,Le=function(S){const m=P(this,E);this.parent.addCommands({cmd:()=>{mt(this,E,S),this.editorDiv.style.color=S},undo:()=>{mt(this,E,m),this.editorDiv.style.color=m},mustExec:!0,type:u.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},_=new WeakSet,Ne=function(){const S=this.editorDiv.getElementsByTagName("div");if(S.length===0)return this.editorDiv.innerText;const m=[];for(let x=0,Q=S.length;x<Q;x++){const Z=S[x].firstChild;(Z==null?void 0:Z.nodeName)==="#text"?m.push(Z.data):m.push("")}return m.join(`
`)},o=new WeakSet,_e=function(){const[S,m]=this.parent.viewportBaseDimensions,x=this.div.getBoundingClientRect();this.width=x.width/S,this.height=x.height/m},Mt(D,"_freeTextDefaultContent",""),Mt(D,"_l10nPromise"),Mt(D,"_internalPadding",0),Mt(D,"_defaultColor",null),Mt(D,"_defaultFontSize",10),Mt(D,"_keyboardManager",new p.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],n.prototype.commitOrRemove]])),Mt(D,"_type","freetext"),a.FreeTextEditor=D},(X,a,R)=>{var f,E,k,y,v,r,t,s,l,_,b,o,e,n,d,je,S,Ue,x,Be,it,We,Y,be,G,qe,nt,He,bt,Ge,h,Gt,w,Ae,I,ne,$,se,i,Yt,A,ye,F,ie,st,ve,tt,Xe,et,ze,ft,Ve,ut,Se,vt,re,Tt,Kt,Ft,Ee;Object.defineProperty(a,"__esModule",{value:!0}),a.InkEditor=void 0,Object.defineProperty(a,"fitCurve",{enumerable:!0,get:function(){return B.fitCurve}});var u=R(1),p=R(6),B=R(25),D=R(7);const J=16,wt=class extends p.AnnotationEditor{constructor(rt){super(oe(te({},rt),{name:"inkEditor"}));at(this,d);at(this,S);at(this,x);at(this,it);at(this,Y);at(this,G);at(this,nt);at(this,bt);at(this,h);at(this,w);at(this,I);at(this,$);at(this,i);at(this,A);at(this,F);at(this,tt);at(this,et);at(this,ft);at(this,ut);at(this,vt);at(this,Tt);at(this,Ft);at(this,f,0);at(this,E,0);at(this,k,0);at(this,y,this.canvasPointermove.bind(this));at(this,v,this.canvasPointerleave.bind(this));at(this,r,this.canvasPointerup.bind(this));at(this,t,this.canvasPointerdown.bind(this));at(this,s,!1);at(this,l,!1);at(this,_,null);at(this,b,null);at(this,o,0);at(this,e,0);at(this,n,null);this.color=rt.color||null,this.thickness=rt.thickness||null,this.opacity=rt.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(rt){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(pt=>[pt,rt.get(pt)]))}static updateDefaultParams(rt,pt){switch(rt){case u.AnnotationEditorParamsType.INK_THICKNESS:wt._defaultThickness=pt;break;case u.AnnotationEditorParamsType.INK_COLOR:wt._defaultColor=pt;break;case u.AnnotationEditorParamsType.INK_OPACITY:wt._defaultOpacity=pt/100;break}}updateParams(rt,pt){switch(rt){case u.AnnotationEditorParamsType.INK_THICKNESS:ht(this,d,je).call(this,pt);break;case u.AnnotationEditorParamsType.INK_COLOR:ht(this,S,Ue).call(this,pt);break;case u.AnnotationEditorParamsType.INK_OPACITY:ht(this,x,Be).call(this,pt);break}}static get defaultPropertiesToUpdate(){return[[u.AnnotationEditorParamsType.INK_THICKNESS,wt._defaultThickness],[u.AnnotationEditorParamsType.INK_COLOR,wt._defaultColor||p.AnnotationEditor._defaultLineColor],[u.AnnotationEditorParamsType.INK_OPACITY,Math.round(wt._defaultOpacity*100)]]}get propertiesToUpdate(){var rt;return[[u.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||wt._defaultThickness],[u.AnnotationEditorParamsType.INK_COLOR,this.color||wt._defaultColor||p.AnnotationEditor._defaultLineColor],[u.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*((rt=this.opacity)!=null?rt:wt._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(ht(this,I,ne).call(this),ht(this,$,se).call(this)),this.isAttachedToDOM||(this.parent.add(this),ht(this,i,Yt).call(this)),ht(this,Tt,Kt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,P(this,b).disconnect(),mt(this,b,null),super.remove())}enableEditMode(){P(this,s)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",P(this,t)),this.canvas.addEventListener("pointerup",P(this,r)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",P(this,t)),this.canvas.removeEventListener("pointerup",P(this,r)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){P(this,s)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),mt(this,s,!0),this.div.classList.add("disabled"),ht(this,Tt,Kt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(rt){super.focusin(rt),this.enableEditMode()}canvasPointerdown(rt){rt.button!==0||!this.isInEditMode()||P(this,s)||(this.setInForeground(),rt.type!=="mouse"&&this.div.focus(),rt.stopPropagation(),this.canvas.addEventListener("pointerleave",P(this,v)),this.canvas.addEventListener("pointermove",P(this,y)),ht(this,G,qe).call(this,rt.offsetX,rt.offsetY))}canvasPointermove(rt){rt.stopPropagation(),ht(this,nt,He).call(this,rt.offsetX,rt.offsetY)}canvasPointerup(rt){rt.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(rt.stopPropagation(),ht(this,w,Ae).call(this,rt),this.setInBackground())}canvasPointerleave(rt){ht(this,w,Ae).call(this,rt),this.setInBackground()}render(){if(this.div)return this.div;let rt,pt;this.width&&(rt=this.x,pt=this.y),super.render(),wt._l10nPromise.get("editor_ink_aria_label").then(_t=>{var yt;return(yt=this.div)==null?void 0:yt.setAttribute("aria-label",_t)});const[K,q,H,gt]=ht(this,it,We).call(this);if(this.setAt(K,q,0,0),this.setDims(H,gt),ht(this,I,ne).call(this),this.width){const[_t,yt]=this.parent.viewportBaseDimensions;this.setAt(rt*_t,pt*yt,this.width*_t,this.height*yt),mt(this,l,!0),ht(this,i,Yt).call(this),this.setDims(this.width*_t,this.height*yt),ht(this,h,Gt).call(this),ht(this,Ft,Ee).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ht(this,$,se).call(this),this.div}setDimensions(rt,pt){const K=Math.round(rt),q=Math.round(pt);if(P(this,o)===K&&P(this,e)===q)return;mt(this,o,K),mt(this,e,q),this.canvas.style.visibility="hidden",P(this,f)&&Math.abs(P(this,f)-rt/pt)>.01&&(pt=Math.ceil(rt/P(this,f)),this.setDims(rt,pt));const[H,gt]=this.parent.viewportBaseDimensions;this.width=rt/H,this.height=pt/gt,P(this,s)&&ht(this,A,ye).call(this,rt,pt),ht(this,i,Yt).call(this),ht(this,h,Gt).call(this),this.canvas.style.visibility="visible"}static deserialize(rt,pt){var Dt,kt;const K=super.deserialize(rt,pt);K.thickness=rt.thickness,K.color=u.Util.makeHexColor(...rt.color),K.opacity=rt.opacity;const[q,H]=pt.pageDimensions,gt=K.width*q,_t=K.height*H,yt=pt.scaleFactor,St=rt.thickness/2;mt(K,f,gt/_t),mt(K,s,!0),mt(K,o,Math.round(gt)),mt(K,e,Math.round(_t));for(const{bezier:Ct}of rt.paths){const Lt=[];K.paths.push(Lt);let It=yt*(Ct[0]-St),Ut=yt*(_t-Ct[1]-St);for(let Nt=2,Wt=Ct.length;Nt<Wt;Nt+=6){const zt=yt*(Ct[Nt]-St),Vt=yt*(_t-Ct[Nt+1]-St),Ht=yt*(Ct[Nt+2]-St),jt=yt*(_t-Ct[Nt+3]-St),qt=yt*(Ct[Nt+4]-St),$t=yt*(_t-Ct[Nt+5]-St);Lt.push([[It,Ut],[zt,Vt],[Ht,jt],[qt,$t]]),It=qt,Ut=$t}const Pt=ht(this,st,ve).call(this,Lt);K.bezierPath2D.push(Pt)}const xt=ht(Dt=K,ut,Se).call(Dt);return mt(K,k,Math.max(J,xt[2]-xt[0])),mt(K,E,Math.max(J,xt[3]-xt[1])),ht(kt=K,A,ye).call(kt,gt,_t),K}serialize(){if(this.isEmpty())return null;const rt=this.getRect(0,0),pt=this.rotation%180===0?rt[3]-rt[1]:rt[2]-rt[0],K=p.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:u.AnnotationEditorType.INK,color:K,thickness:this.thickness,opacity:this.opacity,paths:ht(this,tt,Xe).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,pt),pageIndex:this.parent.pageIndex,rect:rt,rotation:this.rotation}}};let L=wt;f=new WeakMap,E=new WeakMap,k=new WeakMap,y=new WeakMap,v=new WeakMap,r=new WeakMap,t=new WeakMap,s=new WeakMap,l=new WeakMap,_=new WeakMap,b=new WeakMap,o=new WeakMap,e=new WeakMap,n=new WeakMap,d=new WeakSet,je=function(rt){const pt=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=rt,ht(this,Tt,Kt).call(this)},undo:()=>{this.thickness=pt,ht(this,Tt,Kt).call(this)},mustExec:!0,type:u.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},S=new WeakSet,Ue=function(rt){const pt=this.color;this.parent.addCommands({cmd:()=>{this.color=rt,ht(this,h,Gt).call(this)},undo:()=>{this.color=pt,ht(this,h,Gt).call(this)},mustExec:!0,type:u.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},x=new WeakSet,Be=function(rt){rt/=100;const pt=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=rt,ht(this,h,Gt).call(this)},undo:()=>{this.opacity=pt,ht(this,h,Gt).call(this)},mustExec:!0,type:u.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},it=new WeakSet,We=function(){const{width:rt,height:pt,rotation:K}=this.parent.viewport;switch(K){case 90:return[0,rt,rt,pt];case 180:return[rt,pt,rt,pt];case 270:return[pt,0,rt,pt];default:return[0,0,rt,pt]}},Y=new WeakSet,be=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,D.opacityToHex)(this.opacity)}`},G=new WeakSet,qe=function(rt,pt){var K;this.isEditing=!0,P(this,l)||(mt(this,l,!0),ht(this,i,Yt).call(this),this.thickness||(this.thickness=wt._defaultThickness),this.color||(this.color=wt._defaultColor||p.AnnotationEditor._defaultLineColor),(K=this.opacity)!=null||(this.opacity=wt._defaultOpacity)),this.currentPath.push([rt,pt]),mt(this,_,null),ht(this,Y,be).call(this),this.ctx.beginPath(),this.ctx.moveTo(rt,pt),mt(this,n,()=>{!P(this,n)||(P(this,_)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):ht(this,h,Gt).call(this),this.ctx.lineTo(...P(this,_)),mt(this,_,null),this.ctx.stroke()),window.requestAnimationFrame(P(this,n)))}),window.requestAnimationFrame(P(this,n))},nt=new WeakSet,He=function(rt,pt){const[K,q]=this.currentPath.at(-1);rt===K&&pt===q||(this.currentPath.push([rt,pt]),mt(this,_,[rt,pt]))},bt=new WeakSet,Ge=function(rt,pt){var St;this.ctx.closePath(),mt(this,n,null),rt=Math.min(Math.max(rt,0),this.canvas.width),pt=Math.min(Math.max(pt,0),this.canvas.height);const[K,q]=this.currentPath.at(-1);(rt!==K||pt!==q)&&this.currentPath.push([rt,pt]);let H;if(this.currentPath.length!==1)H=(0,B.fitCurve)(this.currentPath,30,null);else{const xt=[rt,pt];H=[[xt,xt.slice(),xt.slice(),xt]]}const gt=ht(St=wt,st,ve).call(St,H);this.currentPath.length=0;const _t=()=>{this.paths.push(H),this.bezierPath2D.push(gt),this.rebuild()},yt=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ht(this,I,ne).call(this),ht(this,$,se).call(this)),ht(this,Tt,Kt).call(this))};this.parent.addCommands({cmd:_t,undo:yt,mustExec:!0})},h=new WeakSet,Gt=function(){if(this.isEmpty()){ht(this,F,ie).call(this);return}ht(this,Y,be).call(this);const{canvas:rt,ctx:pt}=this;pt.setTransform(1,0,0,1,0,0),pt.clearRect(0,0,rt.width,rt.height),ht(this,F,ie).call(this);for(const K of this.bezierPath2D)pt.stroke(K)},w=new WeakSet,Ae=function(rt){ht(this,bt,Ge).call(this,rt.offsetX,rt.offsetY),this.canvas.removeEventListener("pointerleave",P(this,v)),this.canvas.removeEventListener("pointermove",P(this,y)),this.parent.addToAnnotationStorage(this)},I=new WeakSet,ne=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",wt._l10nPromise.get("editor_ink_canvas_aria_label").then(rt=>{var pt;return(pt=this.canvas)==null?void 0:pt.setAttribute("aria-label",rt)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},$=new WeakSet,se=function(){mt(this,b,new ResizeObserver(rt=>{const pt=rt[0].contentRect;pt.width&&pt.height&&this.setDimensions(pt.width,pt.height)})),P(this,b).observe(this.div)},i=new WeakSet,Yt=function(){if(!P(this,l))return;const[rt,pt]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*rt),this.canvas.height=Math.ceil(this.height*pt),ht(this,F,ie).call(this)},A=new WeakSet,ye=function(rt,pt){const K=ht(this,vt,re).call(this),q=(rt-K)/P(this,k),H=(pt-K)/P(this,E);this.scaleFactor=Math.min(q,H)},F=new WeakSet,ie=function(){const rt=ht(this,vt,re).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+rt,this.translationY*this.scaleFactor+rt)},st=new WeakSet,ve=function(rt){const pt=new Path2D;for(let K=0,q=rt.length;K<q;K++){const[H,gt,_t,yt]=rt[K];K===0&&pt.moveTo(...H),pt.bezierCurveTo(gt[0],gt[1],_t[0],_t[1],yt[0],yt[1])}return pt},tt=new WeakSet,Xe=function(rt,pt,K,q){const gt=[],_t=this.thickness/2;let yt,St;for(const xt of this.paths){yt=[],St=[];for(let Dt=0,kt=xt.length;Dt<kt;Dt++){const[Ct,Lt,It,Ut]=xt[Dt],Pt=rt*(Ct[0]+pt)+_t,Nt=q-rt*(Ct[1]+K)-_t,Wt=rt*(Lt[0]+pt)+_t,zt=q-rt*(Lt[1]+K)-_t,Vt=rt*(It[0]+pt)+_t,Ht=q-rt*(It[1]+K)-_t,jt=rt*(Ut[0]+pt)+_t,qt=q-rt*(Ut[1]+K)-_t;Dt===0&&(yt.push(Pt,Nt),St.push(Pt,Nt)),yt.push(Wt,zt,Vt,Ht,jt,qt),ht(this,et,ze).call(this,Pt,Nt,Wt,zt,Vt,Ht,jt,qt,4,St)}gt.push({bezier:yt,points:St})}return gt},et=new WeakSet,ze=function(rt,pt,K,q,H,gt,_t,yt,St,xt){if(ht(this,ft,Ve).call(this,rt,pt,K,q,H,gt,_t,yt)){xt.push(_t,yt);return}for(let Dt=1;Dt<St-1;Dt++){const kt=Dt/St,Ct=1-kt;let Lt=kt*rt+Ct*K,It=kt*pt+Ct*q,Ut=kt*K+Ct*H,Pt=kt*q+Ct*gt;const Nt=kt*H+Ct*_t,Wt=kt*gt+Ct*yt;Lt=kt*Lt+Ct*Ut,It=kt*It+Ct*Pt,Ut=kt*Ut+Ct*Nt,Pt=kt*Pt+Ct*Wt,Lt=kt*Lt+Ct*Ut,It=kt*It+Ct*Pt,xt.push(Lt,It)}xt.push(_t,yt)},ft=new WeakSet,Ve=function(rt,pt,K,q,H,gt,_t,yt){const xt=(3*K-2*rt-_t)**2,Dt=(3*q-2*pt-yt)**2,kt=(3*H-rt-2*_t)**2,Ct=(3*gt-pt-2*yt)**2;return Math.max(xt,kt)+Math.max(Dt,Ct)<=10},ut=new WeakSet,Se=function(){let rt=1/0,pt=-1/0,K=1/0,q=-1/0;for(const H of this.paths)for(const[gt,_t,yt,St]of H){const xt=u.Util.bezierBoundingBox(...gt,..._t,...yt,...St);rt=Math.min(rt,xt[0]),K=Math.min(K,xt[1]),pt=Math.max(pt,xt[2]),q=Math.max(q,xt[3])}return[rt,K,pt,q]},vt=new WeakSet,re=function(){return P(this,s)?Math.ceil(this.thickness*this.parent.scaleFactor):0},Tt=new WeakSet,Kt=function(rt=!1){if(this.isEmpty())return;if(!P(this,s)){ht(this,h,Gt).call(this);return}const pt=ht(this,ut,Se).call(this),K=ht(this,vt,re).call(this);mt(this,k,Math.max(J,pt[2]-pt[0])),mt(this,E,Math.max(J,pt[3]-pt[1]));const q=Math.ceil(K+P(this,k)*this.scaleFactor),H=Math.ceil(K+P(this,E)*this.scaleFactor),[gt,_t]=this.parent.viewportBaseDimensions;this.width=q/gt,this.height=H/_t,mt(this,f,q/H),ht(this,Ft,Ee).call(this);const yt=this.translationX,St=this.translationY;this.translationX=-pt[0],this.translationY=-pt[1],ht(this,i,Yt).call(this),ht(this,h,Gt).call(this),mt(this,o,q),mt(this,e,H),this.setDims(q,H);const xt=rt?K/this.scaleFactor/2:0;this.translate(yt-this.translationX-xt,St-this.translationY-xt)},Ft=new WeakSet,Ee=function(){const{style:rt}=this.div;P(this,f)>=1?(rt.minHeight=`${J}px`,rt.minWidth=`${Math.round(P(this,f)*J)}px`):(rt.minWidth=`${J}px`,rt.minHeight=`${Math.round(J/P(this,f))}px`)},at(L,st),Mt(L,"_defaultColor",null),Mt(L,"_defaultOpacity",1),Mt(L,"_defaultThickness",1),Mt(L,"_l10nPromise"),Mt(L,"_type","ink"),a.InkEditor=L},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.fitCurve=void 0;const u=R(26);a.fitCurve=u},X=>{function a(r,t,s){if(!Array.isArray(r))throw new TypeError("First argument should be an array");if(r.forEach(o=>{if(!Array.isArray(o)||o.some(e=>typeof e!="number")||o.length!==r[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),r=r.filter((o,e)=>e===0||!o.every((n,d)=>n===r[e-1][d])),r.length<2)return[];const l=r.length,_=k(r[1],r[0]),b=k(r[l-2],r[l-1]);return R(r,_,b,t,s)}function R(r,t,s,l,_){var o,e,n,d,T,S,m,x,Q,it,Z,Y,W;if(r.length===2)return Y=y.vectorLen(y.subtract(r[0],r[1]))/3,o=[r[0],y.addArrays(r[0],y.mulItems(t,Y)),y.addArrays(r[1],y.mulItems(s,Y)),r[1]],[o];if(e=J(r),[o,d,S]=u(r,e,e,t,s,_),d===0||d<l)return[o];if(d<l*l)for(n=e,T=d,m=S,W=0;W<20;W++){if(n=B(o,r,n),[o,d,S]=u(r,e,n,t,s,_),d<l)return[o];if(S===m){let G=d/T;if(G>.9999&&G<1.0001)break}T=d,m=S}return Z=[],x=y.subtract(r[S-1],r[S+1]),x.every(G=>G===0)&&(x=y.subtract(r[S-1],r[S]),[x[0],x[1]]=[-x[1],x[0]]),Q=y.normalize(x),it=y.mulItems(Q,-1),Z=Z.concat(R(r.slice(0,S+1),t,Q,l,_)),Z=Z.concat(R(r.slice(S),it,s,l,_)),Z}function u(r,t,s,l,_,b){var o,e,n;return o=p(r,s,l,_),[e,n]=L(r,o,t),b&&b({bez:o,points:r,params:t,maxErr:e,maxPoint:n}),[o,e,n]}function p(r,t,s,l){var _,b,o,e,n,d,T,S,m,x,Q,it,Z,Y,W,G,V,nt=r[0],ct=r[r.length-1];for(_=[nt,null,null,ct],b=y.zeros_Xx2x2(t.length),Z=0,Y=t.length;Z<Y;Z++)G=t[Z],V=1-G,o=b[Z],o[0]=y.mulItems(s,3*G*(V*V)),o[1]=y.mulItems(l,3*V*(G*G));for(e=[[0,0],[0,0]],n=[0,0],Z=0,Y=r.length;Z<Y;Z++)G=t[Z],o=b[Z],e[0][0]+=y.dot(o[0],o[0]),e[0][1]+=y.dot(o[0],o[1]),e[1][0]+=y.dot(o[0],o[1]),e[1][1]+=y.dot(o[1],o[1]),W=y.subtract(r[Z],v.q([nt,nt,ct,ct],G)),n[0]+=y.dot(o[0],W),n[1]+=y.dot(o[1],W);return d=e[0][0]*e[1][1]-e[1][0]*e[0][1],T=e[0][0]*n[1]-e[1][0]*n[0],S=n[0]*e[1][1]-n[1]*e[0][1],m=d===0?0:S/d,x=d===0?0:T/d,it=y.vectorLen(y.subtract(nt,ct)),Q=1e-6*it,m<Q||x<Q?(_[1]=y.addArrays(nt,y.mulItems(s,it/3)),_[2]=y.addArrays(ct,y.mulItems(l,it/3))):(_[1]=y.addArrays(nt,y.mulItems(s,m)),_[2]=y.addArrays(ct,y.mulItems(l,x))),_}function B(r,t,s){return s.map((l,_)=>D(r,t[_],l))}function D(r,t,s){var l=y.subtract(v.q(r,s),t),_=v.qprime(r,s),b=y.mulMatrix(l,_),o=y.sum(y.squareItems(_))+2*y.mulMatrix(l,v.qprimeprime(r,s));return o===0?s:s-b/o}function J(r){var t=[],s,l,_;return r.forEach((b,o)=>{s=o?l+y.vectorLen(y.subtract(b,_)):0,t.push(s),l=s,_=b}),t=t.map(b=>b/l),t}function L(r,t,s){var l,_,b,o,e,n,d,T;_=0,b=Math.floor(r.length/2);const S=f(t,10);for(e=0,n=r.length;e<n;e++)d=r[e],T=E(t,s[e],S,10),o=y.subtract(v.q(t,T),d),l=o[0]*o[0]+o[1]*o[1],l>_&&(_=l,b=e);return[_,b]}var f=function(r,t){for(var s,l=[0],_=r[0],b=0,o=1;o<=t;o++)s=v.q(r,o/t),b+=y.vectorLen(y.subtract(s,_)),l.push(b),_=s;return l=l.map(e=>e/b),l};function E(r,t,s,l){if(t<0)return 0;if(t>1)return 1;for(var _,b,o,e,n,d=1;d<=l;d++)if(t<=s[d]){e=(d-1)/l,o=d/l,b=s[d-1],_=s[d],n=(t-b)/(_-b)*(o-e)+e;break}return n}function k(r,t){return y.normalize(y.subtract(r,t))}class y{static zeros_Xx2x2(t){for(var s=[];t--;)s.push([0,0]);return s}static mulItems(t,s){return t.map(l=>l*s)}static mulMatrix(t,s){return t.reduce((l,_,b)=>l+_*s[b],0)}static subtract(t,s){return t.map((l,_)=>l-s[_])}static addArrays(t,s){return t.map((l,_)=>l+s[_])}static addItems(t,s){return t.map(l=>l+s)}static sum(t){return t.reduce((s,l)=>s+l)}static dot(t,s){return y.mulMatrix(t,s)}static vectorLen(t){return Math.hypot(...t)}static divItems(t,s){return t.map(l=>l/s)}static squareItems(t){return t.map(s=>s*s)}static normalize(t){return this.divItems(t,this.vectorLen(t))}}class v{static q(t,s){var l=1-s,_=y.mulItems(t[0],l*l*l),b=y.mulItems(t[1],3*l*l*s),o=y.mulItems(t[2],3*l*s*s),e=y.mulItems(t[3],s*s*s);return y.addArrays(y.addArrays(_,b),y.addArrays(o,e))}static qprime(t,s){var l=1-s,_=y.mulItems(y.subtract(t[1],t[0]),3*l*l),b=y.mulItems(y.subtract(t[2],t[1]),6*l*s),o=y.mulItems(y.subtract(t[3],t[2]),3*s*s);return y.addArrays(y.addArrays(_,b),o)}static qprimeprime(t,s){return y.addArrays(y.mulItems(y.addArrays(y.subtract(t[2],y.mulItems(t[1],2)),t[0]),6*(1-s)),y.mulItems(y.addArrays(y.subtract(t[3],y.mulItems(t[2],2)),t[1]),6*s))}}X.exports=a,X.exports.fitCubic=R,X.exports.createTangent=k},(X,a,R)=>{var h,Ce,w,Te,I,we;Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationLayer=void 0;var u=R(1),p=R(8),B=R(5),D=R(28),J=R(29);const L=1e3,f=9,E=new WeakSet;function k(z){return{width:z[2]-z[0],height:z[3]-z[1]}}class y{static create(i){switch(i.data.annotationType){case u.AnnotationType.LINK:return new r(i);case u.AnnotationType.TEXT:return new t(i);case u.AnnotationType.WIDGET:switch(i.data.fieldType){case"Tx":return new l(i);case"Btn":return i.data.radioButton?new b(i):i.data.checkBox?new _(i):new o(i);case"Ch":return new e(i)}return new s(i);case u.AnnotationType.POPUP:return new n(i);case u.AnnotationType.FREETEXT:return new T(i);case u.AnnotationType.LINE:return new S(i);case u.AnnotationType.SQUARE:return new m(i);case u.AnnotationType.CIRCLE:return new x(i);case u.AnnotationType.POLYLINE:return new Q(i);case u.AnnotationType.CARET:return new Z(i);case u.AnnotationType.INK:return new Y(i);case u.AnnotationType.POLYGON:return new it(i);case u.AnnotationType.HIGHLIGHT:return new W(i);case u.AnnotationType.UNDERLINE:return new G(i);case u.AnnotationType.SQUIGGLY:return new V(i);case u.AnnotationType.STRIKEOUT:return new nt(i);case u.AnnotationType.STAMP:return new ct(i);case u.AnnotationType.FILEATTACHMENT:return new bt(i);default:return new v(i)}}}class v{constructor(i,{isRenderable:g=!1,ignoreBorder:A=!1,createQuadrilaterals:C=!1}={}){this.isRenderable=g,this.data=i.data,this.layer=i.layer,this.page=i.page,this.viewport=i.viewport,this.linkService=i.linkService,this.downloadManager=i.downloadManager,this.imageResourcesPath=i.imageResourcesPath,this.renderForms=i.renderForms,this.svgFactory=i.svgFactory,this.annotationStorage=i.annotationStorage,this.enableScripting=i.enableScripting,this.hasJSActions=i.hasJSActions,this._fieldObjects=i.fieldObjects,this._mouseState=i.mouseState,g&&(this.container=this._createContainer(A)),C&&(this.quadrilaterals=this._createQuadrilaterals(A))}_createContainer(i=!1){const g=this.data,A=this.page,C=this.viewport,F=document.createElement("section"),{width:U,height:st}=k(g.rect),[dt,tt,ot,et]=C.viewBox,lt=ot-dt,ft=et-tt;F.setAttribute("data-annotation-id",g.id);const M=u.Util.normalizeRect([g.rect[0],A.view[3]-g.rect[1]+A.view[1],g.rect[2],A.view[3]-g.rect[3]+A.view[1]]);if(!i&&g.borderStyle.width>0){F.style.borderWidth=`${g.borderStyle.width}px`;const At=g.borderStyle.horizontalCornerRadius,vt=g.borderStyle.verticalCornerRadius;if(At>0||vt>0){const Tt=`calc(${At}px * var(--scale-factor)) / calc(${vt}px * var(--scale-factor))`;F.style.borderRadius=Tt}else if(this instanceof b){const Tt=`calc(${U}px * var(--scale-factor)) / calc(${st}px * var(--scale-factor))`;F.style.borderRadius=Tt}switch(g.borderStyle.style){case u.AnnotationBorderStyleType.SOLID:F.style.borderStyle="solid";break;case u.AnnotationBorderStyleType.DASHED:F.style.borderStyle="dashed";break;case u.AnnotationBorderStyleType.BEVELED:(0,u.warn)("Unimplemented border style: beveled");break;case u.AnnotationBorderStyleType.INSET:(0,u.warn)("Unimplemented border style: inset");break;case u.AnnotationBorderStyleType.UNDERLINE:F.style.borderBottomStyle="solid";break}const Et=g.borderColor||null;Et?F.style.borderColor=u.Util.makeHexColor(Et[0]|0,Et[1]|0,Et[2]|0):F.style.borderWidth=0}F.style.left=`${100*(M[0]-dt)/lt}%`,F.style.top=`${100*(M[1]-tt)/ft}%`;const{rotation:ut}=g;return g.hasOwnCanvas||ut===0?(F.style.width=`${100*U/lt}%`,F.style.height=`${100*st/ft}%`):this.setRotation(ut,F),F}setRotation(i,g=this.container){const[A,C,F,U]=this.viewport.viewBox,st=F-A,dt=U-C,{width:tt,height:ot}=k(this.data.rect);let et,lt;i%180===0?(et=100*tt/st,lt=100*ot/dt):(et=100*ot/st,lt=100*tt/dt),g.style.width=`${et}%`,g.style.height=`${lt}%`,g.setAttribute("data-main-rotation",(360-i)%360)}get _commonActions(){const i=(g,A,C)=>{const F=C.detail[g];C.target.style[A]=D.ColorConverters[`${F[0]}_HTML`](F.slice(1))};return(0,u.shadow)(this,"_commonActions",{display:g=>{const A=g.detail.display%2===1;this.container.style.visibility=A?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:A,print:g.detail.display===0||g.detail.display===3})},print:g=>{this.annotationStorage.setValue(this.data.id,{print:g.detail.print})},hidden:g=>{this.container.style.visibility=g.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:g.detail.hidden})},focus:g=>{setTimeout(()=>g.target.focus({preventScroll:!1}),0)},userName:g=>{g.target.title=g.detail.userName},readonly:g=>{g.detail.readonly?g.target.setAttribute("readonly",""):g.target.removeAttribute("readonly")},required:g=>{this._setRequired(g.target,g.detail.required)},bgColor:g=>{i("bgColor","backgroundColor",g)},fillColor:g=>{i("fillColor","backgroundColor",g)},fgColor:g=>{i("fgColor","color",g)},textColor:g=>{i("textColor","color",g)},borderColor:g=>{i("borderColor","borderColor",g)},strokeColor:g=>{i("strokeColor","borderColor",g)},rotation:g=>{const A=g.detail.rotation;this.setRotation(A),this.annotationStorage.setValue(this.data.id,{rotation:A})}})}_dispatchEventFromSandbox(i,g){const A=this._commonActions;for(const C of Object.keys(g.detail)){const F=i[C]||A[C];F&&F(g)}}_setDefaultPropertiesFromJS(i){if(!this.enableScripting)return;const g=this.annotationStorage.getRawValue(this.data.id);if(!g)return;const A=this._commonActions;for(const[C,F]of Object.entries(g)){const U=A[C];if(U){const st={detail:{[C]:F},target:i};U(st),delete g[C]}}}_createQuadrilaterals(i=!1){if(!this.data.quadPoints)return null;const g=[],A=this.data.rect;for(const C of this.data.quadPoints)this.data.rect=[C[2].x,C[2].y,C[1].x,C[1].y],g.push(this._createContainer(i));return this.data.rect=A,g}_createPopup(i,g){let A=this.container;this.quadrilaterals&&(i=i||this.quadrilaterals,A=this.quadrilaterals[0]),i||(i=document.createElement("div"),i.className="popupTriggerArea",A.append(i));const F=new d({container:A,trigger:i,color:g.color,titleObj:g.titleObj,modificationDate:g.modificationDate,contentsObj:g.contentsObj,richText:g.richText,hideWrapper:!0}).render();F.style.left="100%",A.append(F)}_renderQuadrilaterals(i){for(const g of this.quadrilaterals)g.className=i;return this.quadrilaterals}render(){(0,u.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(i,g=null){const A=[];if(this._fieldObjects){const C=this._fieldObjects[i];if(C)for(const{page:F,id:U,exportValues:st}of C){if(F===-1||U===g)continue;const dt=typeof st=="string"?st:null,tt=document.querySelector(`[data-element-id="${U}"]`);if(tt&&!E.has(tt)){(0,u.warn)(`_getElementsByName - element not allowed: ${U}`);continue}A.push({id:U,exportValue:dt,domElement:tt})}return A}for(const C of document.getElementsByName(i)){const{id:F,exportValue:U}=C;F!==g&&(!E.has(C)||A.push({id:F,exportValue:U,domElement:C}))}return A}static get platform(){const i=typeof navigator!="undefined"?navigator.platform:"";return(0,u.shadow)(this,"platform",{isWin:i.includes("Win"),isMac:i.includes("Mac")})}}class r extends v{constructor(i,g=null){super(i,{isRenderable:!0,ignoreBorder:!!(g!=null&&g.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=i.data.isTooltipOnly}render(){const{data:i,linkService:g}=this,A=document.createElement("a");A.setAttribute("data-element-id",i.id);let C=!1;return i.url?(g.addLinkAttributes(A,i.url,i.newWindow),C=!0):i.action?(this._bindNamedAction(A,i.action),C=!0):i.dest?(this._bindLink(A,i.dest),C=!0):(i.actions&&(i.actions.Action||i.actions["Mouse Up"]||i.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(A,i),C=!0),i.resetForm?(this._bindResetFormAction(A,i.resetForm),C=!0):this.isTooltipOnly&&!C&&(this._bindLink(A,""),C=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((F,U)=>{const st=U===0?A:A.cloneNode();return F.append(st),F}):(this.container.className="linkAnnotation",C&&this.container.append(A),this.container)}_bindLink(i,g){i.href=this.linkService.getDestinationHash(g),i.onclick=()=>(g&&this.linkService.goToDestination(g),!1),(g||g==="")&&(i.className="internalLink")}_bindNamedAction(i,g){i.href=this.linkService.getAnchorUrl(""),i.onclick=()=>(this.linkService.executeNamedAction(g),!1),i.className="internalLink"}_bindJSAction(i,g){i.href=this.linkService.getAnchorUrl("");const A=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const C of Object.keys(g.actions)){const F=A.get(C);!F||(i[F]=()=>{var U;return(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g.id,name:C}}),!1})}i.onclick||(i.onclick=()=>!1),i.className="internalLink"}_bindResetFormAction(i,g){const A=i.onclick;if(A||(i.href=this.linkService.getAnchorUrl("")),i.className="internalLink",!this._fieldObjects){(0,u.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),A||(i.onclick=()=>!1);return}i.onclick=()=>{var ot;A&&A();const{fields:C,refs:F,include:U}=g,st=[];if(C.length!==0||F.length!==0){const et=new Set(F);for(const lt of C){const ft=this._fieldObjects[lt]||[];for(const{id:M}of ft)et.add(M)}for(const lt of Object.values(this._fieldObjects))for(const ft of lt)et.has(ft.id)===U&&st.push(ft)}else for(const et of Object.values(this._fieldObjects))st.push(...et);const dt=this.annotationStorage,tt=[];for(const et of st){const{id:lt}=et;switch(tt.push(lt),et.type){case"text":{const M=et.defaultValue||"";dt.setValue(lt,{value:M});break}case"checkbox":case"radiobutton":{const M=et.defaultValue===et.exportValues;dt.setValue(lt,{value:M});break}case"combobox":case"listbox":{const M=et.defaultValue||"";dt.setValue(lt,{value:M});break}default:continue}const ft=document.querySelector(`[data-element-id="${lt}"]`);if(ft){if(!E.has(ft)){(0,u.warn)(`_bindResetFormAction - element not allowed: ${lt}`);continue}}else continue;ft.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((ot=this.linkService.eventBus)==null||ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:tt,name:"ResetForm"}})),!1}}}class t extends v{constructor(i){var A,C,F;const g=!!(i.data.hasPopup||((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g})}render(){this.container.className="textAnnotation";const i=document.createElement("img");return i.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",i.alt="[{{type}} Annotation]",i.dataset.l10nId="text_annotation_type",i.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(i,this.data),this.container.append(i),this.container}}class s extends v{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(i){const{isWin:g,isMac:A}=v.platform;return g&&i.ctrlKey||A&&i.metaKey}_setEventListener(i,g,A,C){g.includes("mouse")?i.addEventListener(g,F=>{var U;(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:A,value:C(F),shift:F.shiftKey,modifier:this._getKeyModifier(F)}})}):i.addEventListener(g,F=>{var U;(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:A,value:C(F)}})})}_setEventListeners(i,g,A){var C;for(const[F,U]of g)(U==="Action"||((C=this.data.actions)==null?void 0:C[U]))&&this._setEventListener(i,F,U,A)}_setBackgroundColor(i){const g=this.data.backgroundColor||null;i.style.backgroundColor=g===null?"transparent":u.Util.makeHexColor(g[0],g[1],g[2])}_setTextStyle(i){const g=["left","center","right"],{fontColor:A}=this.data.defaultAppearanceData,C=this.data.defaultAppearanceData.fontSize||f,F=i.style;let U;if(this.data.multiLine){const st=Math.abs(this.data.rect[3]-this.data.rect[1]),dt=Math.round(st/(u.LINE_FACTOR*C))||1,tt=st/dt;U=Math.min(C,Math.round(tt/u.LINE_FACTOR))}else{const st=Math.abs(this.data.rect[3]-this.data.rect[1]);U=Math.min(C,Math.round(st/u.LINE_FACTOR))}F.fontSize=`calc(${U}px * var(--scale-factor))`,F.color=u.Util.makeHexColor(A[0],A[1],A[2]),this.data.textAlignment!==null&&(F.textAlign=g[this.data.textAlignment])}_setRequired(i,g){g?i.setAttribute("required",!0):i.removeAttribute("required"),i.setAttribute("aria-required",g)}}class l extends s{constructor(i){const g=i.renderForms||!i.data.hasAppearance&&!!i.data.fieldValue;super(i,{isRenderable:g})}setPropertyOnSiblings(i,g,A,C){const F=this.annotationStorage;for(const U of this._getElementsByName(i.name,i.id))U.domElement&&(U.domElement[g]=A),F.setValue(U.id,{[C]:A})}render(){var C;const i=this.annotationStorage,g=this.data.id;this.container.className="textWidgetAnnotation";let A=null;if(this.renderForms){const F=i.getValue(g,{value:this.data.fieldValue});let U=F.formattedValue||F.value||"";const st=i.getValue(g,{charLimit:this.data.maxLen}).charLimit;st&&U.length>st&&(U=U.slice(0,st));const dt={userValue:U,formattedValue:null,valueOnFocus:""};this.data.multiLine?(A=document.createElement("textarea"),A.textContent=U,this.data.doNotScroll&&(A.style.overflowY="hidden")):(A=document.createElement("input"),A.type="text",A.setAttribute("value",U),this.data.doNotScroll&&(A.style.overflowX="hidden")),E.add(A),A.setAttribute("data-element-id",g),A.disabled=this.data.readOnly,A.name=this.data.fieldName,A.tabIndex=L,this._setRequired(A,this.data.required),st&&(A.maxLength=st),A.addEventListener("input",ot=>{i.setValue(g,{value:ot.target.value}),this.setPropertyOnSiblings(A,"value",ot.target.value,"value")}),A.addEventListener("resetform",ot=>{var lt;const et=(lt=this.data.defaultFieldValue)!=null?lt:"";A.value=dt.userValue=et,dt.formattedValue=null});let tt=ot=>{const{formattedValue:et}=dt;et!=null&&(ot.target.value=et),ot.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){A.addEventListener("focus",et=>{dt.userValue&&(et.target.value=dt.userValue),dt.valueOnFocus=et.target.value}),A.addEventListener("updatefromsandbox",et=>{const lt={value(ft){var M;dt.userValue=(M=ft.detail.value)!=null?M:"",i.setValue(g,{value:dt.userValue.toString()}),ft.target.value=dt.userValue},formattedValue(ft){const{formattedValue:M}=ft.detail;dt.formattedValue=M,M!=null&&ft.target!==document.activeElement&&(ft.target.value=M),i.setValue(g,{formattedValue:M})},selRange(ft){ft.target.setSelectionRange(...ft.detail.selRange)},charLimit:ft=>{var vt;const{charLimit:M}=ft.detail,{target:ut}=ft;if(M===0){ut.removeAttribute("maxLength");return}ut.setAttribute("maxLength",M);let At=dt.userValue;!At||At.length<=M||(At=At.slice(0,M),ut.value=dt.userValue=At,i.setValue(g,{value:At}),(vt=this.linkService.eventBus)==null||vt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:At,willCommit:!0,commitKey:1,selStart:ut.selectionStart,selEnd:ut.selectionEnd}}))}};this._dispatchEventFromSandbox(lt,et)}),A.addEventListener("keydown",et=>{var M;let lt=-1;if(et.key==="Escape"?lt=0:et.key==="Enter"?lt=2:et.key==="Tab"&&(lt=3),lt===-1)return;const{value:ft}=et.target;dt.valueOnFocus!==ft&&(dt.userValue=ft,(M=this.linkService.eventBus)==null||M.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:ft,willCommit:!0,commitKey:lt,selStart:et.target.selectionStart,selEnd:et.target.selectionEnd}}))});const ot=tt;tt=null,A.addEventListener("blur",et=>{var ft;const{value:lt}=et.target;dt.userValue=lt,this._mouseState.isDown&&dt.valueOnFocus!==lt&&((ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:lt,willCommit:!0,commitKey:1,selStart:et.target.selectionStart,selEnd:et.target.selectionEnd}})),ot(et)}),(C=this.data.actions)!=null&&C.Keystroke&&A.addEventListener("beforeinput",et=>{var Tt;const{data:lt,target:ft}=et,{value:M,selectionStart:ut,selectionEnd:At}=ft;let vt=ut,Et=At;switch(et.inputType){case"deleteWordBackward":{const Rt=M.substring(0,ut).match(/\w*[^\w]*$/);Rt&&(vt-=Rt[0].length);break}case"deleteWordForward":{const Rt=M.substring(ut).match(/^[^\w]*\w*/);Rt&&(Et+=Rt[0].length);break}case"deleteContentBackward":ut===At&&(vt-=1);break;case"deleteContentForward":ut===At&&(Et+=1);break}et.preventDefault(),(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:M,change:lt||"",willCommit:!1,selStart:vt,selEnd:Et}})}),this._setEventListeners(A,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],et=>et.target.value)}if(tt&&A.addEventListener("blur",tt),this.data.comb){const et=(this.data.rect[2]-this.data.rect[0])/st;A.classList.add("comb"),A.style.letterSpacing=`calc(${et}px * var(--scale-factor) - 1ch)`}}else A=document.createElement("div"),A.textContent=this.data.fieldValue,A.style.verticalAlign="middle",A.style.display="table-cell";return this._setTextStyle(A),this._setBackgroundColor(A),this._setDefaultPropertiesFromJS(A),this.container.append(A),this.container}}class _ extends s{constructor(i){super(i,{isRenderable:i.renderForms})}render(){const i=this.annotationStorage,g=this.data,A=g.id;let C=i.getValue(A,{value:g.exportValue===g.fieldValue}).value;typeof C=="string"&&(C=C!=="Off",i.setValue(A,{value:C})),this.container.className="buttonWidgetAnnotation checkBox";const F=document.createElement("input");return E.add(F),F.setAttribute("data-element-id",A),F.disabled=g.readOnly,this._setRequired(F,this.data.required),F.type="checkbox",F.name=g.fieldName,C&&F.setAttribute("checked",!0),F.setAttribute("exportValue",g.exportValue),F.tabIndex=L,F.addEventListener("change",U=>{const{name:st,checked:dt}=U.target;for(const tt of this._getElementsByName(st,A)){const ot=dt&&tt.exportValue===g.exportValue;tt.domElement&&(tt.domElement.checked=ot),i.setValue(tt.id,{value:ot})}i.setValue(A,{value:dt})}),F.addEventListener("resetform",U=>{const st=g.defaultFieldValue||"Off";U.target.checked=st===g.exportValue}),this.enableScripting&&this.hasJSActions&&(F.addEventListener("updatefromsandbox",U=>{const st={value(dt){dt.target.checked=dt.detail.value!=="Off",i.setValue(A,{value:dt.target.checked})}};this._dispatchEventFromSandbox(st,U)}),this._setEventListeners(F,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],U=>U.target.checked)),this._setBackgroundColor(F),this._setDefaultPropertiesFromJS(F),this.container.append(F),this.container}}class b extends s{constructor(i){super(i,{isRenderable:i.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const i=this.annotationStorage,g=this.data,A=g.id;let C=i.getValue(A,{value:g.fieldValue===g.buttonValue}).value;typeof C=="string"&&(C=C!==g.buttonValue,i.setValue(A,{value:C}));const F=document.createElement("input");if(E.add(F),F.setAttribute("data-element-id",A),F.disabled=g.readOnly,this._setRequired(F,this.data.required),F.type="radio",F.name=g.fieldName,C&&F.setAttribute("checked",!0),F.tabIndex=L,F.addEventListener("change",U=>{const{name:st,checked:dt}=U.target;for(const tt of this._getElementsByName(st,A))i.setValue(tt.id,{value:!1});i.setValue(A,{value:dt})}),F.addEventListener("resetform",U=>{const st=g.defaultFieldValue;U.target.checked=st!=null&&st===g.buttonValue}),this.enableScripting&&this.hasJSActions){const U=g.buttonValue;F.addEventListener("updatefromsandbox",st=>{const dt={value:tt=>{const ot=U===tt.detail.value;for(const et of this._getElementsByName(tt.target.name)){const lt=ot&&et.id===A;et.domElement&&(et.domElement.checked=lt),i.setValue(et.id,{value:lt})}}};this._dispatchEventFromSandbox(dt,st)}),this._setEventListeners(F,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],st=>st.target.checked)}return this._setBackgroundColor(F),this._setDefaultPropertiesFromJS(F),this.container.append(F),this.container}}class o extends r{constructor(i){super(i,{ignoreBorder:i.data.hasAppearance})}render(){const i=super.render();i.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(i.title=this.data.alternativeText);const g=i.lastChild;return this.enableScripting&&this.hasJSActions&&g&&(this._setDefaultPropertiesFromJS(g),g.addEventListener("updatefromsandbox",A=>{this._dispatchEventFromSandbox({},A)})),i}}class e extends s{constructor(i){super(i,{isRenderable:i.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const i=this.annotationStorage,g=this.data.id,A=i.getValue(g,{value:this.data.fieldValue}),C=document.createElement("select");E.add(C),C.setAttribute("data-element-id",g),C.disabled=this.data.readOnly,this._setRequired(C,this.data.required),C.name=this.data.fieldName,C.tabIndex=L;let F=this.data.combo&&this.data.options.length>0;this.data.combo||(C.size=this.data.options.length,this.data.multiSelect&&(C.multiple=!0)),C.addEventListener("resetform",tt=>{const ot=this.data.defaultFieldValue;for(const et of C.options)et.selected=et.value===ot});for(const tt of this.data.options){const ot=document.createElement("option");ot.textContent=tt.displayValue,ot.value=tt.exportValue,A.value.includes(tt.exportValue)&&(ot.setAttribute("selected",!0),F=!1),C.append(ot)}let U=null;if(F){const tt=document.createElement("option");tt.value=" ",tt.setAttribute("hidden",!0),tt.setAttribute("selected",!0),C.prepend(tt),U=()=>{tt.remove(),C.removeEventListener("input",U),U=null},C.addEventListener("input",U)}const st=(tt,ot)=>{const et=ot?"value":"textContent",lt=tt.target.options;return tt.target.multiple?Array.prototype.filter.call(lt,ft=>ft.selected).map(ft=>ft[et]):lt.selectedIndex===-1?null:lt[lt.selectedIndex][et]},dt=tt=>{const ot=tt.target.options;return Array.prototype.map.call(ot,et=>({displayValue:et.textContent,exportValue:et.value}))};return this.enableScripting&&this.hasJSActions?(C.addEventListener("updatefromsandbox",tt=>{const ot={value(et){U==null||U();const lt=et.detail.value,ft=new Set(Array.isArray(lt)?lt:[lt]);for(const M of C.options)M.selected=ft.has(M.value);i.setValue(g,{value:st(et,!0)})},multipleSelection(et){C.multiple=!0},remove(et){const lt=C.options,ft=et.detail.remove;lt[ft].selected=!1,C.remove(ft),lt.length>0&&Array.prototype.findIndex.call(lt,ut=>ut.selected)===-1&&(lt[0].selected=!0),i.setValue(g,{value:st(et,!0),items:dt(et)})},clear(et){for(;C.length!==0;)C.remove(0);i.setValue(g,{value:null,items:[]})},insert(et){const{index:lt,displayValue:ft,exportValue:M}=et.detail.insert,ut=C.children[lt],At=document.createElement("option");At.textContent=ft,At.value=M,ut?ut.before(At):C.append(At),i.setValue(g,{value:st(et,!0),items:dt(et)})},items(et){const{items:lt}=et.detail;for(;C.length!==0;)C.remove(0);for(const ft of lt){const{displayValue:M,exportValue:ut}=ft,At=document.createElement("option");At.textContent=M,At.value=ut,C.append(At)}C.options.length>0&&(C.options[0].selected=!0),i.setValue(g,{value:st(et,!0),items:dt(et)})},indices(et){const lt=new Set(et.detail.indices);for(const ft of et.target.options)ft.selected=lt.has(ft.index);i.setValue(g,{value:st(et,!0)})},editable(et){et.target.disabled=!et.detail.editable}};this._dispatchEventFromSandbox(ot,tt)}),C.addEventListener("input",tt=>{var lt;const ot=st(tt,!0),et=st(tt,!1);i.setValue(g,{value:ot}),(lt=this.linkService.eventBus)==null||lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g,name:"Keystroke",value:et,changeEx:ot,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(C,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],tt=>tt.target.checked)):C.addEventListener("input",function(tt){i.setValue(g,{value:st(tt,!0)})}),this.data.combo&&this._setTextStyle(C),this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}}class n extends v{constructor(i){var A,C,F;const g=!!(((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g})}render(){const i=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",i.includes(this.data.parentType))return this.container;const g=`[data-annotation-id="${this.data.parentId}"]`,A=this.layer.querySelectorAll(g);if(A.length===0)return this.container;const C=new d({container:this.container,trigger:Array.from(A),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),F=this.page,U=u.Util.normalizeRect([this.data.parentRect[0],F.view[3]-this.data.parentRect[1]+F.view[1],this.data.parentRect[2],F.view[3]-this.data.parentRect[3]+F.view[1]]),st=U[0]+this.data.parentRect[2]-this.data.parentRect[0],dt=U[1],[tt,ot,et,lt]=this.viewport.viewBox,ft=et-tt,M=lt-ot;return this.container.style.left=`${100*(st-tt)/ft}%`,this.container.style.top=`${100*(dt-ot)/M}%`,this.container.append(C.render()),this.container}}class d{constructor(i){this.container=i.container,this.trigger=i.trigger,this.color=i.color,this.titleObj=i.titleObj,this.modificationDate=i.modificationDate,this.contentsObj=i.contentsObj,this.richText=i.richText,this.hideWrapper=i.hideWrapper||!1,this.pinned=!1}render(){var st,dt;const g=document.createElement("div");g.className="popupWrapper",this.hideElement=this.hideWrapper?g:this.container,this.hideElement.hidden=!0;const A=document.createElement("div");A.className="popup";const C=this.color;if(C){const tt=.7*(255-C[0])+C[0],ot=.7*(255-C[1])+C[1],et=.7*(255-C[2])+C[2];A.style.backgroundColor=u.Util.makeHexColor(tt|0,ot|0,et|0)}const F=document.createElement("h1");F.dir=this.titleObj.dir,F.textContent=this.titleObj.str,A.append(F);const U=p.PDFDateString.toDateObject(this.modificationDate);if(U){const tt=document.createElement("span");tt.className="popupDate",tt.textContent="{{date}}, {{time}}",tt.dataset.l10nId="annotation_date_string",tt.dataset.l10nArgs=JSON.stringify({date:U.toLocaleDateString(),time:U.toLocaleTimeString()}),A.append(tt)}if(((st=this.richText)==null?void 0:st.str)&&(!((dt=this.contentsObj)!=null&&dt.str)||this.contentsObj.str===this.richText.str))J.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:A}),A.lastChild.className="richText popupContent";else{const tt=this._formatContents(this.contentsObj);A.append(tt)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const tt of this.trigger)tt.addEventListener("click",this._toggle.bind(this)),tt.addEventListener("mouseover",this._show.bind(this,!1)),tt.addEventListener("mouseout",this._hide.bind(this,!1));return A.addEventListener("click",this._hide.bind(this,!0)),g.append(A),g}_formatContents({str:i,dir:g}){const A=document.createElement("p");A.className="popupContent",A.dir=g;const C=i.split(/(?:\r\n?|\n)/);for(let F=0,U=C.length;F<U;++F){const st=C[F];A.append(document.createTextNode(st)),F<U-1&&A.append(document.createElement("br"))}return A}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(i=!1){i&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(i=!0){i&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class T extends v{constructor(i){var A,C,F;const g=!!(i.data.hasPopup||((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g,ignoreBorder:!0}),this.textContent=i.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const i=document.createElement("div");i.className="annotationTextContent",i.setAttribute("role","comment");for(const g of this.textContent){const A=document.createElement("span");A.textContent=g,i.append(A)}this.container.append(i)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class S extends v{constructor(i){var A,C,F;const g=!!(i.data.hasPopup||((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const i=this.data,{width:g,height:A}=k(i.rect),C=this.svgFactory.create(g,A,!0),F=this.svgFactory.createElement("svg:line");return F.setAttribute("x1",i.rect[2]-i.lineCoordinates[0]),F.setAttribute("y1",i.rect[3]-i.lineCoordinates[1]),F.setAttribute("x2",i.rect[2]-i.lineCoordinates[2]),F.setAttribute("y2",i.rect[3]-i.lineCoordinates[3]),F.setAttribute("stroke-width",i.borderStyle.width||1),F.setAttribute("stroke","transparent"),F.setAttribute("fill","transparent"),C.append(F),this.container.append(C),this._createPopup(F,i),this.container}}class m extends v{constructor(i){var A,C,F;const g=!!(i.data.hasPopup||((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const i=this.data,{width:g,height:A}=k(i.rect),C=this.svgFactory.create(g,A,!0),F=i.borderStyle.width,U=this.svgFactory.createElement("svg:rect");return U.setAttribute("x",F/2),U.setAttribute("y",F/2),U.setAttribute("width",g-F),U.setAttribute("height",A-F),U.setAttribute("stroke-width",F||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),C.append(U),this.container.append(C),this._createPopup(U,i),this.container}}class x extends v{constructor(i){var A,C,F;const g=!!(i.data.hasPopup||((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const i=this.data,{width:g,height:A}=k(i.rect),C=this.svgFactory.create(g,A,!0),F=i.borderStyle.width,U=this.svgFactory.createElement("svg:ellipse");return U.setAttribute("cx",g/2),U.setAttribute("cy",A/2),U.setAttribute("rx",g/2-F/2),U.setAttribute("ry",A/2-F/2),U.setAttribute("stroke-width",F||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),C.append(U),this.container.append(C),this._createPopup(U,i),this.container}}class Q extends v{constructor(i){var A,C,F;const g=!!(i.data.hasPopup||((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const i=this.data,{width:g,height:A}=k(i.rect),C=this.svgFactory.create(g,A,!0);let F=[];for(const st of i.vertices){const dt=st.x-i.rect[0],tt=i.rect[3]-st.y;F.push(dt+","+tt)}F=F.join(" ");const U=this.svgFactory.createElement(this.svgElementName);return U.setAttribute("points",F),U.setAttribute("stroke-width",i.borderStyle.width||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),C.append(U),this.container.append(C),this._createPopup(U,i),this.container}}class it extends Q{constructor(i){super(i),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Z extends v{constructor(i){var A,C,F;const g=!!(i.data.hasPopup||((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class Y extends v{constructor(i){var A,C,F;const g=!!(i.data.hasPopup||((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const i=this.data,{width:g,height:A}=k(i.rect),C=this.svgFactory.create(g,A,!0);for(const F of i.inkLists){let U=[];for(const dt of F){const tt=dt.x-i.rect[0],ot=i.rect[3]-dt.y;U.push(`${tt},${ot}`)}U=U.join(" ");const st=this.svgFactory.createElement(this.svgElementName);st.setAttribute("points",U),st.setAttribute("stroke-width",i.borderStyle.width||1),st.setAttribute("stroke","transparent"),st.setAttribute("fill","transparent"),this._createPopup(st,i),C.append(st)}return this.container.append(C),this.container}}class W extends v{constructor(i){var A,C,F;const g=!!(i.data.hasPopup||((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class G extends v{constructor(i){var A,C,F;const g=!!(i.data.hasPopup||((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class V extends v{constructor(i){var A,C,F;const g=!!(i.data.hasPopup||((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class nt extends v{constructor(i){var A,C,F;const g=!!(i.data.hasPopup||((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class ct extends v{constructor(i){var A,C,F;const g=!!(i.data.hasPopup||((A=i.data.titleObj)==null?void 0:A.str)||((C=i.data.contentsObj)==null?void 0:C.str)||((F=i.data.richText)==null?void 0:F.str));super(i,{isRenderable:g,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class bt extends v{constructor(i){var C;super(i,{isRenderable:!0});const{filename:g,content:A}=this.data.file;this.filename=(0,p.getFilenameFromUrl)(g),this.content=A,(C=this.linkService.eventBus)==null||C.dispatch("fileattachmentannotation",{source:this,filename:g,content:A})}render(){var g,A;this.container.className="fileAttachmentAnnotation";const i=document.createElement("div");return i.className="popupTriggerArea",i.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(((g=this.data.titleObj)==null?void 0:g.str)||((A=this.data.contentsObj)==null?void 0:A.str)||this.data.richText)&&this._createPopup(i,this.data),this.container.append(i),this.container}_download(){var i;(i=this.downloadManager)==null||i.openOrDownloadData(this.container,this.content,this.filename)}}const $=class{static render(i){var st,dt;const{annotations:g,div:A,viewport:C,accessibilityManager:F}=i;ht(this,w,Te).call(this,A,C);let U=0;for(const tt of g){if(tt.annotationType!==u.AnnotationType.POPUP){const{width:et,height:lt}=k(tt.rect);if(et<=0||lt<=0)continue}const ot=y.create({data:tt,layer:A,page:i.page,viewport:C,linkService:i.linkService,downloadManager:i.downloadManager,imageResourcesPath:i.imageResourcesPath||"",renderForms:i.renderForms!==!1,svgFactory:new p.DOMSVGFactory,annotationStorage:i.annotationStorage||new B.AnnotationStorage,enableScripting:i.enableScripting,hasJSActions:i.hasJSActions,fieldObjects:i.fieldObjects,mouseState:i.mouseState||{isDown:!1}});if(ot.isRenderable){const et=ot.render();if(tt.hidden&&(et.style.visibility="hidden"),Array.isArray(et))for(const lt of et)lt.style.zIndex=U++,ht(st=$,h,Ce).call(st,lt,tt.id,A,F);else et.style.zIndex=U++,ot instanceof n?A.prepend(et):ht(dt=$,h,Ce).call(dt,et,tt.id,A,F)}}ht(this,I,we).call(this,A,i.annotationCanvasMap)}static update(i){const{annotationCanvasMap:g,div:A,viewport:C}=i;ht(this,w,Te).call(this,A,C),ht(this,I,we).call(this,A,g),A.hidden=!1}};let N=$;h=new WeakSet,Ce=function(i,g,A,C){const F=i.firstChild||i;F.id=`${p.AnnotationPrefix}${g}`,A.append(i),C==null||C.moveElementInDOM(A,i,F,!1)},w=new WeakSet,Te=function(i,{width:g,height:A,rotation:C}){const{style:F}=i,U=C%180!==0,st=Math.floor(g)+"px",dt=Math.floor(A)+"px";F.width=U?dt:st,F.height=U?st:dt,i.setAttribute("data-main-rotation",C)},I=new WeakSet,we=function(i,g){if(!!g){for(const[A,C]of g){const F=i.querySelector(`[data-annotation-id="${A}"]`);if(!F)continue;const{firstChild:U}=F;U?U.nodeName==="CANVAS"?U.replaceWith(C):U.before(C):F.append(C)}g.clear()}},at(N,h),at(N,w),at(N,I),a.AnnotationLayer=N},(X,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ColorConverters=void 0;function R(p){return Math.floor(Math.max(0,Math.min(1,p))*255).toString(16).padStart(2,"0")}class u{static CMYK_G([B,D,J,L]){return["G",1-Math.min(1,.3*B+.59*J+.11*D+L)]}static G_CMYK([B]){return["CMYK",0,0,0,1-B]}static G_RGB([B]){return["RGB",B,B,B]}static G_HTML([B]){const D=R(B);return`#${D}${D}${D}`}static RGB_G([B,D,J]){return["G",.3*B+.59*D+.11*J]}static RGB_HTML([B,D,J]){const L=R(B),f=R(D),E=R(J);return`#${L}${f}${E}`}static T_HTML(){return"#00000000"}static CMYK_RGB([B,D,J,L]){return["RGB",1-Math.min(1,B+L),1-Math.min(1,J+L),1-Math.min(1,D+L)]}static CMYK_HTML(B){const D=this.CMYK_RGB(B).slice(1);return this.RGB_HTML(D)}static RGB_CMYK([B,D,J]){const L=1-B,f=1-D,E=1-J,k=Math.min(L,f,E);return["CMYK",L,f,E,k]}}a.ColorConverters=u},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.XfaLayer=void 0;var u=R(20);class p{static setupStorage(D,J,L,f,E){const k=f.getValue(J,{value:null});switch(L.name){case"textarea":if(k.value!==null&&(D.textContent=k.value),E==="print")break;D.addEventListener("input",y=>{f.setValue(J,{value:y.target.value})});break;case"input":if(L.attributes.type==="radio"||L.attributes.type==="checkbox"){if(k.value===L.attributes.xfaOn?D.setAttribute("checked",!0):k.value===L.attributes.xfaOff&&D.removeAttribute("checked"),E==="print")break;D.addEventListener("change",y=>{f.setValue(J,{value:y.target.checked?y.target.getAttribute("xfaOn"):y.target.getAttribute("xfaOff")})})}else{if(k.value!==null&&D.setAttribute("value",k.value),E==="print")break;D.addEventListener("input",y=>{f.setValue(J,{value:y.target.value})})}break;case"select":if(k.value!==null)for(const y of L.children)y.attributes.value===k.value&&(y.attributes.selected=!0);D.addEventListener("input",y=>{const v=y.target.options,r=v.selectedIndex===-1?"":v[v.selectedIndex].value;f.setValue(J,{value:r})});break}}static setAttributes({html:D,element:J,storage:L=null,intent:f,linkService:E}){const{attributes:k}=J,y=D instanceof HTMLAnchorElement;k.type==="radio"&&(k.name=`${k.name}-${f}`);for(const[v,r]of Object.entries(k))if(r!=null)switch(v){case"class":r.length&&D.setAttribute(v,r.join(" "));break;case"dataId":break;case"id":D.setAttribute("data-element-id",r);break;case"style":Object.assign(D.style,r);break;case"textContent":D.textContent=r;break;default:(!y||v!=="href"&&v!=="newWindow")&&D.setAttribute(v,r)}y&&E.addLinkAttributes(D,k.href,k.newWindow),L&&k.dataId&&this.setupStorage(D,k.dataId,J,L)}static render(D){var t;const J=D.annotationStorage,L=D.linkService,f=D.xfaHtml,E=D.intent||"display",k=document.createElement(f.name);f.attributes&&this.setAttributes({html:k,element:f,intent:E,linkService:L});const y=[[f,-1,k]],v=D.div;if(v.append(k),D.viewport){const s=`matrix(${D.viewport.transform.join(",")})`;v.style.transform=s}E!=="richText"&&v.setAttribute("class","xfaLayer xfaFont");const r=[];for(;y.length>0;){const[s,l,_]=y.at(-1);if(l+1===s.children.length){y.pop();continue}const b=s.children[++y.at(-1)[1]];if(b===null)continue;const{name:o}=b;if(o==="#text"){const n=document.createTextNode(b.value);r.push(n),_.append(n);continue}let e;if((t=b==null?void 0:b.attributes)!=null&&t.xmlns?e=document.createElementNS(b.attributes.xmlns,o):e=document.createElement(o),_.append(e),b.attributes&&this.setAttributes({html:e,element:b,storage:J,intent:E,linkService:L}),b.children&&b.children.length>0)y.push([b,-1,e]);else if(b.value){const n=document.createTextNode(b.value);u.XfaText.shouldBuildText(o)&&r.push(n),e.append(n)}}for(const s of v.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))s.setAttribute("readOnly",!0);return{textDivs:r}}static update(D){const J=`matrix(${D.viewport.transform.join(",")})`;D.div.style.transform=J,D.div.hidden=!1}}a.XfaLayer=p},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TextLayerRenderTask=void 0,a.renderTextLayer=_;var u=R(1),p=R(8);const B=1e5,D=30,J=.8,L=new Map,f=/^\s+$/g;function E(b,o){const e=L.get(b);if(e)return e;o.save(),o.font=`${D}px ${b}`;const n=o.measureText("");let d=n.fontBoundingBoxAscent,T=Math.abs(n.fontBoundingBoxDescent);if(d){o.restore();const m=d/(d+T);return L.set(b,m),m}o.strokeStyle="red",o.clearRect(0,0,D,D),o.strokeText("g",0,0);let S=o.getImageData(0,0,D,D).data;T=0;for(let m=S.length-1-3;m>=0;m-=4)if(S[m]>0){T=Math.ceil(m/4/D);break}o.clearRect(0,0,D,D),o.strokeText("A",0,D),S=o.getImageData(0,0,D,D).data,d=0;for(let m=0,x=S.length;m<x;m+=4)if(S[m]>0){d=D-Math.floor(m/4/D);break}if(o.restore(),d){const m=d/(d+T);return L.set(b,m),m}return L.set(b,J),J}function k(b,o,e,n){const d=document.createElement("span"),T=b._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:o.str!=="",hasEOL:o.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:o.str!=="",hasEOL:o.hasEOL,fontSize:0};b._textDivs.push(d);const S=u.Util.transform(b._viewport.transform,o.transform);let m=Math.atan2(S[1],S[0]);const x=e[o.fontName];x.vertical&&(m+=Math.PI/2);const Q=Math.hypot(S[2],S[3]),it=Q*E(x.fontFamily,n);let Z,Y;m===0?(Z=S[4],Y=S[5]-it):(Z=S[4]+it*Math.sin(m),Y=S[5]-it*Math.cos(m)),d.style.left=`${Z}px`,d.style.top=`${Y}px`,d.style.fontSize=`${Q}px`,d.style.fontFamily=x.fontFamily,T.fontSize=Q,d.setAttribute("role","presentation"),d.textContent=o.str,d.dir=o.dir,b._fontInspectorEnabled&&(d.dataset.fontName=o.fontName),m!==0&&(T.angle=m*(180/Math.PI));let W=!1;if(o.str.length>1||b._enhanceTextSelection&&f.test(o.str))W=!0;else if(o.str!==" "&&o.transform[0]!==o.transform[3]){const G=Math.abs(o.transform[0]),V=Math.abs(o.transform[3]);G!==V&&Math.max(G,V)/Math.min(G,V)>1.5&&(W=!0)}if(W&&(x.vertical?T.canvasWidth=o.height*b._viewport.scale:T.canvasWidth=o.width*b._viewport.scale),b._textDivProperties.set(d,T),b._textContentStream&&b._layoutText(d),b._enhanceTextSelection&&T.hasText){let G=1,V=0;m!==0&&(G=Math.cos(m),V=Math.sin(m));const nt=(x.vertical?o.height:o.width)*b._viewport.scale,ct=Q;let bt,N;m!==0?(bt=[G,V,-V,G,Z,Y],N=u.Util.getAxialAlignedBoundingBox([0,0,nt,ct],bt)):N=[Z,Y,Z+nt,Y+ct],b._bounds.push({left:N[0],top:N[1],right:N[2],bottom:N[3],div:d,size:[nt,ct],m:bt})}}function y(b){if(b._canceled)return;const o=b._textDivs,e=b._capability,n=o.length;if(n>B){b._renderingDone=!0,e.resolve();return}if(!b._textContentStream)for(let d=0;d<n;d++)b._layoutText(o[d]);b._renderingDone=!0,e.resolve()}function v(b,o,e){let n=0;for(let d=0;d<e;d++){const T=b[o++];T>0&&(n=n?Math.min(T,n):T)}return n}function r(b){const o=b._bounds,e=b._viewport,n=t(e.width,e.height,o);for(let d=0;d<n.length;d++){const T=o[d].div,S=b._textDivProperties.get(T);if(S.angle===0){S.paddingLeft=o[d].left-n[d].left,S.paddingTop=o[d].top-n[d].top,S.paddingRight=n[d].right-o[d].right,S.paddingBottom=n[d].bottom-o[d].bottom,b._textDivProperties.set(T,S);continue}const m=n[d],x=o[d],Q=x.m,it=Q[0],Z=Q[1],Y=[[0,0],[0,x.size[1]],[x.size[0],0],x.size],W=new Float64Array(64);for(let V=0,nt=Y.length;V<nt;V++){const ct=u.Util.applyTransform(Y[V],Q);W[V+0]=it&&(m.left-ct[0])/it,W[V+4]=Z&&(m.top-ct[1])/Z,W[V+8]=it&&(m.right-ct[0])/it,W[V+12]=Z&&(m.bottom-ct[1])/Z,W[V+16]=Z&&(m.left-ct[0])/-Z,W[V+20]=it&&(m.top-ct[1])/it,W[V+24]=Z&&(m.right-ct[0])/-Z,W[V+28]=it&&(m.bottom-ct[1])/it,W[V+32]=it&&(m.left-ct[0])/-it,W[V+36]=Z&&(m.top-ct[1])/-Z,W[V+40]=it&&(m.right-ct[0])/-it,W[V+44]=Z&&(m.bottom-ct[1])/-Z,W[V+48]=Z&&(m.left-ct[0])/Z,W[V+52]=it&&(m.top-ct[1])/-it,W[V+56]=Z&&(m.right-ct[0])/Z,W[V+60]=it&&(m.bottom-ct[1])/-it}const G=1+Math.min(Math.abs(it),Math.abs(Z));S.paddingLeft=v(W,32,16)/G,S.paddingTop=v(W,48,16)/G,S.paddingRight=v(W,0,16)/G,S.paddingBottom=v(W,16,16)/G,b._textDivProperties.set(T,S)}}function t(b,o,e){const n=e.map(function(T,S){return{x1:T.left,y1:T.top,x2:T.right,y2:T.bottom,index:S,x1New:void 0,x2New:void 0}});s(b,n);const d=new Array(e.length);for(const T of n){const S=T.index;d[S]={left:T.x1New,top:0,right:T.x2New,bottom:0}}e.map(function(T,S){const m=d[S],x=n[S];x.x1=T.top,x.y1=b-m.right,x.x2=T.bottom,x.y2=b-m.left,x.index=S,x.x1New=void 0,x.x2New=void 0}),s(o,n);for(const T of n){const S=T.index;d[S].top=T.x1New,d[S].bottom=T.x2New}return d}function s(b,o){o.sort(function(d,T){return d.x1-T.x1||d.index-T.index});const n=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const d of o){let T=0;for(;T<n.length&&n[T].end<=d.y1;)T++;let S=n.length-1;for(;S>=0&&n[S].start>=d.y2;)S--;let m,x,Q,it,Z=-1/0;for(Q=T;Q<=S;Q++){m=n[Q],x=m.boundary;let G;x.x2>d.x1?G=x.index>d.index?x.x1New:d.x1:x.x2New===void 0?G=(x.x2+d.x1)/2:G=x.x2New,G>Z&&(Z=G)}for(d.x1New=Z,Q=T;Q<=S;Q++)m=n[Q],x=m.boundary,x.x2New===void 0?x.x2>d.x1?x.index>d.index&&(x.x2New=x.x2):x.x2New=Z:x.x2New>Z&&(x.x2New=Math.max(Z,x.x2));const Y=[];let W=null;for(Q=T;Q<=S;Q++){m=n[Q],x=m.boundary;const G=x.x2>d.x2?x:d;W===G?Y.at(-1).end=m.end:(Y.push({start:m.start,end:m.end,boundary:G}),W=G)}for(n[T].start<d.y1&&(Y[0].start=d.y1,Y.unshift({start:n[T].start,end:d.y1,boundary:n[T].boundary})),d.y2<n[S].end&&(Y.at(-1).end=d.y2,Y.push({start:d.y2,end:n[S].end,boundary:n[S].boundary})),Q=T;Q<=S;Q++){if(m=n[Q],x=m.boundary,x.x2New!==void 0)continue;let G=!1;for(it=T-1;!G&&it>=0&&n[it].start>=x.y1;it--)G=n[it].boundary===x;for(it=S+1;!G&&it<n.length&&n[it].end<=x.y2;it++)G=n[it].boundary===x;for(it=0;!G&&it<Y.length;it++)G=Y[it].boundary===x;G||(x.x2New=Z)}Array.prototype.splice.apply(n,[T,S-T+1,...Y])}for(const d of n){const T=d.boundary;T.x2New===void 0&&(T.x2New=Math.max(b,T.x2))}}class l{constructor({textContent:o,textContentStream:e,container:n,viewport:d,textDivs:T,textContentItemsStr:S,enhanceTextSelection:m}){var x;m&&(0,p.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=o,this._textContentStream=e,this._container=n,this._document=n.ownerDocument,this._viewport=d,this._textDivs=T||[],this._textContentItemsStr=S||[],this._enhanceTextSelection=!!m,this._fontInspectorEnabled=!!((x=globalThis.FontInspector)!=null&&x.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,u.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new u.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(o,e){for(let n=0,d=o.length;n<d;n++){if(o[n].str===void 0){if(o[n].type==="beginMarkedContentProps"||o[n].type==="beginMarkedContent"){const T=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),o[n].id!==null&&this._container.setAttribute("id",`${o[n].id}`),T.append(this._container)}else o[n].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(o[n].str),k(this,o[n],e,this._layoutTextCtx)}}_layoutText(o){const e=this._textDivProperties.get(o);let n="";if(e.canvasWidth!==0&&e.hasText){const{fontFamily:d}=o.style,{fontSize:T}=e;(T!==this._layoutTextLastFontSize||d!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${T*this._devicePixelRatio}px ${d}`,this._layoutTextLastFontSize=T,this._layoutTextLastFontFamily=d);const{width:S}=this._layoutTextCtx.measureText(o.textContent);if(S>0){const m=this._devicePixelRatio*e.canvasWidth/S;this._enhanceTextSelection&&(e.scale=m),n=`scaleX(${m})`}}if(e.angle!==0&&(n=`rotate(${e.angle}deg) ${n}`),n.length>0&&(this._enhanceTextSelection&&(e.originalTransform=n),o.style.transform=n),e.hasText&&this._container.append(o),e.hasEOL){const d=document.createElement("br");d.setAttribute("role","presentation"),this._container.append(d)}}_render(o=0){const e=(0,u.createPromiseCapability)();let n=Object.create(null);const d=this._document.createElement("canvas");if(d.height=d.width=D,this._layoutTextCtx=d.getContext("2d",{alpha:!1}),this._textContent){const T=this._textContent.items,S=this._textContent.styles;this._processItems(T,S),e.resolve()}else if(this._textContentStream){const T=()=>{this._reader.read().then(({value:S,done:m})=>{if(m){e.resolve();return}Object.assign(n,S.styles),this._processItems(S.items,n),T()},e.reject)};this._reader=this._textContentStream.getReader(),T()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');e.promise.then(()=>{n=null,o?this._renderTimer=setTimeout(()=>{y(this),this._renderTimer=null},o):y(this)},this._capability.reject)}expandTextDivs(o=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(r(this),this._bounds=null);const e=[],n=[];for(let d=0,T=this._textDivs.length;d<T;d++){const S=this._textDivs[d],m=this._textDivProperties.get(S);!m.hasText||(o?(e.length=0,n.length=0,m.originalTransform&&e.push(m.originalTransform),m.paddingTop>0?(n.push(`${m.paddingTop}px`),e.push(`translateY(${-m.paddingTop}px)`)):n.push(0),m.paddingRight>0?n.push(`${m.paddingRight/m.scale}px`):n.push(0),m.paddingBottom>0?n.push(`${m.paddingBottom}px`):n.push(0),m.paddingLeft>0?(n.push(`${m.paddingLeft/m.scale}px`),e.push(`translateX(${-m.paddingLeft/m.scale}px)`)):n.push(0),S.style.padding=n.join(" "),e.length&&(S.style.transform=e.join(" "))):(S.style.padding=null,S.style.transform=m.originalTransform))}}}a.TextLayerRenderTask=l;function _(b){const o=new l({textContent:b.textContent,textContentStream:b.textContentStream,container:b.container,viewport:b.viewport,textDivs:b.textDivs,textContentItemsStr:b.textContentItemsStr,enhanceTextSelection:b.enhanceTextSelection});return o._render(b.timeout),o}},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.SVGGraphics=void 0;var u=R(8),p=R(1),B=R(3);let D=class{constructor(){(0,p.unreachable)("Not implemented: SVGGraphics")}};a.SVGGraphics=D;{let t=function(e){let n=[];const d=[];for(const T of e){if(T.fn==="save"){n.push({fnId:92,fn:"group",items:[]}),d.push(n),n=n.at(-1).items;continue}T.fn==="restore"?n=d.pop():n.push(T)}return n},s=function(e){if(Number.isInteger(e))return e.toString();const n=e.toFixed(10);let d=n.length-1;if(n[d]!=="0")return n;do d--;while(n[d]==="0");return n.substring(0,n[d]==="."?d:d+1)},l=function(e){if(e[4]===0&&e[5]===0){if(e[1]===0&&e[2]===0)return e[0]===1&&e[3]===1?"":`scale(${s(e[0])} ${s(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2]){const n=Math.acos(e[0])*180/Math.PI;return`rotate(${s(n)})`}}else if(e[0]===1&&e[1]===0&&e[2]===0&&e[3]===1)return`translate(${s(e[4])} ${s(e[5])})`;return`matrix(${s(e[0])} ${s(e[1])} ${s(e[2])} ${s(e[3])} ${s(e[4])} ${s(e[5])})`};const J={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},L="http://www.w3.org/XML/1998/namespace",f="http://www.w3.org/1999/xlink",E=["butt","round","square"],k=["miter","round","bevel"],y=function(e,n="",d=!1){if(URL.createObjectURL&&typeof Blob!="undefined"&&!d)return URL.createObjectURL(new Blob([e],{type:n}));const T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let S=`data:${n};base64,`;for(let m=0,x=e.length;m<x;m+=3){const Q=e[m]&255,it=e[m+1]&255,Z=e[m+2]&255,Y=Q>>2,W=(Q&3)<<4|it>>4,G=m+1<x?(it&15)<<2|Z>>6:64,V=m+2<x?Z&63:64;S+=T[Y]+T[W]+T[G]+T[V]}return S},v=function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),n=12,d=new Int32Array(256);for(let Z=0;Z<256;Z++){let Y=Z;for(let W=0;W<8;W++)Y&1?Y=3988292384^Y>>1&2147483647:Y=Y>>1&2147483647;d[Z]=Y}function T(Z,Y,W){let G=-1;for(let V=Y;V<W;V++){const nt=(G^Z[V])&255,ct=d[nt];G=G>>>8^ct}return G^-1}function S(Z,Y,W,G){let V=G;const nt=Y.length;W[V]=nt>>24&255,W[V+1]=nt>>16&255,W[V+2]=nt>>8&255,W[V+3]=nt&255,V+=4,W[V]=Z.charCodeAt(0)&255,W[V+1]=Z.charCodeAt(1)&255,W[V+2]=Z.charCodeAt(2)&255,W[V+3]=Z.charCodeAt(3)&255,V+=4,W.set(Y,V),V+=Y.length;const ct=T(W,G+4,V);W[V]=ct>>24&255,W[V+1]=ct>>16&255,W[V+2]=ct>>8&255,W[V+3]=ct&255}function m(Z,Y,W){let G=1,V=0;for(let nt=Y;nt<W;++nt)G=(G+(Z[nt]&255))%65521,V=(V+G)%65521;return V<<16|G}function x(Z){if(!B.isNodeJS)return Q(Z);try{let Y;parseInt(process.versions.node)>=8?Y=Z:Y=Buffer.from(Z);const W=require("zlib").deflateSync(Y,{level:9});return W instanceof Uint8Array?W:new Uint8Array(W)}catch(Y){(0,p.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Y)}return Q(Z)}function Q(Z){let Y=Z.length;const W=65535,G=Math.ceil(Y/W),V=new Uint8Array(2+Y+G*5+4);let nt=0;V[nt++]=120,V[nt++]=156;let ct=0;for(;Y>W;)V[nt++]=0,V[nt++]=255,V[nt++]=255,V[nt++]=0,V[nt++]=0,V.set(Z.subarray(ct,ct+W),nt),nt+=W,ct+=W,Y-=W;V[nt++]=1,V[nt++]=Y&255,V[nt++]=Y>>8&255,V[nt++]=~Y&65535&255,V[nt++]=(~Y&65535)>>8&255,V.set(Z.subarray(ct),nt),nt+=Z.length-ct;const bt=m(Z,0,Z.length);return V[nt++]=bt>>24&255,V[nt++]=bt>>16&255,V[nt++]=bt>>8&255,V[nt++]=bt&255,V}function it(Z,Y,W,G){const V=Z.width,nt=Z.height;let ct,bt,N;const h=Z.data;switch(Y){case p.ImageKind.GRAYSCALE_1BPP:bt=0,ct=1,N=V+7>>3;break;case p.ImageKind.RGB_24BPP:bt=2,ct=8,N=V*3;break;case p.ImageKind.RGBA_32BPP:bt=6,ct=8,N=V*4;break;default:throw new Error("invalid format")}const c=new Uint8Array((1+N)*nt);let w=0,O=0;for(let g=0;g<nt;++g)c[w++]=0,c.set(h.subarray(O,O+N),w),O+=N,w+=N;if(Y===p.ImageKind.GRAYSCALE_1BPP&&G){w=0;for(let g=0;g<nt;g++){w++;for(let A=0;A<N;A++)c[w++]^=255}}const I=new Uint8Array([V>>24&255,V>>16&255,V>>8&255,V&255,nt>>24&255,nt>>16&255,nt>>8&255,nt&255,ct,bt,0,0,0]),j=x(c),$=e.length+n*3+I.length+j.length,z=new Uint8Array($);let i=0;return z.set(e,i),i+=e.length,S("IHDR",I,z,i),i+=n+I.length,S("IDATA",j,z,i),i+=n+j.length,S("IEND",new Uint8Array(0),z,i),y(z,"image/png",W)}return function(Y,W,G){const V=Y.kind===void 0?p.ImageKind.GRAYSCALE_1BPP:Y.kind;return it(Y,V,W,G)}}();class r{constructor(){this.fontSizeScale=1,this.fontWeight=J.fontWeight,this.fontSize=0,this.textMatrix=p.IDENTITY_MATRIX,this.fontMatrix=p.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=p.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=J.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(n,d){this.x=n,this.y=d}}let _=0,b=0,o=0;a.SVGGraphics=D=class{constructor(e,n,d=!1){(0,u.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new u.DOMSVGFactory,this.current=new r,this.transformMatrix=p.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=n,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!d,this._operatorIdMapping=[];for(const T in p.OPS)this._operatorIdMapping[p.OPS[T]]=T}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const n=e.fnArray,d=e.argsArray;for(let T=0,S=n.length;T<S;T++)if(n[T]===p.OPS.dependency)for(const m of d[T]){const x=m.startsWith("g_")?this.commonObjs:this.objs,Q=new Promise(it=>{x.get(m,it)});this.current.dependencies.push(Q)}return Promise.all(this.current.dependencies)}transform(e,n,d,T,S,m){const x=[e,n,d,T,S,m];this.transformMatrix=p.Util.transform(this.transformMatrix,x),this.tgrp=null}getSVG(e,n){this.viewport=n;const d=this._initialize(n);return this.loadDependencies(e).then(()=>(this.transformMatrix=p.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),d))}convertOpList(e){const n=this._operatorIdMapping,d=e.argsArray,T=e.fnArray,S=[];for(let m=0,x=T.length;m<x;m++){const Q=T[m];S.push({fnId:Q,fn:n[Q],args:d[m]})}return t(S)}executeOpTree(e){for(const n of e){const d=n.fn,T=n.fnId,S=n.args;switch(T|0){case p.OPS.beginText:this.beginText();break;case p.OPS.dependency:break;case p.OPS.setLeading:this.setLeading(S);break;case p.OPS.setLeadingMoveText:this.setLeadingMoveText(S[0],S[1]);break;case p.OPS.setFont:this.setFont(S);break;case p.OPS.showText:this.showText(S[0]);break;case p.OPS.showSpacedText:this.showText(S[0]);break;case p.OPS.endText:this.endText();break;case p.OPS.moveText:this.moveText(S[0],S[1]);break;case p.OPS.setCharSpacing:this.setCharSpacing(S[0]);break;case p.OPS.setWordSpacing:this.setWordSpacing(S[0]);break;case p.OPS.setHScale:this.setHScale(S[0]);break;case p.OPS.setTextMatrix:this.setTextMatrix(S[0],S[1],S[2],S[3],S[4],S[5]);break;case p.OPS.setTextRise:this.setTextRise(S[0]);break;case p.OPS.setTextRenderingMode:this.setTextRenderingMode(S[0]);break;case p.OPS.setLineWidth:this.setLineWidth(S[0]);break;case p.OPS.setLineJoin:this.setLineJoin(S[0]);break;case p.OPS.setLineCap:this.setLineCap(S[0]);break;case p.OPS.setMiterLimit:this.setMiterLimit(S[0]);break;case p.OPS.setFillRGBColor:this.setFillRGBColor(S[0],S[1],S[2]);break;case p.OPS.setStrokeRGBColor:this.setStrokeRGBColor(S[0],S[1],S[2]);break;case p.OPS.setStrokeColorN:this.setStrokeColorN(S);break;case p.OPS.setFillColorN:this.setFillColorN(S);break;case p.OPS.shadingFill:this.shadingFill(S[0]);break;case p.OPS.setDash:this.setDash(S[0],S[1]);break;case p.OPS.setRenderingIntent:this.setRenderingIntent(S[0]);break;case p.OPS.setFlatness:this.setFlatness(S[0]);break;case p.OPS.setGState:this.setGState(S[0]);break;case p.OPS.fill:this.fill();break;case p.OPS.eoFill:this.eoFill();break;case p.OPS.stroke:this.stroke();break;case p.OPS.fillStroke:this.fillStroke();break;case p.OPS.eoFillStroke:this.eoFillStroke();break;case p.OPS.clip:this.clip("nonzero");break;case p.OPS.eoClip:this.clip("evenodd");break;case p.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case p.OPS.paintImageXObject:this.paintImageXObject(S[0]);break;case p.OPS.paintInlineImageXObject:this.paintInlineImageXObject(S[0]);break;case p.OPS.paintImageMaskXObject:this.paintImageMaskXObject(S[0]);break;case p.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(S[0],S[1]);break;case p.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case p.OPS.closePath:this.closePath();break;case p.OPS.closeStroke:this.closeStroke();break;case p.OPS.closeFillStroke:this.closeFillStroke();break;case p.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case p.OPS.nextLine:this.nextLine();break;case p.OPS.transform:this.transform(S[0],S[1],S[2],S[3],S[4],S[5]);break;case p.OPS.constructPath:this.constructPath(S[0],S[1]);break;case p.OPS.endPath:this.endPath();break;case 92:this.group(n.items);break;default:(0,p.warn)(`Unimplemented operator ${d}`);break}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,n,d,T,S,m){const x=this.current;x.textMatrix=x.lineMatrix=[e,n,d,T,S,m],x.textMatrixScale=Math.hypot(e,n),x.x=x.lineX=0,x.y=x.lineY=0,x.xcoords=[],x.ycoords=[],x.tspan=this.svgFactory.createElement("svg:tspan"),x.tspan.setAttributeNS(null,"font-family",x.fontFamily),x.tspan.setAttributeNS(null,"font-size",`${s(x.fontSize)}px`),x.tspan.setAttributeNS(null,"y",s(-x.y)),x.txtElement=this.svgFactory.createElement("svg:text"),x.txtElement.append(x.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=p.IDENTITY_MATRIX,e.lineMatrix=p.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,n){const d=this.current;d.x=d.lineX+=e,d.y=d.lineY+=n,d.xcoords=[],d.ycoords=[],d.tspan=this.svgFactory.createElement("svg:tspan"),d.tspan.setAttributeNS(null,"font-family",d.fontFamily),d.tspan.setAttributeNS(null,"font-size",`${s(d.fontSize)}px`),d.tspan.setAttributeNS(null,"y",s(-d.y))}showText(e){const n=this.current,d=n.font,T=n.fontSize;if(T===0)return;const S=n.fontSizeScale,m=n.charSpacing,x=n.wordSpacing,Q=n.fontDirection,it=n.textHScale*Q,Z=d.vertical,Y=Z?1:-1,W=d.defaultVMetrics,G=T*n.fontMatrix[0];let V=0;for(const bt of e){if(bt===null){V+=Q*x;continue}else if(typeof bt=="number"){V+=Y*bt*T/1e3;continue}const N=(bt.isSpace?x:0)+m,h=bt.fontChar;let c,w,O=bt.width;if(Z){let j;const $=bt.vmetric||W;j=bt.vmetric?$[1]:O*.5,j=-j*G;const z=$[2]*G;O=$?-$[0]:O,c=j/S,w=(V+z)/S}else c=V/S,w=0;(bt.isInFont||d.missingFile)&&(n.xcoords.push(n.x+c),Z&&n.ycoords.push(-n.y+w),n.tspan.textContent+=h);let I;Z?I=O*G-N*Q:I=O*G+N*Q,V+=I}n.tspan.setAttributeNS(null,"x",n.xcoords.map(s).join(" ")),Z?n.tspan.setAttributeNS(null,"y",n.ycoords.map(s).join(" ")):n.tspan.setAttributeNS(null,"y",s(-n.y)),Z?n.y-=V:n.x+=V*it,n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",`${s(n.fontSize)}px`),n.fontStyle!==J.fontStyle&&n.tspan.setAttributeNS(null,"font-style",n.fontStyle),n.fontWeight!==J.fontWeight&&n.tspan.setAttributeNS(null,"font-weight",n.fontWeight);const nt=n.textRenderingMode&p.TextRenderingMode.FILL_STROKE_MASK;if(nt===p.TextRenderingMode.FILL||nt===p.TextRenderingMode.FILL_STROKE?(n.fillColor!==J.fillColor&&n.tspan.setAttributeNS(null,"fill",n.fillColor),n.fillAlpha<1&&n.tspan.setAttributeNS(null,"fill-opacity",n.fillAlpha)):n.textRenderingMode===p.TextRenderingMode.ADD_TO_PATH?n.tspan.setAttributeNS(null,"fill","transparent"):n.tspan.setAttributeNS(null,"fill","none"),nt===p.TextRenderingMode.STROKE||nt===p.TextRenderingMode.FILL_STROKE){const bt=1/(n.textMatrixScale||1);this._setStrokeAttributes(n.tspan,bt)}let ct=n.textMatrix;n.textRise!==0&&(ct=ct.slice(),ct[5]+=n.textRise),n.txtElement.setAttributeNS(null,"transform",`${l(ct)} scale(${s(it)}, -1)`),n.txtElement.setAttributeNS(L,"xml:space","preserve"),n.txtElement.append(n.tspan),n.txtgrp.append(n.txtElement),this._ensureTransformGroup().append(n.txtElement)}setLeadingMoveText(e,n){this.setLeading(-n),this.moveText(e,n)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const n=y(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${n}); }
`}setFont(e){const n=this.current,d=this.commonObjs.get(e[0]);let T=e[1];n.font=d,this.embedFonts&&!d.missingFile&&!this.embeddedFonts[d.loadedName]&&(this.addFontStyle(d),this.embeddedFonts[d.loadedName]=d),n.fontMatrix=d.fontMatrix||p.FONT_IDENTITY_MATRIX;let S="normal";d.black?S="900":d.bold&&(S="bold");const m=d.italic?"italic":"normal";T<0?(T=-T,n.fontDirection=-1):n.fontDirection=1,n.fontSize=T,n.fontFamily=d.loadedName,n.fontWeight=S,n.fontStyle=m,n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"y",s(-n.y)),n.xcoords=[],n.ycoords=[]}endText(){var n;const e=this.current;e.textRenderingMode&p.TextRenderingMode.ADD_TO_PATH_FLAG&&((n=e.txtElement)==null?void 0:n.hasChildNodes())&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=E[e]}setLineJoin(e){this.current.lineJoin=k[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,n,d){this.current.strokeColor=p.Util.makeHexColor(e,n,d)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,n,d){this.current.fillColor=p.Util.makeHexColor(e,n,d),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const n=this.viewport.width,d=this.viewport.height,T=p.Util.inverseTransform(this.transformMatrix),S=p.Util.applyTransform([0,0],T),m=p.Util.applyTransform([0,d],T),x=p.Util.applyTransform([n,0],T),Q=p.Util.applyTransform([n,d],T),it=Math.min(S[0],m[0],x[0],Q[0]),Z=Math.min(S[1],m[1],x[1],Q[1]),Y=Math.max(S[0],m[0],x[0],Q[0]),W=Math.max(S[1],m[1],x[1],Q[1]),G=this.svgFactory.createElement("svg:rect");G.setAttributeNS(null,"x",it),G.setAttributeNS(null,"y",Z),G.setAttributeNS(null,"width",Y-it),G.setAttributeNS(null,"height",W-Z),G.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&G.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(G)}_makeColorN_Pattern(e){return e[0]==="TilingPattern"?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const n=e[1],d=e[2],T=e[3]||p.IDENTITY_MATRIX,[S,m,x,Q]=e[4],it=e[5],Z=e[6],Y=e[7],W=`shading${o++}`,[G,V,nt,ct]=p.Util.normalizeRect([...p.Util.applyTransform([S,m],T),...p.Util.applyTransform([x,Q],T)]),[bt,N]=p.Util.singularValueDecompose2dScale(T),h=it*bt,c=Z*N,w=this.svgFactory.createElement("svg:pattern");w.setAttributeNS(null,"id",W),w.setAttributeNS(null,"patternUnits","userSpaceOnUse"),w.setAttributeNS(null,"width",h),w.setAttributeNS(null,"height",c),w.setAttributeNS(null,"x",`${G}`),w.setAttributeNS(null,"y",`${V}`);const O=this.svg,I=this.transformMatrix,j=this.current.fillColor,$=this.current.strokeColor,z=this.svgFactory.create(nt-G,ct-V);if(this.svg=z,this.transformMatrix=T,Y===2){const i=p.Util.makeHexColor(...n);this.current.fillColor=i,this.current.strokeColor=i}return this.executeOpTree(this.convertOpList(d)),this.svg=O,this.transformMatrix=I,this.current.fillColor=j,this.current.strokeColor=$,w.append(z.childNodes[0]),this.defs.append(w),`url(#${W})`}_makeShadingPattern(e){switch(typeof e=="string"&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const n=`shading${o++}`,d=e[3];let T;switch(e[1]){case"axial":const S=e[4],m=e[5];T=this.svgFactory.createElement("svg:linearGradient"),T.setAttributeNS(null,"id",n),T.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),T.setAttributeNS(null,"x1",S[0]),T.setAttributeNS(null,"y1",S[1]),T.setAttributeNS(null,"x2",m[0]),T.setAttributeNS(null,"y2",m[1]);break;case"radial":const x=e[4],Q=e[5],it=e[6],Z=e[7];T=this.svgFactory.createElement("svg:radialGradient"),T.setAttributeNS(null,"id",n),T.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),T.setAttributeNS(null,"cx",Q[0]),T.setAttributeNS(null,"cy",Q[1]),T.setAttributeNS(null,"r",Z),T.setAttributeNS(null,"fx",x[0]),T.setAttributeNS(null,"fy",x[1]),T.setAttributeNS(null,"fr",it);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const S of d){const m=this.svgFactory.createElement("svg:stop");m.setAttributeNS(null,"offset",S[0]),m.setAttributeNS(null,"stop-color",S[1]),T.append(m)}return this.defs.append(T),`url(#${n})`;case"Mesh":return(0,p.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,n){this.current.dashArray=e,this.current.dashPhase=n}constructPath(e,n){const d=this.current;let T=d.x,S=d.y,m=[],x=0;for(const Q of e)switch(Q|0){case p.OPS.rectangle:T=n[x++],S=n[x++];const it=n[x++],Z=n[x++],Y=T+it,W=S+Z;m.push("M",s(T),s(S),"L",s(Y),s(S),"L",s(Y),s(W),"L",s(T),s(W),"Z");break;case p.OPS.moveTo:T=n[x++],S=n[x++],m.push("M",s(T),s(S));break;case p.OPS.lineTo:T=n[x++],S=n[x++],m.push("L",s(T),s(S));break;case p.OPS.curveTo:T=n[x+4],S=n[x+5],m.push("C",s(n[x]),s(n[x+1]),s(n[x+2]),s(n[x+3]),s(T),s(S)),x+=6;break;case p.OPS.curveTo2:m.push("C",s(T),s(S),s(n[x]),s(n[x+1]),s(n[x+2]),s(n[x+3])),T=n[x+2],S=n[x+3],x+=4;break;case p.OPS.curveTo3:T=n[x+2],S=n[x+3],m.push("C",s(n[x]),s(n[x+1]),s(T),s(S),s(T),s(S)),x+=4;break;case p.OPS.closePath:m.push("Z");break}m=m.join(" "),d.path&&e.length>0&&e[0]!==p.OPS.rectangle&&e[0]!==p.OPS.moveTo?m=d.path.getAttributeNS(null,"d")+m:(d.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(d.path)),d.path.setAttributeNS(null,"d",m),d.path.setAttributeNS(null,"fill","none"),d.element=d.path,d.setCurrentPoint(T,S)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element){this.pendingClip=null;return}const n=`clippath${_++}`,d=this.svgFactory.createElement("svg:clipPath");d.setAttributeNS(null,"id",n),d.setAttributeNS(null,"transform",l(this.transformMatrix));const T=e.element.cloneNode(!0);if(this.pendingClip==="evenodd"?T.setAttributeNS(null,"clip-rule","evenodd"):T.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,d.append(T),this.defs.append(d),e.activeClipUrl){e.clipGroup=null;for(const S of this.extraStack)S.clipGroup=null;d.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl=`url(#${n})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const n=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",n)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[n,d]of e)switch(n){case"LW":this.setLineWidth(d);break;case"LC":this.setLineCap(d);break;case"LJ":this.setLineJoin(d);break;case"ML":this.setMiterLimit(d);break;case"D":this.setDash(d[0],d[1]);break;case"RI":this.setRenderingIntent(d);break;case"FL":this.setFlatness(d);break;case"Font":this.setFont(d);break;case"CA":this.setStrokeAlpha(d);break;case"ca":this.setFillAlpha(d);break;default:(0,p.warn)(`Unimplemented graphic state operator ${n}`);break}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,n=1){const d=this.current;let T=d.dashArray;n!==1&&T.length>0&&(T=T.map(function(S){return n*S})),e.setAttributeNS(null,"stroke",d.strokeColor),e.setAttributeNS(null,"stroke-opacity",d.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",s(d.miterLimit)),e.setAttributeNS(null,"stroke-linecap",d.lineCap),e.setAttributeNS(null,"stroke-linejoin",d.lineJoin),e.setAttributeNS(null,"stroke-width",s(n*d.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",T.map(s).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",s(n*d.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(e)}paintImageXObject(e){const n=e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e);if(!n){(0,p.warn)(`Dependent image with object ID ${e} is not ready yet`);return}this.paintInlineImageXObject(n)}paintInlineImageXObject(e,n){const d=e.width,T=e.height,S=v(e,this.forceDataSchema,!!n),m=this.svgFactory.createElement("svg:rect");m.setAttributeNS(null,"x","0"),m.setAttributeNS(null,"y","0"),m.setAttributeNS(null,"width",s(d)),m.setAttributeNS(null,"height",s(T)),this.current.element=m,this.clip("nonzero");const x=this.svgFactory.createElement("svg:image");x.setAttributeNS(f,"xlink:href",S),x.setAttributeNS(null,"x","0"),x.setAttributeNS(null,"y",s(-T)),x.setAttributeNS(null,"width",s(d)+"px"),x.setAttributeNS(null,"height",s(T)+"px"),x.setAttributeNS(null,"transform",`scale(${s(1/d)} ${s(-1/T)})`),n?n.append(x):this._ensureTransformGroup().append(x)}paintImageMaskXObject(e){const n=this.current,d=e.width,T=e.height,S=n.fillColor;n.maskId=`mask${b++}`;const m=this.svgFactory.createElement("svg:mask");m.setAttributeNS(null,"id",n.maskId);const x=this.svgFactory.createElement("svg:rect");x.setAttributeNS(null,"x","0"),x.setAttributeNS(null,"y","0"),x.setAttributeNS(null,"width",s(d)),x.setAttributeNS(null,"height",s(T)),x.setAttributeNS(null,"fill",S),x.setAttributeNS(null,"mask",`url(#${n.maskId})`),this.defs.append(m),this._ensureTransformGroup().append(x),this.paintInlineImageXObject(e,m)}paintFormXObjectBegin(e,n){if(Array.isArray(e)&&e.length===6&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),n){const d=n[2]-n[0],T=n[3]-n[1],S=this.svgFactory.createElement("svg:rect");S.setAttributeNS(null,"x",n[0]),S.setAttributeNS(null,"y",n[1]),S.setAttributeNS(null,"width",s(d)),S.setAttributeNS(null,"height",s(T)),this.current.element=S,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const n=this.svgFactory.create(e.width,e.height),d=this.svgFactory.createElement("svg:defs");n.append(d),this.defs=d;const T=this.svgFactory.createElement("svg:g");return T.setAttributeNS(null,"transform",l(e.transform)),n.append(T),this.svg=T,n}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",l(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFNodeStream=void 0;var u=R(1),p=R(33);const B=require$$4,D=require$$4,J=require$$4,L=require$$4,f=/^file:\/\/\/[a-zA-Z]:\//;function E(b){const o=L.parse(b);return o.protocol==="file:"||o.host?o:/^[a-z]:[/\\]/i.test(b)?L.parse(`file:///${b}`):(o.host||(o.protocol="file:"),o)}class k{constructor(o){this.source=o,this.url=E(o.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&o.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var o,e;return(e=(o=this._fullRequestReader)==null?void 0:o._loaded)!=null?e:0}getFullReader(){return(0,u.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new l(this):new t(this),this._fullRequestReader}getRangeReader(o,e){if(e<=this._progressiveDataLength)return null;const n=this.isFsUrl?new _(this,o,e):new s(this,o,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(o){this._fullRequestReader&&this._fullRequestReader.cancel(o);for(const e of this._rangeRequestReaders.slice(0))e.cancel(o)}}a.PDFNodeStream=k;class y{constructor(o){this._url=o.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=o.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=(0,u.createPromiseCapability)(),this._headersCapability=(0,u.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const o=this._readableStream.read();return o===null?(this._readCapability=(0,u.createPromiseCapability)(),this.read()):(this._loaded+=o.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(o).buffer,done:!1})}cancel(o){if(!this._readableStream){this._error(o);return}this._readableStream.destroy(o)}_error(o){this._storedError=o,this._readCapability.resolve()}_setReadableStream(o){this._readableStream=o,o.on("readable",()=>{this._readCapability.resolve()}),o.on("end",()=>{o.destroy(),this._done=!0,this._readCapability.resolve()}),o.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new u.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class v{constructor(o){this._url=o.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,u.createPromiseCapability)();const e=o.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const o=this._readableStream.read();return o===null?(this._readCapability=(0,u.createPromiseCapability)(),this.read()):(this._loaded+=o.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(o).buffer,done:!1})}cancel(o){if(!this._readableStream){this._error(o);return}this._readableStream.destroy(o)}_error(o){this._storedError=o,this._readCapability.resolve()}_setReadableStream(o){this._readableStream=o,o.on("readable",()=>{this._readCapability.resolve()}),o.on("end",()=>{o.destroy(),this._done=!0,this._readCapability.resolve()}),o.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function r(b,o){return{protocol:b.protocol,auth:b.auth,host:b.hostname,port:b.port,path:b.path,method:"GET",headers:o}}class t extends y{constructor(o){super(o);const e=n=>{if(n.statusCode===404){const m=new u.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=m,this._headersCapability.reject(m);return}this._headersCapability.resolve(),this._setReadableStream(n);const d=m=>this._readableStream.headers[m.toLowerCase()],{allowRangeRequests:T,suggestedLength:S}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:d,isHttp:o.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=T,this._contentLength=S||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(d)};this._request=null,this._url.protocol==="http:"?this._request=D.request(r(this._url,o.httpHeaders),e):this._request=J.request(r(this._url,o.httpHeaders),e),this._request.on("error",n=>{this._storedError=n,this._headersCapability.reject(n)}),this._request.end()}}class s extends v{constructor(o,e,n){super(o),this._httpHeaders={};for(const T in o.httpHeaders){const S=o.httpHeaders[T];typeof S!="undefined"&&(this._httpHeaders[T]=S)}this._httpHeaders.Range=`bytes=${e}-${n-1}`;const d=T=>{if(T.statusCode===404){const S=new u.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=S;return}this._setReadableStream(T)};this._request=null,this._url.protocol==="http:"?this._request=D.request(r(this._url,this._httpHeaders),d):this._request=J.request(r(this._url,this._httpHeaders),d),this._request.on("error",T=>{this._storedError=T}),this._request.end()}}class l extends y{constructor(o){super(o);let e=decodeURIComponent(this._url.path);f.test(this._url.href)&&(e=e.replace(/^\//,"")),B.lstat(e,(n,d)=>{if(n){n.code==="ENOENT"&&(n=new u.MissingPDFException(`Missing PDF "${e}".`)),this._storedError=n,this._headersCapability.reject(n);return}this._contentLength=d.size,this._setReadableStream(B.createReadStream(e)),this._headersCapability.resolve()})}}class _ extends v{constructor(o,e,n){super(o);let d=decodeURIComponent(this._url.path);f.test(this._url.href)&&(d=d.replace(/^\//,"")),this._setReadableStream(B.createReadStream(d,{start:e,end:n-1}))}}},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createResponseStatusError=L,a.extractFilenameFromHeader=J,a.validateRangeRequestCapabilities=D,a.validateResponseStatus=f;var u=R(1),p=R(34),B=R(8);function D({getResponseHeader:E,isHttp:k,rangeChunkSize:y,disableRange:v}){const r={allowRangeRequests:!1,suggestedLength:void 0},t=parseInt(E("Content-Length"),10);return!Number.isInteger(t)||(r.suggestedLength=t,t<=2*y)||v||!k||E("Accept-Ranges")!=="bytes"||(E("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function J(E){const k=E("Content-Disposition");if(k){let y=(0,p.getFilenameFromContentDispositionHeader)(k);if(y.includes("%"))try{y=decodeURIComponent(y)}catch{}if((0,B.isPdfFile)(y))return y}return null}function L(E,k){return E===404||E===0&&k.startsWith("file:")?new u.MissingPDFException('Missing PDF "'+k+'".'):new u.UnexpectedResponseException(`Unexpected server response (${E}) while retrieving PDF "${k}".`,E)}function f(E){return E===200||E===206}},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.getFilenameFromContentDispositionHeader=p;var u=R(1);function p(B){let D=!0,J=L("filename\\*","i").exec(B);if(J){J=J[1];let t=y(J);return t=unescape(t),t=v(t),t=r(t),E(t)}if(J=k(B),J){const t=r(J);return E(t)}if(J=L("filename","i").exec(B),J){J=J[1];let t=y(J);return t=r(t),E(t)}function L(t,s){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',s)}function f(t,s){if(t){if(!/^[\x00-\xFF]+$/.test(s))return s;try{const l=new TextDecoder(t,{fatal:!0}),_=(0,u.stringToBytes)(s);s=l.decode(_),D=!1}catch{}}return s}function E(t){return D&&/[\x80-\xff]/.test(t)&&(t=f("utf-8",t),D&&(t=f("iso-8859-1",t))),t}function k(t){const s=[];let l;const _=L("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(l=_.exec(t))!==null;){let[,o,e,n]=l;if(o=parseInt(o,10),o in s){if(o===0)break;continue}s[o]=[e,n]}const b=[];for(let o=0;o<s.length&&o in s;++o){let[e,n]=s[o];n=y(n),e&&(n=unescape(n),o===0&&(n=v(n))),b.push(n)}return b.join("")}function y(t){if(t.startsWith('"')){const s=t.slice(1).split('\\"');for(let l=0;l<s.length;++l){const _=s[l].indexOf('"');_!==-1&&(s[l]=s[l].slice(0,_),s.length=l+1),s[l]=s[l].replace(/\\(.)/g,"$1")}t=s.join('"')}return t}function v(t){const s=t.indexOf("'");if(s===-1)return t;const l=t.slice(0,s),b=t.slice(s+1).replace(/^[^']*'/,"");return f(l,b)}function r(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(s,l,_,b){if(_==="q"||_==="Q")return b=b.replace(/_/g," "),b=b.replace(/=([0-9a-fA-F]{2})/g,function(o,e){return String.fromCharCode(parseInt(e,16))}),f(l,b);try{b=atob(b)}catch{}return f(l,b)})}return""}},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFNetworkStream=void 0;var u=R(1),p=R(33);const B=200,D=206;function J(y){const v=y.response;return typeof v!="string"?v:(0,u.stringToBytes)(v).buffer}class L{constructor(v,r={}){this.url=v,this.isHttp=/^https?:/i.test(v),this.httpHeaders=this.isHttp&&r.httpHeaders||Object.create(null),this.withCredentials=r.withCredentials||!1,this.getXhr=r.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(v,r,t){const s={begin:v,end:r};for(const l in t)s[l]=t[l];return this.request(s)}requestFull(v){return this.request(v)}request(v){const r=this.getXhr(),t=this.currXhrId++,s=this.pendingRequests[t]={xhr:r};r.open("GET",this.url),r.withCredentials=this.withCredentials;for(const l in this.httpHeaders){const _=this.httpHeaders[l];typeof _!="undefined"&&r.setRequestHeader(l,_)}return this.isHttp&&"begin"in v&&"end"in v?(r.setRequestHeader("Range",`bytes=${v.begin}-${v.end-1}`),s.expectedStatus=D):s.expectedStatus=B,r.responseType="arraybuffer",v.onError&&(r.onerror=function(l){v.onError(r.status)}),r.onreadystatechange=this.onStateChange.bind(this,t),r.onprogress=this.onProgress.bind(this,t),s.onHeadersReceived=v.onHeadersReceived,s.onDone=v.onDone,s.onError=v.onError,s.onProgress=v.onProgress,r.send(null),t}onProgress(v,r){var s;const t=this.pendingRequests[v];!t||(s=t.onProgress)==null||s.call(t,r)}onStateChange(v,r){var o,e,n;const t=this.pendingRequests[v];if(!t)return;const s=t.xhr;if(s.readyState>=2&&t.onHeadersReceived&&(t.onHeadersReceived(),delete t.onHeadersReceived),s.readyState!==4||!(v in this.pendingRequests))return;if(delete this.pendingRequests[v],s.status===0&&this.isHttp){(o=t.onError)==null||o.call(t,s.status);return}const l=s.status||B;if(!(l===B&&t.expectedStatus===D)&&l!==t.expectedStatus){(e=t.onError)==null||e.call(t,s.status);return}const b=J(s);if(l===D){const d=s.getResponseHeader("Content-Range"),T=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);t.onDone({begin:parseInt(T[1],10),chunk:b})}else b?t.onDone({begin:0,chunk:b}):(n=t.onError)==null||n.call(t,s.status)}getRequestXhr(v){return this.pendingRequests[v].xhr}isPendingRequest(v){return v in this.pendingRequests}abortRequest(v){const r=this.pendingRequests[v].xhr;delete this.pendingRequests[v],r.abort()}}class f{constructor(v){this._source=v,this._manager=new L(v.url,{httpHeaders:v.httpHeaders,withCredentials:v.withCredentials}),this._rangeChunkSize=v.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(v){const r=this._rangeRequestReaders.indexOf(v);r>=0&&this._rangeRequestReaders.splice(r,1)}getFullReader(){return(0,u.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new E(this._manager,this._source),this._fullRequestReader}getRangeReader(v,r){const t=new k(this._manager,v,r);return t.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(t),t}cancelAllRequests(v){var r;(r=this._fullRequestReader)==null||r.cancel(v);for(const t of this._rangeRequestReaders.slice(0))t.cancel(v)}}a.PDFNetworkStream=f;class E{constructor(v,r){this._manager=v;const t={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=r.url,this._fullRequestId=v.requestFull(t),this._headersReceivedCapability=(0,u.createPromiseCapability)(),this._disableRange=r.disableRange||!1,this._contentLength=r.length,this._rangeChunkSize=r.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const v=this._fullRequestId,r=this._manager.getRequestXhr(v),t=_=>r.getResponseHeader(_),{allowRangeRequests:s,suggestedLength:l}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(t),this._isRangeSupported&&this._manager.abortRequest(v),this._headersReceivedCapability.resolve()}_onDone(v){if(v&&(this._requests.length>0?this._requests.shift().resolve({value:v.chunk,done:!1}):this._cachedChunks.push(v.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(v){this._storedError=(0,p.createResponseStatusError)(v,this._url),this._headersReceivedCapability.reject(this._storedError);for(const r of this._requests)r.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(v){var r;(r=this.onProgress)==null||r.call(this,{loaded:v.loaded,total:v.lengthComputable?v.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const v=(0,u.createPromiseCapability)();return this._requests.push(v),v.promise}cancel(v){this._done=!0,this._headersReceivedCapability.reject(v);for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class k{constructor(v,r,t){this._manager=v;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=v.url,this._requestId=v.requestRange(r,t,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var v;(v=this.onClosed)==null||v.call(this,this)}_onDone(v){const r=v.chunk;this._requests.length>0?this._requests.shift().resolve({value:r,done:!1}):this._queuedChunk=r,this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(v){this._storedError=(0,p.createResponseStatusError)(v,this._url);for(const r of this._requests)r.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(v){var r;this.isStreamingSupported||(r=this.onProgress)==null||r.call(this,{loaded:v.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const r=this._queuedChunk;return this._queuedChunk=null,{value:r,done:!1}}if(this._done)return{value:void 0,done:!0};const v=(0,u.createPromiseCapability)();return this._requests.push(v),v.promise}cancel(v){this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(X,a,R)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFFetchStream=void 0;var u=R(1),p=R(33);function B(E,k,y){return{method:"GET",headers:E,signal:y.signal,mode:"cors",credentials:k?"include":"same-origin",redirect:"follow"}}function D(E){const k=new Headers;for(const y in E){const v=E[y];typeof v!="undefined"&&k.append(y,v)}return k}class J{constructor(k){this.source=k,this.isHttp=/^https?:/i.test(k.url),this.httpHeaders=this.isHttp&&k.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var k,y;return(y=(k=this._fullRequestReader)==null?void 0:k._loaded)!=null?y:0}getFullReader(){return(0,u.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new L(this),this._fullRequestReader}getRangeReader(k,y){if(y<=this._progressiveDataLength)return null;const v=new f(this,k,y);return this._rangeRequestReaders.push(v),v}cancelAllRequests(k){this._fullRequestReader&&this._fullRequestReader.cancel(k);for(const y of this._rangeRequestReaders.slice(0))y.cancel(k)}}a.PDFFetchStream=J;class L{constructor(k){this._stream=k,this._reader=null,this._loaded=0,this._filename=null;const y=k.source;this._withCredentials=y.withCredentials||!1,this._contentLength=y.length,this._headersCapability=(0,u.createPromiseCapability)(),this._disableRange=y.disableRange||!1,this._rangeChunkSize=y.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!y.disableStream,this._isRangeSupported=!y.disableRange,this._headers=D(this._stream.httpHeaders);const v=y.url;fetch(v,B(this._headers,this._withCredentials,this._abortController)).then(r=>{if(!(0,p.validateResponseStatus)(r.status))throw(0,p.createResponseStatusError)(r.status,v);this._reader=r.body.getReader(),this._headersCapability.resolve();const t=_=>r.headers.get(_),{allowRangeRequests:s,suggestedLength:l}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=l||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(t),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new u.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:k,done:y}=await this._reader.read();return y?{value:k,done:y}:(this._loaded+=k.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(k).buffer,done:!1})}cancel(k){this._reader&&this._reader.cancel(k),this._abortController.abort()}}class f{constructor(k,y,v){this._stream=k,this._reader=null,this._loaded=0;const r=k.source;this._withCredentials=r.withCredentials||!1,this._readCapability=(0,u.createPromiseCapability)(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController,this._headers=D(this._stream.httpHeaders),this._headers.append("Range",`bytes=${y}-${v-1}`);const t=r.url;fetch(t,B(this._headers,this._withCredentials,this._abortController)).then(s=>{if(!(0,p.validateResponseStatus)(s.status))throw(0,p.createResponseStatusError)(s.status,t);this._readCapability.resolve(),this._reader=s.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:k,done:y}=await this._reader.read();return y?{value:k,done:y}:(this._loaded+=k.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(k).buffer,done:!1})}cancel(k){this._reader&&this._reader.cancel(k),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(X){var a=__webpack_module_cache__[X];if(a!==void 0)return a.exports;var R=__webpack_module_cache__[X]={exports:{}};return __webpack_modules__[X](R,R.exports,__w_pdfjs_require__),R.exports}var __webpack_exports__={};return(()=>{var X=__webpack_exports__;Object.defineProperty(X,"__esModule",{value:!0}),Object.defineProperty(X,"AnnotationEditorLayer",{enumerable:!0,get:function(){return p.AnnotationEditorLayer}}),Object.defineProperty(X,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return a.AnnotationEditorParamsType}}),Object.defineProperty(X,"AnnotationEditorType",{enumerable:!0,get:function(){return a.AnnotationEditorType}}),Object.defineProperty(X,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return B.AnnotationEditorUIManager}}),Object.defineProperty(X,"AnnotationLayer",{enumerable:!0,get:function(){return D.AnnotationLayer}}),Object.defineProperty(X,"AnnotationMode",{enumerable:!0,get:function(){return a.AnnotationMode}}),Object.defineProperty(X,"CMapCompressionType",{enumerable:!0,get:function(){return a.CMapCompressionType}}),Object.defineProperty(X,"GlobalWorkerOptions",{enumerable:!0,get:function(){return J.GlobalWorkerOptions}}),Object.defineProperty(X,"InvalidPDFException",{enumerable:!0,get:function(){return a.InvalidPDFException}}),Object.defineProperty(X,"LoopbackPort",{enumerable:!0,get:function(){return R.LoopbackPort}}),Object.defineProperty(X,"MissingPDFException",{enumerable:!0,get:function(){return a.MissingPDFException}}),Object.defineProperty(X,"OPS",{enumerable:!0,get:function(){return a.OPS}}),Object.defineProperty(X,"PDFDataRangeTransport",{enumerable:!0,get:function(){return R.PDFDataRangeTransport}}),Object.defineProperty(X,"PDFDateString",{enumerable:!0,get:function(){return u.PDFDateString}}),Object.defineProperty(X,"PDFWorker",{enumerable:!0,get:function(){return R.PDFWorker}}),Object.defineProperty(X,"PasswordResponses",{enumerable:!0,get:function(){return a.PasswordResponses}}),Object.defineProperty(X,"PermissionFlag",{enumerable:!0,get:function(){return a.PermissionFlag}}),Object.defineProperty(X,"PixelsPerInch",{enumerable:!0,get:function(){return u.PixelsPerInch}}),Object.defineProperty(X,"RenderingCancelledException",{enumerable:!0,get:function(){return u.RenderingCancelledException}}),Object.defineProperty(X,"SVGGraphics",{enumerable:!0,get:function(){return E.SVGGraphics}}),Object.defineProperty(X,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return a.UNSUPPORTED_FEATURES}}),Object.defineProperty(X,"UnexpectedResponseException",{enumerable:!0,get:function(){return a.UnexpectedResponseException}}),Object.defineProperty(X,"Util",{enumerable:!0,get:function(){return a.Util}}),Object.defineProperty(X,"VerbosityLevel",{enumerable:!0,get:function(){return a.VerbosityLevel}}),Object.defineProperty(X,"XfaLayer",{enumerable:!0,get:function(){return k.XfaLayer}}),Object.defineProperty(X,"build",{enumerable:!0,get:function(){return R.build}}),Object.defineProperty(X,"createPromiseCapability",{enumerable:!0,get:function(){return a.createPromiseCapability}}),Object.defineProperty(X,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return a.createValidAbsoluteUrl}}),Object.defineProperty(X,"getDocument",{enumerable:!0,get:function(){return R.getDocument}}),Object.defineProperty(X,"getFilenameFromUrl",{enumerable:!0,get:function(){return u.getFilenameFromUrl}}),Object.defineProperty(X,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return u.getPdfFilenameFromUrl}}),Object.defineProperty(X,"getXfaPageViewport",{enumerable:!0,get:function(){return u.getXfaPageViewport}}),Object.defineProperty(X,"isPdfFile",{enumerable:!0,get:function(){return u.isPdfFile}}),Object.defineProperty(X,"loadScript",{enumerable:!0,get:function(){return u.loadScript}}),Object.defineProperty(X,"renderTextLayer",{enumerable:!0,get:function(){return f.renderTextLayer}}),Object.defineProperty(X,"shadow",{enumerable:!0,get:function(){return a.shadow}}),Object.defineProperty(X,"version",{enumerable:!0,get:function(){return R.version}});var a=__w_pdfjs_require__(1),R=__w_pdfjs_require__(4),u=__w_pdfjs_require__(8),p=__w_pdfjs_require__(22),B=__w_pdfjs_require__(7),D=__w_pdfjs_require__(27),J=__w_pdfjs_require__(15),L=__w_pdfjs_require__(3),f=__w_pdfjs_require__(30),E=__w_pdfjs_require__(31),k=__w_pdfjs_require__(29);if(L.isNodeJS){const{PDFNodeStream:y}=__w_pdfjs_require__(32);(0,R.setPDFNetworkStreamFactory)(v=>new y(v))}else{const{PDFNetworkStream:y}=__w_pdfjs_require__(35),{PDFFetchStream:v}=__w_pdfjs_require__(36);(0,R.setPDFNetworkStreamFactory)(r=>(0,u.isValidFetchUrl)(r.url)?new v(r):new y(r))}})(),__webpack_exports__})())})(pdf);const gw_opts=pdf.exports.GlobalWorkerOptions,orig_src=gw_opts==null?void 0:gw_opts.workerSrc;let worker_src=orig_src!=null?orig_src:`https://cdn.jsdelivr.net/npm/pdfjs-dist@${pdf.exports.version}/build/pdf.worker.min.js`;function set_worker_src(X){worker_src=X}const PDFWorker=readable(null,X=>{gw_opts.workerSrc=worker_src;const a=new pdf.exports.PDFWorker;return gw_opts.workerSrc=orig_src,X(a),()=>a.destroy()});function create_fragment$2(X){let a;const R=X[5].default,u=create_slot(R,X,X[4],null);return{c(){u&&u.c()},l(p){u&&u.l(p)},m(p,B){u&&u.m(p,B),a=!0},p(p,[B]){u&&u.p&&(!a||B&16)&&update_slot_base(u,R,p,p[4],a?get_slot_changes(R,p[4],B,null):get_all_dirty_from_scope(p[4]),null)},i(p){a||(transition_in(u,p),a=!0)},o(p){transition_out(u,p),a=!1},d(p){u&&u.d(p)}}}const key=Symbol.for("current_doc");function instance$2(X,a,R){let u,p;component_subscribe(X,PDFWorker,r=>R(7,u=r));let{$$slots:B={},$$scope:D}=a;const J=createEventDispatcher();let{file:L=void 0}=a,{loadOptions:f=void 0}=a,{onProgress:E=void 0}=a,k=writable();component_subscribe(X,k,r=>R(8,p=r));let y;setContext(key,k),onDestroy(()=>{p==null||p.destroy(),p==null||p.cleanup(!1)});function v(){const r=p;k.set(null),y=pdf.exports.getDocument(te({url:L,worker:u},f)),y.onProgress=E,y.promise.then(t=>(r==null||r.destroy(),r==null||r.cleanup(),J("loadsuccess",t),t),t=>(J("loaderror",t),r)).then(k.set)}return X.$$set=r=>{"file"in r&&R(1,L=r.file),"loadOptions"in r&&R(2,f=r.loadOptions),"onProgress"in r&&R(3,E=r.onProgress),"$$scope"in r&&R(4,D=r.$$scope)},X.$$.update=()=>{X.$$.dirty&6&&v()},[k,L,f,E,D,B]}class Document extends SvelteComponent{constructor(a){super(),init(this,a,instance$2,create_fragment$2,safe_not_equal,{file:1,loadOptions:2,onProgress:3})}}function get_then_context(X){X[11]=X[12].default}function create_catch_block(X){return{c:noop,l:noop,m:noop,p:noop,i:noop,o:noop,d:noop}}function create_then_block(X){get_then_context(X);let a,R,u;var p=X[11];function B(D){return{props:{page:D[2],viewport:D[3],render_text_layer:D[0]==="canvas"?D[1]:void 0}}}return p&&(a=new p(B(X))),{c(){a&&create_component(a.$$.fragment),R=empty()},l(D){a&&claim_component(a.$$.fragment,D),R=empty()},m(D,J){a&&mount_component(a,D,J),insert_hydration(D,R,J),u=!0},p(D,J){get_then_context(D);const L={};if(J&4&&(L.page=D[2]),J&8&&(L.viewport=D[3]),J&3&&(L.render_text_layer=D[0]==="canvas"?D[1]:void 0),p!==(p=D[11])){if(a){group_outros();const f=a;transition_out(f.$$.fragment,1,0,()=>{destroy_component(f,1)}),check_outros()}p?(a=new p(B(D)),create_component(a.$$.fragment),transition_in(a.$$.fragment,1),mount_component(a,R.parentNode,R)):a=null}else p&&a.$set(L)},i(D){u||(a&&transition_in(a.$$.fragment,D),u=!0)},o(D){a&&transition_out(a.$$.fragment,D),u=!1},d(D){D&&detach(R),a&&destroy_component(a,D)}}}function create_pending_block(X){return{c:noop,l:noop,m:noop,p:noop,i:noop,o:noop,d:noop}}function create_fragment$1(X){let a,R,u,p={ctx:X,current:null,token:null,hasCatch:!1,pending:create_pending_block,then:create_then_block,catch:create_catch_block,value:12,blocks:[,,,]};return handle_promise(R=X[0]==="canvas"?__vitePreload(()=>import("./PageCanvas-db371c47.js"),["chunks/PageCanvas-db371c47.js","assets/PageCanvas-d0a90c31.css","chunks/index-f48ee692.js","chunks/preload-helper-780d7a89.js","chunks/TypographyProvider.styles-4c06a18d.js","assets/TypographyProvider.styles-78ba6c0f.css","chunks/paths-396f020f.js"]):Promise.reject("SVG rendering not implemented yet."),p),{c(){a=empty(),p.block.c()},l(B){a=empty(),p.block.l(B)},m(B,D){insert_hydration(B,a,D),p.block.m(B,p.anchor=D),p.mount=()=>a.parentNode,p.anchor=a,u=!0},p(B,[D]){X=B,p.ctx=X,D&1&&R!==(R=X[0]==="canvas"?__vitePreload(()=>import("./PageCanvas-db371c47.js"),["chunks/PageCanvas-db371c47.js","assets/PageCanvas-d0a90c31.css","chunks/index-f48ee692.js","chunks/preload-helper-780d7a89.js","chunks/TypographyProvider.styles-4c06a18d.js","assets/TypographyProvider.styles-78ba6c0f.css","chunks/paths-396f020f.js"]):Promise.reject("SVG rendering not implemented yet."))&&handle_promise(R,p)||update_await_block_branch(p,X,D)},i(B){u||(transition_in(p.block),u=!0)},o(B){for(let D=0;D<3;D+=1){const J=p.blocks[D];transition_out(J)}u=!1},d(B){B&&detach(a),p.block.d(B),p.token=null,p=null}}}function instance$1(X,a,R){let u,{renderer:p="canvas"}=a,{num:B}=a,{scale:D=1}=a,{rotation:J=0}=a,{renderTextLayer:L=!1}=a,{getViewport:f=void 0}=a;onDestroy(()=>k==null?void 0:k.cleanup());const E=getContext(key);component_subscribe(X,E,r=>R(10,u=r));let k,y,v;return X.$$set=r=>{"renderer"in r&&R(0,p=r.renderer),"num"in r&&R(5,B=r.num),"scale"in r&&R(6,D=r.scale),"rotation"in r&&R(7,J=r.rotation),"renderTextLayer"in r&&R(1,L=r.renderTextLayer),"getViewport"in r&&R(8,f=r.getViewport)},X.$$.update=()=>{X.$$.dirty&1056&&(u==null||u.getPage(B).then(r=>R(2,k=r))),X.$$.dirty&320&&R(9,v=f!=null?f:(r,t)=>r.getViewport({scale:D,rotation:t})),X.$$.dirty&644&&k&&R(3,y=v(k,J))},[p,L,k,y,E,B,D,J,f,v,u]}class Page extends SvelteComponent{constructor(a){super(),init(this,a,instance$1,create_fragment$1,not_equal,{renderer:0,num:5,scale:6,rotation:7,renderTextLayer:1,getViewport:8})}}var FileSaver_min={exports:{}};(function(X,a){(function(R,u){u()})(commonjsGlobal,function(){function R(f,E){return typeof E=="undefined"?E={autoBom:!1}:typeof E!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),E={autoBom:!E}),E.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob(["\uFEFF",f],{type:f.type}):f}function u(f,E,k){var y=new XMLHttpRequest;y.open("GET",f),y.responseType="blob",y.onload=function(){L(y.response,E,k)},y.onerror=function(){console.error("could not download file")},y.send()}function p(f){var E=new XMLHttpRequest;E.open("HEAD",f,!1);try{E.send()}catch{}return 200<=E.status&&299>=E.status}function B(f){try{f.dispatchEvent(new MouseEvent("click"))}catch{var E=document.createEvent("MouseEvents");E.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),f.dispatchEvent(E)}}var D=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof commonjsGlobal=="object"&&commonjsGlobal.global===commonjsGlobal?commonjsGlobal:void 0,J=D.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),L=D.saveAs||(typeof window!="object"||window!==D?function(){}:"download"in HTMLAnchorElement.prototype&&!J?function(f,E,k){var y=D.URL||D.webkitURL,v=document.createElement("a");E=E||f.name||"download",v.download=E,v.rel="noopener",typeof f=="string"?(v.href=f,v.origin===location.origin?B(v):p(v.href)?u(f,E,k):B(v,v.target="_blank")):(v.href=y.createObjectURL(f),setTimeout(function(){y.revokeObjectURL(v.href)},4e4),setTimeout(function(){B(v)},0))}:"msSaveOrOpenBlob"in navigator?function(f,E,k){if(E=E||f.name||"download",typeof f!="string")navigator.msSaveOrOpenBlob(R(f,k),E);else if(p(f))u(f,E,k);else{var y=document.createElement("a");y.href=f,y.target="_blank",setTimeout(function(){B(y)})}}:function(f,E,k,y){if(y=y||open("","_blank"),y&&(y.document.title=y.document.body.innerText="downloading..."),typeof f=="string")return u(f,E,k);var v=f.type==="application/octet-stream",r=/constructor/i.test(D.HTMLElement)||D.safari,t=/CriOS\/[\d]+/.test(navigator.userAgent);if((t||v&&r||J)&&typeof FileReader!="undefined"){var s=new FileReader;s.onloadend=function(){var b=s.result;b=t?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),y?y.location.href=b:location=b,y=null},s.readAsDataURL(f)}else{var l=D.URL||D.webkitURL,_=l.createObjectURL(f);y?y.location=_:location.href=_,y=null,setTimeout(function(){l.revokeObjectURL(_)},4e4)}});D.saveAs=L.saveAs=L,X.exports=L})})(FileSaver_min);var FileSaver=FileSaver_min.exports,PDF_svelte_svelte_type_style_lang="";function create_if_block_1(X){let a,R;return a=new Button({props:{class:"previous-page",color:"violet",$$slots:{default:[create_default_slot_3]},$$scope:{ctx:X}}}),a.$on("click",X[5]),{c(){create_component(a.$$.fragment)},l(u){claim_component(a.$$.fragment,u)},m(u,p){mount_component(a,u,p),R=!0},p(u,p){const B={};p&1024&&(B.$$scope={dirty:p,ctx:u}),a.$set(B)},i(u){R||(transition_in(a.$$.fragment,u),R=!0)},o(u){transition_out(a.$$.fragment,u),R=!1},d(u){destroy_component(a,u)}}}function create_default_slot_3(X){let a;return{c(){a=text("previous page")},l(R){a=claim_text(R,"previous page")},m(R,u){insert_hydration(R,a,u)},d(R){R&&detach(a)}}}function create_if_block(X){let a,R;return a=new Button({props:{class:"next-page",color:"violet",$$slots:{default:[create_default_slot_2]},$$scope:{ctx:X}}}),a.$on("click",X[4]),{c(){create_component(a.$$.fragment)},l(u){claim_component(a.$$.fragment,u)},m(u,p){mount_component(a,u,p),R=!0},p(u,p){const B={};p&1024&&(B.$$scope={dirty:p,ctx:u}),a.$set(B)},i(u){R||(transition_in(a.$$.fragment,u),R=!0)},o(u){transition_out(a.$$.fragment,u),R=!1},d(u){destroy_component(a,u)}}}function create_default_slot_2(X){let a;return{c(){a=text("next page")},l(R){a=claim_text(R,"next page")},m(R,u){insert_hydration(R,a,u)},d(R){R&&detach(a)}}}function create_default_slot_1(X){let a;return{c(){a=text("Download")},l(R){a=claim_text(R,"Download")},m(R,u){insert_hydration(R,a,u)},d(R){R&&detach(a)}}}function create_default_slot(X){let a,R,u;return R=new Page({props:{scale,num:X[1],renderTextLayer,rotation,getViewport:void 0}}),{c(){a=element("div"),create_component(R.$$.fragment),this.h()},l(p){a=claim_element(p,"DIV",{class:!0});var B=children(a);claim_component(R.$$.fragment,B),B.forEach(detach),this.h()},h(){attr(a,"class","svelte-mjytni")},m(p,B){insert_hydration(p,a,B),mount_component(R,a,null),u=!0},p(p,B){const D={};B&2&&(D.num=p[1]),R.$set(D)},i(p){u||(transition_in(R.$$.fragment,p),u=!0)},o(p){transition_out(R.$$.fragment,p),u=!1},d(p){p&&detach(a),destroy_component(R)}}}function create_fragment(X){let a,R,u,p,B,D,J,L,f,E,k,y,v,r,t,s,l,_,b,o=X[1]>1&&create_if_block_1(X),e=X[1]<X[2]&&create_if_block(X);return r=new Button({props:{class:"download-button",variant:"gradient",$$slots:{default:[create_default_slot_1]},$$scope:{ctx:X}}}),r.$on("click",X[7]),s=new Document({props:{file:X[0],loadOptions:{docBaseUrl:base},$$slots:{default:[create_default_slot]},$$scope:{ctx:X}}}),s.$on("loadsuccess",X[8]),s.$on("loaderror",X[9]),{c(){a=element("section"),R=element("div"),u=element("div"),p=text("Page "),B=element("input"),D=text(" of "),J=text(X[2]),L=space(),f=element("div"),E=element("div"),o&&o.c(),k=space(),y=element("div"),e&&e.c(),v=space(),create_component(r.$$.fragment),t=space(),create_component(s.$$.fragment),this.h()},l(n){a=claim_element(n,"SECTION",{class:!0});var d=children(a);R=claim_element(d,"DIV",{style:!0,class:!0});var T=children(R);u=claim_element(T,"DIV",{style:!0,class:!0});var S=children(u);p=claim_text(S,"Page "),B=claim_element(S,"INPUT",{type:!0,step:!0,min:!0,max:!0}),D=claim_text(S," of "),J=claim_text(S,X[2]),S.forEach(detach),L=claim_space(T),f=claim_element(T,"DIV",{style:!0,class:!0});var m=children(f);E=claim_element(m,"DIV",{style:!0,class:!0});var x=children(E);o&&o.l(x),x.forEach(detach),k=claim_space(m),y=claim_element(m,"DIV",{style:!0,class:!0});var Q=children(y);e&&e.l(Q),Q.forEach(detach),m.forEach(detach),v=claim_space(T),claim_component(r.$$.fragment,T),T.forEach(detach),d.forEach(detach),t=claim_space(n),claim_component(s.$$.fragment,n),this.h()},h(){attr(B,"type","number"),attr(B,"step","1"),attr(B,"min","1"),attr(B,"max",X[2]),set_style(u,"display","flex"),attr(u,"class","svelte-mjytni"),set_style(E,"display","inline-block"),set_style(E,"width","130px"),set_style(E,"max-width","130px"),attr(E,"class","svelte-mjytni"),set_style(y,"display","inline-block"),set_style(y,"width","130px"),set_style(y,"max-width","130px"),attr(y,"class","svelte-mjytni"),set_style(f,"display","inline-block"),attr(f,"class","svelte-mjytni"),set_style(R,"width","100%"),set_style(R,"display","flex"),set_style(R,"justify-content","space-between"),attr(R,"class","svelte-mjytni"),attr(a,"class","settings style=padding-bottom:1rem")},m(n,d){insert_hydration(n,a,d),append_hydration(a,R),append_hydration(R,u),append_hydration(u,p),append_hydration(u,B),set_input_value(B,X[1]),append_hydration(u,D),append_hydration(u,J),append_hydration(R,L),append_hydration(R,f),append_hydration(f,E),o&&o.m(E,null),append_hydration(f,k),append_hydration(f,y),e&&e.m(y,null),append_hydration(R,v),mount_component(r,R,null),insert_hydration(n,t,d),mount_component(s,n,d),l=!0,_||(b=listen(B,"input",X[6]),_=!0)},p(n,[d]){(!l||d&4)&&attr(B,"max",n[2]),d&2&&to_number(B.value)!==n[1]&&set_input_value(B,n[1]),(!l||d&4)&&set_data(J,n[2]),n[1]>1?o?(o.p(n,d),d&2&&transition_in(o,1)):(o=create_if_block_1(n),o.c(),transition_in(o,1),o.m(E,null)):o&&(group_outros(),transition_out(o,1,1,()=>{o=null}),check_outros()),n[1]<n[2]?e?(e.p(n,d),d&6&&transition_in(e,1)):(e=create_if_block(n),e.c(),transition_in(e,1),e.m(y,null)):e&&(group_outros(),transition_out(e,1,1,()=>{e=null}),check_outros());const T={};d&1024&&(T.$$scope={dirty:d,ctx:n}),r.$set(T);const S={};d&1&&(S.file=n[0]),d&1026&&(S.$$scope={dirty:d,ctx:n}),s.$set(S)},i(n){l||(transition_in(o),transition_in(e),transition_in(r.$$.fragment,n),transition_in(s.$$.fragment,n),l=!0)},o(n){transition_out(o),transition_out(e),transition_out(r.$$.fragment,n),transition_out(s.$$.fragment,n),l=!1},d(n){n&&detach(a),o&&o.d(),e&&e.d(),destroy_component(r),n&&detach(t),destroy_component(s,n),_=!1,b()}}}let scale=1.4,renderTextLayer=!0,rotation=0;function instance(X,a,R){set_worker_src(workerUrl);let u=1,{filename:p}=a,B=1;const D=v=>{let r=v.substring(v.lastIndexOf("/")+1);FileSaver.saveAs(v,r)};function J(){R(1,u+=1)}function L(){R(1,u-=1)}function f(){u=to_number(this.value),R(1,u)}const E=()=>D(p),k=v=>{R(2,B=v.detail.numPages),R(1,u=Math.min(u,B))},y=v=>alert(v.detail+"");return X.$$set=v=>{"filename"in v&&R(0,p=v.filename)},[p,u,B,D,J,L,f,E,k,y]}class PDF extends SvelteComponent{constructor(a){super(),init(this,a,instance,create_fragment,safe_not_equal,{filename:0})}}export{PDF as P,pdf as p};
